function readAllSearchInput(){let a="";if(""!=$("#datetime").val()){let t=$("#datetime").val().split(" - "),e=new Date(t[0]),s=new Date(t[1]);a=`${e.getTime()} - ${s.getTime()}`}return{user_id:$("#userpicker").val(),date_filter:a,msisdn:$("#msisdn").val(),route_id:$("#s_route").val(),smsc:$("#s_smpp").val(),user_alias:$("#s_smppclient").val(),country_iso:$("#s_country").val(),operator:$("#s_operator").val(),channel:$("#s_channel").val(),mysql_id:$("#s_smsid").val(),sender_id:$("#s_senderid").val(),sms_type_alias:$("#s_smstype").val(),sms_count:$("#s_smsparts").val(),dlr_type:$("#s_fakedlr").val(),smpp_dlr:$("#s_smppdlr").val(),kannel_dlr:$("#s_appdlr").val(),operator_dlr:$("#s_vendordlr").val(),refund_flag:$("#s_refund").val(),sms_text:$("#s_smstext").val()}}function prepareSearchRows(a){let t="";for(const e of a){let a=e._source,s=tsToDate(new Date(a.submit_time)),o="";if($("#userpicker").length>0){let t=$(`#userpicker option[value="${a.user_id}"]`);if(t.attr("label")){let e=t.attr("label").split("|");o=`<a href="javascript:void(0);" data-placement="top" data-content='${`<div class="media-group-item"><div class="media"><div class="media-left"><div class="avatar avatar-xlg avatar-circle"><a href="${app_url}viewUserAccount/${a.user_id}" target="_blank"><img src="${e[0]}" alt="User Img"></a></div></div><div class="media-body p-t-xs"><h5 class="m-t-0 m-b-0"><a href="${app_url}viewUserAccount/${a.user_id}" target="_blank" class="m-r-xs theme-color">${t.attr("data-fullname")}</a></h5><p class="m-b-0" style="font-size: 12px;font-style: Italic;"><i class="fa fa-phone m-r-xs"></i>${e[3]}</p><p class="m-b-xs" style="font-size: 12px;font-style: Italic;"><i class="fa fa-envelope m-r-xs"></i>${e[1]}</p><span class="m-b-sm label label-info label-sm">${e[2].toUpperCase()} Account</span></div></div></div>`.replace(/(['])/g,"\\$1")}' class="pop-over">${a.user_alias}</a>`}else o=a.user_alias}else o=a.user_alias;let r=$(`a.routeslist[data-myvalue="${a.route_id}"]`).text(),n="";if(void 0!==a.smsc){n=`<a href="javascript:void(0);" data-placement="top" data-content='${`<table class="table"><tbody><tr><td>SMPP</td><td>${$(`a.smpplist[data-myvalue="${a.smsc}"]`).text()}</td></tr><tr><td>Host</td><td><code class="label label-primary label-md">${a.smsc_data.host}</code></td></tr><tr><td>PORT</td><td><code class="label label-primary label-md">${a.smsc_data.port}</code></td></tr><tr><td>SYSTEM-ID</td><td><code class="label label-primary label-md">${a.smsc_data.system_id}</code></td></tr></tbody></table>`.replace(/(['])/g,"\\$1")}' class="pop-over">${a.smsc}</a>`}let l=""==a.country.iso?"-":`<div><img class="m-r-xs" style="width:18px; vertical-align:bottom;" src="${app_url}global/img/flags/${a.country.iso.toLowerCase()}.png"><span style="vertical-align: baseline;" class="">${a.country.iso}</span></div>`,i=`<table class="table"><tbody><tr><td>Brand</td><td>${a.operator.title}</td></tr><tr><td>Region</td><td>${a.operator.region}</td></tr><tr><td>MCCMNCC</td><td><kbd>${a.operator.mccmnc}</kbd></td></tr></tbody></table>`,c=""==a.operator.title||0==a.operator.mccmnc?"-":`<a href="javascript:void(0);" data-placement="top" data-content='${i.replace(/(['])/g,"\\$1")}' class="pop-over">${a.operator.title.length>14?`${a.operator.title.substring(0,10)}..`:a.operator.title}</a>`,d=`<a href="javascript:void(0);" data-content='${`<table class="table"><tbody><tr><td>Price per SMS</td><td>${app_currency.trim()}${a.price}</td></tr><tr><td>SMS Cost</td><td>${app_currency.trim()}${a.cost}</td></tr><tr><td>Refund</td><td>${1==a.refunded?"Yes, credits refunded.":"Not Applicable"}</td></tr></tbody></table>`.replace(/(['])/g,"\\$1")}' class="pop-over code text-danger fz-sm">${app_currency.trim()}${a.cost}</a>`,p="-";if(null!=a.dlr.time&&0==isNaN(a.dlr.time)){p=tsToDate(new Date(a.dlr.time))}let u=`<kbd class="bg-${"DELIVRD"==a.dlr.smpp_response?"success":"ACCEPTD"==a.dlr.smpp_response||"ENROUTE"==a.dlr.smpp_response?"primary":"danger"} fz-sm">${a.dlr.smpp_response}</kbd>`,m=""==a.dlr.operator_code?"-":`<kbd>${a.dlr.operator_code}</kbd>`,f=`<div class="panel panel-custom panel-primary">${a.sms_text.replace(/\n/g,"<br>")}</div>`,h=a.sms_text.length<70?a.sms_text.replace(/\n/g," "):`${a.sms_text.substring(0,65).replace(/\n/g,"<br />")}... <a href="javascript:void(0);" class="pop-over" data-placement="left" data-content='${f.replace(/(['])/g,"\\$1")}'>more</a>`,b='<i title="GSM/ASCII Text" class="zmdi zmdi-spellcheck fz-md text-primary"></i>';"text"==a.sms_type.main?(1==a.sms_type.unicode&&(b='<i title="UTF-8/UTF-16 Unicode" class="fas fa-language fz-lg text-primary"></i>'),1==a.sms_type.flash&&(b='<span title="Text Content with Flash"><i class="zmdi zmdi-spellcheck fz-md m-r-xs text-primary"></i><i class="fas fa-bolt text-primary fz-md"></i></span>'),1==a.sms_type.unicode&&1==a.sms_type.flash&&(b='<span title="Unicode Content with Flash"><i class="fas fa-language text-primary fz-lg m-r-xs"></i><i class="fas fz-md fa-bolt text-primary"></i></span>')):"wap"==a.sms_type.main?b="WAP":"vcard"==a.sms_type.main&&(b="vCARD"),t+=`<tr><td>${s}</td><td class="code ${void 0===a.dlr.type?"":(a.dlr.type,"")}">${a.msisdn}</td><td class="text-center" style="padding: 0 !important; vertical-align: middle;">${b}</td><td>${a.sender_id}</td><td>${o}</td><td>${r}</td>${void 0===a.smsc?"":`<td>${n}</td>`}<td>${a.channel}</td><td>${l}</td><td>${c}</td><td>${a.sms_parts}</td><td>${d}</td><td>${a.dlr.app_status}</td><td>${p}</td><td>${u}</td><td>${m}</td><td class="code">${a.mysql_id}</td><td>${h}</td></tr>`}return""==t?'<tr><td colspan="18" class="text-center">- No Matching Data -</td> </tr>':t}function getSearchResult(){$("#filter_search").attr("disabled","disabled").css("cursor","progress"),$("body").css("cursor","progress");let a=readAllSearchInput(),t="https://enterprise.loc/"==app_url?"http://localhost:5305/search/sms":`${app_url.replace(/\/$/,"")}:5305/search/sms`;$.ajax({url:t,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(a),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(a){let t=prepareSearchRows(a.rows),e=a.total,s=Math.ceil(a.aggs.daily_average.value),o=0,r=0,n=0,l=0,i=a.aggs.dlr_stats.buckets.find(a=>"1"==a.key),c=a.aggs.dlr_stats.buckets.find(a=>"2"==a.key);o=null==i?0:i.doc_count,r=Math.ceil(o/e*100)||0,n=null==c?0:c.doc_count,l=Math.ceil(n/e*100)||0;let d=a.aggs.total_cost.value,p=a.aggs.total_credits.value,u=a.aggs.refund_stats.buckets.find(a=>"true"==a.key_as_string),m=null==u?0:u.cost.value,f=null==u?0:u.credits.value;$("#sr_total").html(e.toLocaleString()),$("#sr_average").html(s.toLocaleString()),$("#sr_del").html(o.toLocaleString()),$("#sr_del_per").html(`${r}%`),$("#sr_fail").html(n.toLocaleString()),$("#sr_fail_per").html(`${l}%`),$("#sr_cost").html(d.toLocaleString()),$("#sr_refund_cost").html(m.toLocaleString()),$("#sr_credits").html(`${p.toLocaleString()} credits`),$("#sr_refund_credits").html(`${f.toLocaleString()} credits`),$("#smsdata tbody").html(t),$(".pop-over").popover({html:!0}),$("i[title]").each(function(){if(0==$(this).hasClass("pop-over")){let a=$(this).attr("title");$(this).tooltip({title:a})}}),$("#filter_search").attr("disabled",!1).css("cursor","default"),$("body").css("cursor","default")},error:function(a){console.log(a)}})}function getSearchDownload(){bootbox.dialog({message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Preparing data for download. . . .")}</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`,closeButton:!1}).init(function(){$("#stbar").animate({width:"100%"},{duration:5e3})});let a=readAllSearchInput();a.mode="download";let t="https://enterprise.loc/"==app_url?"http://localhost:5305/search/sms":`${app_url.replace(/\/$/,"")}:5305/search/sms`;$.ajax({url:t,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(a),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(a){bootbox.dialog({message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("File prepared. Downloading. . . .")}</p><div class="progress progress-xs"><div id="stbar2" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`,closeButton:!1}).init(function(){$("#stbar2").animate({width:"100%"},{duration:5e3})}),prepareSearchDownload(a.rows).then(a=>{let t=`REPORTS-${(new Date).toLocaleString().replaceAll(" ","").replace(",","-")}.csv`,e=new Blob([a],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{let a=document.createElement("a");if(void 0!==a.download){let s=URL.createObjectURL(e);a.setAttribute("href",s),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}$("#filter_search").attr("disabled",!1).css("cursor","default"),$("body").css("cursor","default"),bootbox.hideAll()})},error:function(a){console.log(a)}})}async function prepareSearchDownload(a){let t=[];$("a.routeslist").each(function(){parseInt($(this).attr("data-myvalue"))&&(t[parseInt($(this).attr("data-myvalue"))]=$(this).text())});let e="https://enterprise.loc/"==app_url?"http://localhost:5305/search/download":`${app_url.replace(/\/$/,"")}:5305/search/download`;return(await $.ajax({url:e,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify({routeTitles:t,rows:a}),crossDomain:!0,headers:{accept:"application/json; charset=UTF-8","Access-Control-Allow-Origin":"*"}})).parsedRows}function readAllFilterInputs(){let a="";if(""!=$("#datetime").val()){let t=$("#datetime").val().split(" - "),e=new Date(t[0]),s=new Date(t[1]);a=`${e.getTime()} - ${s.getTime()}`}return{user_id:$("#userpicker").val(),date_filter:a,route_id:$("#f_route").val(),smsc:$("#f_smpp").val(),user_alias:$("#f_smpp_client").val(),sender_id:$("#f_senderid").val()}}function showSmsStats(){$("#apply_filter").attr("disabled","disabled").css("cursor","progress"),$("body").css("cursor","progress");let a=echarts.init(document.getElementById("s_traffic_summary"),"macarons"),t=echarts.init(document.getElementById("s_channels")),e=echarts.init(document.getElementById("s_smstypes"),"macarons"),s=echarts.init(document.getElementById("s_networks"),"macarons"),o=readAllFilterInputs(),r="https://enterprise.loc/"==app_url?"http://localhost:5305/search/stats":`${app_url.replace(/\/$/,"")}:5305/search/stats`;$.ajax({url:r,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(o),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(o){let r=o.statsData,n={toolbox:{show:!0,orient:"horizontal",left:"right",top:"top",feature:{saveAsImage:{show:!0,name:"sms_traffic_summary",title:"Download"}}},textStyle:{fontFamily:'Rawline, "Helvetica Neue", Helvetica, Arial, sans-serif'},title:{text:"SMS Traffic",textStyle:{fontWeight:"normal"}},grid:{left:40,top:40,right:0,bottom:20},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},hideDelay:10,confine:!0,formatter:function(a){let t=`<p>${a[0].axisValue}</p>`,e="",s=0;return a.forEach(a=>{let t=parseInt(a.data)||0,o=`<p class="fz-sm m-b-0 clearfix"><span class="pull-left m-r-sm">${(a=>`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:${a}"></span>`)(a.color)} ${a.seriesName}</span> <span class="pull-right"><b>${t.toLocaleString()}</b></span></p>`;e+=o,s+=t}),`${t}${`<p class="fz-sm m-b-0 clearfix"><span class="pull-left"><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:#000"></span> Total</span> <span class="pull-right"><b>${s.toLocaleString()}</b></span></p>`}${e}`}},legend:{data:["Delivered","Failed","NDNC","Invalid","SMSC Submit","Other"]},xAxis:{type:"category",data:r.traffic_summary.dates,axisTicks:{show:!0,alignWithLabel:!0}},yAxis:{type:"value",axisLabel:{formatter:function(a){return Math.abs(a)>999999?Math.sign(a)*(Math.abs(a)/1e6).toFixed(1)+"M":Math.abs(a)>999?Math.sign(a)*(Math.abs(a)/1e3).toFixed(1)+"k":Math.sign(a)*Math.abs(a)}}},series:[{name:"Delivered",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.delivered},{name:"Failed",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.failed},{name:"NDNC",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.ndnc},{name:"Invalid",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.invalid},{name:"SMSC Submit",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.smsc_submit},{name:"Other",type:"bar",stack:"summary",barWidth:"60%",data:r.traffic_summary.other}]};a.setOption(n);let l={legend:{orient:"vertical",left:10,data:["SMPP","Panel","API"]},textStyle:{fontFamily:'Rawline, "Helvetica Neue", Helvetica, Arial, sans-serif'},title:{},tooltip:{trigger:"item",formatter:'{b} <br/>{c} <b class="m-l-xs">{d}%</b>'},grid:{left:0,top:0,right:0,bottom:0},series:[{name:"Channels",type:"pie",radius:["20%","70%"],data:r.channels,avoidLabelOverlap:!1,label:{show:!1},labelLine:{show:!1}}]};t.setOption(l);let i=`<tr> <td><span class="label label-primary fz-sm">All Messages</span> </td><td><span class="code">${r.dlr_summary.total.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.total.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.total.cost.toLocaleString()}</span> </td><td><span class="code">-</span> </td></tr><tr> <td><span class="label label-success fz-sm">Delivered</span> </td><td><span class="code">${r.dlr_summary.delivered.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.delivered.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.delivered.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.delivered.rate}</span> </td></tr><tr> <td><span class="label label-danger fz-sm">Failed</span> </td><td><span class="code">${r.dlr_summary.failed.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.failed.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.failed.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.failed.rate}</span> </td></tr><tr> <td><span class="label label-warning fz-sm">NDNC</span> </td><td><span class="code">${r.dlr_summary.ndnc.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.ndnc.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.ndnc.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.ndnc.rate}</span> </td></tr><tr> <td><span class="label label-pink fz-sm">Invalid</span> </td><td><span class="code">${r.dlr_summary.invalid.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.invalid.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.invalid.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.invalid.rate}</span> </td></tr><tr> <td><span class="label label-purple fz-sm">SMSC Submit</span> </td><td><span class="code">${r.dlr_summary.smsc_submit.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.smsc_submit.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.smsc_submit.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.smsc_submit.rate}</span> </td></tr><tr> <td><span class="label label-inverse fz-sm">Others</span> </td><td><span class="code">${r.dlr_summary.other.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.other.credits.toLocaleString()}</span> </td><td><span class="code text-danger">${r.dlr_summary.other.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.other.rate}</span> </td></tr><tr> <td><span class="label label-success fz-sm">Refunded</span> </td><td><span class="code">${r.dlr_summary.refunds.sms.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.refunds.credits.toLocaleString()}</span> </td><td><span class="code text-success">${r.dlr_summary.refunds.cost.toLocaleString()}</span> </td><td><span class="code">${r.dlr_summary.refunds.rate}</span> </td></tr>`;$("#dlrsummary tbody").html(i);let c={legend:{orient:"horizontal",top:0,data:["GSM/ASCII","Unicode","FLASH","UnicodeFlash","WAP","vCard"],textStyle:{fontSize:10},padding:[0,5]},textStyle:{fontFamily:'Rawline, "Helvetica Neue", Helvetica, Arial, sans-serif'},title:{},tooltip:{trigger:"item",formatter:'{b} <br/>{c} <b class="m-l-xs">{d}%</b>'},series:[{name:"SMS Types",type:"pie",radius:"100%",data:r.sms_types,label:{show:!1},labelLine:{show:!1},top:50}]};e.setOption(c);let d={textStyle:{fontFamily:'Rawline, "Helvetica Neue", Helvetica, Arial, sans-serif'},tooltip:{trigger:"item",formatter:function(a){return`${a.name}: <br><b>${a.value.toLocaleString()} SMS</b>`}},series:[{type:"treemap",label:{position:[10,10]},height:"100%",width:"100%",breadcrumb:{show:!1},nodeClick:!1,roam:!1,data:r.networks}]};s.setOption(d);let p="";for(const a of r.countries){let t=getCountryName(a.iso);p+=`<a href="javascript:void(0);" class="list-group-item p-sm clearfix"> <span class="pull-left"> ${"Unknown"==a.iso?'<i class="fas fa-question fa-lg text-pink"></i>':`<img style="height: 15px;" src="${app_url}global/img/flags/${a.iso.toLowerCase()}.png"/>`} </span> <span class="pull-left m-l-xs fw-500" style="margin-top: 3px;">${t}</span> <div class="pull-right"> <span data-plugin="counterUp">${a.total.toLocaleString()}</span> SMS </div></a>`}""==p?$("#top_countries").html("<h5>- Not Enough Data -</h5>"):$("#top_countries").html(p),$("#apply_filter").attr("disabled",!1).css("cursor","default"),$("body").css("cursor","default")},error:function(a){console.log(a)}}),$("#print_dlr_summary").on("click",function(){$("#dlrsummary").printThis({importStyle:!0,pageTitle:"DLR Summary",copyTagClasses:!0,pageTitle:"DLR Summary"})})}function readDashboardFilters(a){let t={};if("admin"===a.page){let e=""===$("#roc_dp span").html()?[]:$("#roc_dp span").html().split(" - "),s=new Date(e[0]),o=new Date(e[1]),r=`${s.getTime()} - ${o.getTime()}`,n=""===$("#topcldp span").html()?[]:$("#topcldp span").html().split(" - "),l=new Date(n[0]),i=new Date(n[1]),c=`${l.getTime()} - ${i.getTime()}`;t={mode:a.mode,roc_mode:$("#dash_roc").val()||"",roc_date_range:r,top_users_date_range:c}}if("reseller"===a.page){let e=""===$("#topcldp span").html()?[]:$("#topcldp span").html().split(" - "),s=new Date(e[0]),o=new Date(e[1]),r=`${s.getTime()} - ${o.getTime()}`;t={mode:a.mode,top_users_date_range:r}}if("client"===a.page){let e=""===$("#clientrtdp span").html()?[]:$("#clientrtdp span").html().split(" - "),s=new Date(e[0]),o=new Date(e[1]),r=`${s.getTime()} - ${o.getTime()}`;t={mode:a.mode,client_routes_date_range:r}}return t}function loadDashboardStats(a){let t=readDashboardFilters(a),e="https://enterprise.loc/"==app_url?"http://localhost:5305/search/ministats":`${app_url.replace(/\/$/,"")}:5305/search/ministats`;$.ajax({url:e,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(t),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(a){let e=a.statsData;if(void 0!==e.roc_data){let a="";for(const s of e.roc_data){let e="";if("r"==t.roc_mode){let a=$(`#route_js_${s.key}`).html();e=void 0===a?'<span class="label label-default fz-sm">Deleted</span>':`<h5>${a}</h5>`}else{let a=$(`#smpp_js_${s.key}`).html();if(void 0!==a){let t=a.split("|");e=`<div class="media-body"><h5 class="m-t-0 m-b-0"><a href="javascript:void(0);" class="m-r-xs">${t[0]}</a></h5><p style="font-size: 12px;">${t[1]}</p></div>`}else e='<span class="label label-default fz-sm">Deleted</span>'}a+=`<tr> <td data-rid="${s.key}" class="text-left">${e}</td><td><span class="code">${s.total_sms.toLocaleString()}</span></td><td><span class="code">${s.total_delivered.toLocaleString()} <span class="block text-success">(${Math.ceil(s.total_delivered/s.total_sms*100)||0}%)</span></span></td><td><span class="code">${s.total_failed.toLocaleString()} <span class="block text-danger">(${Math.ceil(s.total_failed/s.total_sms*100)||0}%)</span></span></td><td><span class="code">${s.total_ndnc.toLocaleString()} <span class="block text-danger">(${Math.ceil(s.total_ndnc/s.total_sms*100)||0}%)</span></span></td><td><span class="code">${s.total_ack.toLocaleString()} <span class="block text-primary">(${Math.ceil(s.total_ack/s.total_sms*100)||0}%)</span></span></td><td><span class="code">${s.total_invalid.toLocaleString()} <span class="block text-pink">(${Math.ceil(s.total_invalid/s.total_sms*100)||0}%)</span></span></td><td><span class="code">${s.total_refunds.toLocaleString()} <span class="block text-success">(${Math.ceil(s.total_refunds/s.total_sms*100)||0}%)</span></span></td> </tr>`}let s=""==a?'<tr><td colspan="8"> - Not Enough Data - </td></tr>':a;$("#roc_summary tbody").html(s)}if(void 0!==e.top_users){let a="";for(const t of e.top_users){let e=$(`#user_js_${t.user_id}`).html(),s="";if(void 0===e)s='<div class="media col-md-6 col-sm-6 col-xs-6"> <div class="media-left"> <div class="avatar avatar-sm avatar-circle"><a href="javascript:void(0)"><i class="fa fa-user fa-3x text-warning"></i></a></div></div><div class="media-body"> <h5 class="m-t-0"><small class="text-muted fz-sm">Account Deleted</small></h5></div></div>';else{let a=e.split("|");s=`<div class="media col-md-6 col-sm-6 col-xs-6"> <div class="media-left"> <div class="avatar avatar-sm avatar-circle"><a href="${app_url}viewUserAccount/${t.user_id}"><img src="${a[3]}" alt=""></a></div></div><div class="media-body"> <h5 class="m-t-0"><a href="${app_url}viewUserAccount/${t.user_id}" class="m-r-xs theme-color">${a[0]}</a><small class="text-muted fz-sm">${a[1]}</small></h5> <p style="font-size: 12px;font-style: Italic;">${a[2]}</p></div></div>`}a+=`<div class="media-group-item"> ${s} <div class="text-right col-md-6 col-sm-6 col-xs-6"> <h5 class="m-t-0 label label-primary">${t.total_sms.toLocaleString()}</h5> <p style="font-size: 12px;margin-top:3px;">SMS Sent</p></div><div class="clearfix"></div></div>`}let t=""==a?'<div align="center">No recent consumers to show</div>':a;$("#topclctr").html(t)}if(void 0!==e.client_routes){let a="";for(const t of e.client_routes){let e=$(`#route_js_${t.key}`).html();rt_title=void 0===e?'<span class="label label-default fz-sm">Deleted</span>':`<h5>${e}</h5>`,a+=`<div>${rt_title} </div>`,a+=`<div class="progress"> <div class="progress-bar progress-bar-success" style="width: ${Math.ceil(t.total_delivered/t.total_sms*100)||0}%" data-placement="top" data-toggle="tooltip" title="${t.total_delivered.toLocaleString()} SMS"> Delivered </div><div class="progress-bar progress-bar-danger" style="width: ${Math.ceil(t.total_failed/t.total_sms*100)||0}%" data-toggle="tooltip" title="${t.total_failed.toLocaleString()} SMS"> Failed </div><div class="progress-bar progress-bar-warning" style="width: ${Math.ceil(t.total_ack/t.total_sms*100)||0}%" data-placement="top" data-toggle="tooltip" title="${t.total_ack.toLocaleString()} SMS"> SMSC Submit </div></div>`}let t=""==a?"<h5> - Not Enough Data - </h5>":a;$("#clientrtctr").html(t),$('[data-toggle="tooltip"]').tooltip()}},error:function(a){console.log(a)}})}function readViewAccountDateFilter(){let a=""===$("#stdp span").html()?[]:$("#stdp span").html().split(" - "),t=new Date(a[0]),e=new Date(a[1]),s=`${t.getTime()} - ${e.getTime()}`;return{mode:"viewaccountsummary",user_id:$("#userid").val(),viewaccount_sms_date_range:s}}function loadViewAcountSmsSummary(){let a=echarts.init(document.getElementById("usersmssummary"),"macarons"),t=readViewAccountDateFilter(),e="https://enterprise.loc/"==app_url?"http://localhost:5305/search/ministats":`${app_url.replace(/\/$/,"")}:5305/search/ministats`;$.ajax({url:e,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(t),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(t){let e=t.statsData,s={toolbox:{show:!0,orient:"horizontal",left:"right",top:"top",feature:{saveAsImage:{show:!0,name:"sms_traffic_summary",title:"Download"}}},textStyle:{fontFamily:'Rawline, "Helvetica Neue", Helvetica, Arial, sans-serif'},title:{},grid:{left:40,top:40,right:0,bottom:20},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},hideDelay:10,confine:!0,formatter:function(a){let t=`<p>${a[0].axisValue}</p>`,e="",s=0;return a.forEach(a=>{let t=parseInt(a.data)||0,o=`<p class="fz-sm m-b-0 clearfix"><span class="pull-left m-r-sm">${(a=>`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:${a}"></span>`)(a.color)} ${a.seriesName}</span> <span class="pull-right"><b>${t.toLocaleString()}</b></span></p>`;e+=o,s+=t}),`${t}${`<p class="fz-sm m-b-0 clearfix"><span class="pull-left"><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:#000"></span> Total</span> <span class="pull-right"><b>${s.toLocaleString()}</b></span></p>`}${e}`}},legend:{data:["Delivered","Failed","NDNC","Invalid","SMSC Submit","Other"]},xAxis:{type:"category",data:e.va_traffic_summary.dates,axisTicks:{show:!0,alignWithLabel:!0}},yAxis:{type:"value",axisLabel:{formatter:function(a){return Math.abs(a)>999999?Math.sign(a)*(Math.abs(a)/1e6).toFixed(1)+"M":Math.abs(a)>999?Math.sign(a)*(Math.abs(a)/1e3).toFixed(1)+"k":Math.sign(a)*Math.abs(a)}}},series:[{name:"Delivered",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.delivered},{name:"Failed",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.failed},{name:"NDNC",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.ndnc},{name:"Invalid",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.invalid},{name:"SMSC Submit",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.smsc_submit},{name:"Other",type:"bar",stack:"summary",barWidth:"60%",data:e.va_traffic_summary.other}]};a.setOption(s)},error:function(a){console.log(a)}})}function getOrdinalNum(a){return a+(a>0?["th","st","nd","rd"][a>3&&a<21||a%10>3?0:a%10]:"")}function scBulkAction(a){if("delpre"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one prefix to delete"));var t=[];$(".selected").each(function(){t.push($(this).children().find(".pids").val())});var e=t.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to delete selected prefixes?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"delManyOP",method:"post",data:{cid:$("#cid").val(),pids:e},success:function(a){window.location=app_url+"viewAllOP/"+$("#cid").val()}})}})}if("delcontacts"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one contact to delete"));var s=[];$(".selected").each(function(){s.push($(this).children().find(".cids").val())});var o=s.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to delete selected contacts?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"delManyContacts",method:"post",data:{cids:o},success:function(a){window.location=app_url+"viewContacts/"+$("#groupid").val()}})}})}if("apprSid"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one sender ID to approve"));var r=[],n=[];$(".selected").each(function(){r.push($(this).children().find(".sids").val()),n.push($(this).children().find(".sids").attr("data-user"))});var l=r.join(","),i=n.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to Approve selected Sender ID?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"approveManySids",method:"post",data:{sids:l,users:i},success:function(a){window.location=app_url+"approveSenderIds"}})}})}if("rejcSid"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one sender ID to reject"));r=[],n=[];$(".selected").each(function(){r.push($(this).children().find(".sids").val()),n.push($(this).children().find(".sids").attr("data-user"))});l=r.join(","),i=n.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to Reject selected Sender ID? These will be deleted from the system"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"rejectManySids",method:"post",data:{sids:l,users:i},success:function(a){window.location=app_url+"approveSenderIds"}})}})}if("apprTemp"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one template to approve"));var c=[];n=[];$(".selected").each(function(){c.push($(this).children().find(".tids").val()),n.push($(this).children().find(".tids").attr("data-user"))});var d=c.join(",");i=n.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to Approve selected templates?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"approveManyTemps",method:"post",data:{tids:d,users:i},success:function(a){window.location=app_url+"approveTemplates"}})}})}if("rejcTemp"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one template to reject"));c=[],n=[];$(".selected").each(function(){c.push($(this).children().find(".tids").val()),n.push($(this).children().find(".tids").attr("data-user"))});d=c.join(","),i=n.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to Reject selected templates?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"rejectManyTemps",method:"post",data:{tids:d,users:i},success:function(a){window.location=app_url+"approveTemplates"}})}})}if("readAlerts"==a){if($(".selected").length<1)return void bootbox.alert(SCTEXT("Please select at least one notification to mark it as READ"));var p=[];$(".selected").each(function(){p.push($(this).children().find(".nids").val())});var u=p.join(",");bootbox.confirm({message:SCTEXT("Are you sure you want to mark selected notifications as read?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"markAlertsRead",method:"post",data:{nids:u},success:function(a){window.location=app_url+"viewNotifications"}})}})}}function downloadUserSmsLog(){var a=$("#t-usmslog_filter").find("input").val(),t={filDate:$("#sldp span").html(),senderId:$("#sidsel").val(),routeId:$("#rtsel").val(),search:a};bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Preparing file.<br> Download will start in few minutes. This window will close automatically.")}</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},{duration:1e4,complete:function(){bootbox.hideAll()}}),setTimeout(function(){window.location=app_url+"globalFileDownload/smslog/"+encodeURIComponent(JSON.stringify(t))},5)})}function loadScText(){$.ajax({url:app_url+"getScText",success:function(a){if("en"==a)localStorage.clear(),localStorage.setItem("app_lang",app_lang);else{var t;for(var e in t=JSON.parse(a))localStorage.setItem(e,t[e]);localStorage.setItem("app_lang",app_lang)}}})}function SCTEXT(a){var t=a.toLowerCase();return localStorage.getItem(t)&&""!=localStorage.getItem(t)?localStorage.getItem(t):a}function createInputFile(a,t,e=""){if("sendsms"==e){let a=JSON.parse(t);t=a.newfile;var s=document.createElement("INPUT");(o=document.createAttribute("type")).value="hidden",(r=document.createAttribute("name")).value="uploadedFiles[]",(n=document.createAttribute("value")).value=t,(l=document.createAttribute("id")).value=t,(i=document.createAttribute("class")).value="uploadedFile",$("#contact_label").val(a.orgfile)}else{var o,r,n,l,i;s=document.createElement("INPUT");(o=document.createAttribute("type")).value="hidden",(r=document.createAttribute("name")).value="uploadedFiles[]",(n=document.createAttribute("value")).value=t,(l=document.createAttribute("id")).value=t,(i=document.createAttribute("class")).value="uploadedFile"}if(s.setAttributeNode(o),s.setAttributeNode(r),s.setAttributeNode(n),s.setAttributeNode(l),s.setAttributeNode(i),document.getElementById(a).appendChild(s),"sendsms"==e){var c=t.split(".").pop();if("xls"==c||"xlsx"==c){var d='<div id="sheetloader" class="form-group m-v-sm text-center"><i class="fa fa-cog fa-spin fa-lg fa-fw"></i><b>'+SCTEXT("Loading Sheets and columns")+" ...<b></b></b></div>";$("#xlsheetcolbox").before(d)}$.ajax({type:"post",dataType:"json",url:app_url+"getSheetnColumns",data:{file:t},success:function(a){var t=a;if("xls"==c||"xlsx"==c){$sheets=t.sheets,$cols=t.cols,$sheet_str="";for(var e=0;e<$sheets.length;e++)$sheet_str+='<option value="'+$sheets[e]+'">'+$sheets[e]+"</option>";for(var s in $cols_str="",$cols_btns="",$cols)null!=$cols[s]&&""!=$cols[s]&&($cols_str+='<option value="'+s+'">'+$cols[s]+"</option>",$cols_btns+='<button data-colval="'+s+'" type="button" class="colsbtn btn btn-sm btn-default">'+$cols[s]+"</button>");$("#sheetloader").remove(),$("#xlsheet").html($sheet_str),$("#xlcol").html($cols_str),$("#xlcolbtns").html($cols_btns),$("#ufilecno").val(parseInt(t.totalrows)),$("#xlsheetcolbox").removeClass("hidden"),calcContacts()}else if("csv"==c||"CSV"==c){for(var s in $cols=t.cols,$cols_btns="",$cols)null!=$cols[s]&&""!=$cols[s]&&($cols_btns+='<button data-colval="'+s+'" type="button" class="colsbtn btn btn-sm btn-default">'+$cols[s]+"</button>");$("#xlcolbtns").html($cols_btns),$("#ufilecno").val(parseInt(t.totalrows)),calcContacts()}else $("#ufilecno").val(parseInt(t.totalrows)),$("#xlcolbtns").html("- No Columns Available -"),$("#xlsheetcolbox").addClass("hidden"),calcContacts()}})}}function deleteInputFile(a,t){"sendsms"==t&&(a=JSON.parse(a).newfile),$.ajax({url:app_url+"deleteUploadedFile",method:"POST",data:{mode:t,filename:a},success:function(e){var s=document.getElementById(a);s.parentNode.removeChild(s),"sendsms"==t&&($("#xlsheetcolbox").addClass("hidden"),$("#ufilecno").val(parseInt("0")),$("#xlcolbtns").html("- No Columns Available -"),calcContacts())}})}function nl2br(a,t){return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(t||void 0===t?"<br />":"<br>")+"$2")}function calcTotalSessions(){$txs=isNaN(parseInt($("#tx_no").val()))?0:parseInt($("#tx_no").val()),$rxs=isNaN(parseInt($("#rx_no").val()))?0:parseInt($("#rx_no").val()),$trxs=isNaN(parseInt($("#trx_no").val()))?0:parseInt($("#trx_no").val()),$ts=$txs+$rxs+$trxs,$("#total_sessions").val($ts)}function formatInt(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function isPositiveInteger(a){if(null==a)return!1;if(0==a.length)return!1;for(var t=0;t<a.length;t++){var e=a.charAt(t);if(e<"0"||e>"9")return!1}return!0}function isValidPhone(a){if(null==a)return!1;if(0==a.length)return!1;if(a.length>15||a.length<8)return!1;for(var t=0;t<a.length;t++){var e=a.charAt(t);if(e<"0"||e>"9"||"+"==e)return!1}return!0}function echeck(a){var t=a.indexOf("@"),e=a.length;a.indexOf(".");return-1!=a.indexOf("@")&&(-1!=a.indexOf("@")&&0!=a.indexOf("@")&&a.indexOf("@")!=e&&(-1!=a.indexOf(".")&&0!=a.indexOf(".")&&a.indexOf(".")!=e&&(-1==a.indexOf("@",t+1)&&("."!=a.substring(t-1,t)&&"."!=a.substring(t+1,t+2)&&(-1!=a.indexOf(".",t+2)&&-1==a.indexOf(" "))))))}function dump(a){var t="";for(var e in a)t+=e+": "+a[e]+"\n";alert(t);var s=document.createElement("pre");s.innerHTML=t,document.body.appendChild(s)}function calcContacts(){var a=0,t=0,e=0;if($("#contcountloader").removeClass("hidden"),"1"==$("#account_type").val()){let a=0;if($("#editsch").length>0){let t,e=parseInt($("#totalschno").val());a=parseFloat($("#schcontactcost").val()),t=$("#txtsms").is(":checked")?$("#txtcount").val():1;let s=parseFloat(a)*parseInt(t);$("#contcountbox").html(`<b id="conf_total_contacts">${formatInt(e)}</b> contact(s) X <b>${t}</b> SMS = <b id="conf_total_cost">${app_currency} ${s.toFixed(4)}</b> ${SCTEXT("will be charged")} <span id="contcountloader" class="hidden pull-right text-dark"><i class="fa fa-lg fa-spin fa-circle-o-notch"></i> </span>`)}else{let a=null!=$("#contactinput").val()?$("#contactinput").val().split("\n"):[];a.length>0&&$.ajax({url:`${app_url}calculateSmsCost`,method:"post",data:{mode:"sendsms",phones:JSON.stringify(a)},success:function(a){let t,e=JSON.parse(a);t=$("#txtsms").is(":checked")?$("#txtcount").val():1;let s=parseFloat(e.price)*parseInt(t);$("#contcountbox").html(`<b id="conf_total_contacts">${formatInt(e.totalcontacts)}</b> contact(s) X <b>${t}</b> SMS = <b id="conf_total_cost">${app_currency} ${s.toFixed(4)}</b> ${SCTEXT("will be charged")} <span id="contcountloader" class="hidden pull-right text-dark"><i class="fa fa-lg fa-spin fa-circle-o-notch"></i> </span>`)}})}}else{if($("#resendpb").length>0||$("#syspb").length>0&&$("#syspb").is(":checked")){if($("#txtsms").is(":checked"))var s=$("#txtcount").val();else s=1;if($("#resend").length>0)var o=$("#pbtotal").val();else{var r=parseInt($("#pbfrom").val())||0,n=parseInt($("#pbto").val())||0;o=0==n?0:parseInt(n-r)+1}}else{var l=0;if($("#totalschno").length>0?l=parseInt($("#totalschno").val()):(a=parseInt($("#contactinput").val().split("\n").filter(Boolean).length)||0,$("#grpsel option:selected").length>1?$("#grpsel option:selected").each(function(){t+=parseInt($(this).attr("data-count"))||0}):t=parseInt($("#grpsel option:selected").attr("data-count"))||0,e=$("#ufilecno").val()),$("#txtsms").is(":checked"))s=$("#txtcount").val();else s=1;o=a+t+parseInt(e)+l}if("2"==$("#account_type").val()){rate=parseFloat($("#activerate").val());let a=rate*parseInt(o*s);$("#contcountbox").html(`<b id="conf_total_contacts">${formatInt(o)}</b> contact(s) X <b>${s}</b> SMS = <b id="conf_total_cost">${app_currency} ${a.toFixed(4)}</b> ${SCTEXT("will be charged")} <span id="contcountloader" class="hidden pull-right text-dark"><i class="fa fa-lg fa-spin fa-circle-o-notch"></i> </span>`)}else $("#contcountbox").html('<b id="conf_total_contacts">'+formatInt(o)+"</b> contact(s) X <b>"+s+'</b> SMS = <b id="conf_total_cost">'+formatInt(o*s)+"</b> "+SCTEXT("credits required")+' <span id="contcountloader" class="hidden pull-right text-dark"><i class="fa fa-lg fa-spin fa-circle-o-notch"></i> </span>')}}function loadAppAlerts(){$.ajax({type:"get",url:app_url+"getMyAlerts",success:function(a){var t=JSON.parse(a);$("#notifctr").html(t.str),"0"!=t.count?(""==$("#notifcnt").html()&&$("#notifAudio")[0].play(),$("#notifcnt").html(t.count)):$("#notifcnt").html("")}})}function createSwitches(a="myswitch"){$("."+a).each(function(){var a=$(this),t=a.attr("data-color"),e=a.attr("data-size")||"default";if(!a.attr("data-switchery"))new Switchery(document.querySelector("#"+a.attr("id")),{color:t,size:e,jackColor:"#ffffff"})})}function getSmppCredits(){$(".smppcredits").each(function(){let a=$(this),t=a.attr("data-apicall");fetch(`${app_url}adminRemoteCalls/${encodeURIComponent(t)}`).then(a=>a.text()).then(function(t){a.html(t)})})}var transliterationControl;function onLoad(){(transliterationControl=new google.elements.transliteration.TransliterationControl({sourceLanguage:"en",destinationLanguage:["ar","hi","or","kn","ml","ta","te","mr","gu","bn","pa","ur","zh","ne","ru","fa","el","sa","sr"],transliterationEnabled:!1,shortcutKey:"ctrl+g"})).makeTransliteratable(["text_sms_content"]),transliterationControl.addEventListener(google.elements.transliteration.TransliterationControl.EventType.STATE_CHANGED,transliterateStateChangeHandler),transliterationControl.addEventListener(google.elements.transliteration.TransliterationControl.EventType.SERVER_UNREACHABLE,serverUnreachableHandler),transliterationControl.addEventListener(google.elements.transliteration.TransliterationControl.EventType.SERVER_REACHABLE,serverReachableHandler),transliterationControl.isTransliterationEnabled()?(document.getElementById("unicode_tl").checked=!0,document.getElementById("unicode_auto").checked=!1):(document.getElementById("unicode_tl").checked=!1,document.getElementById("unicode_auto").checked=!0),document.getElementById("unicode_tl").checked=transliterationControl.isTransliterationEnabled(),transliterationControl.showControl("translControl")}function transliterateStateChangeHandler(a){document.getElementById("unicode_tl").checked=a.transliterationEnabled,document.getElementById("unicode_auto").checked=!a.transliterationEnabled}function checkboxClickHandler(){transliterationControl.toggleTransliteration()}function serverUnreachableHandler(a){document.getElementById("errorDiv").innerHTML="Transliteration Server unreachable"}function serverReachableHandler(a){document.getElementById("errorDiv").innerHTML=""}function serialize(a){var t,e,s="",o=0,r=function(a){var t,e,s,o,r=typeof a;if("object"===r&&!a)return"null";if("object"===r){if(!a.constructor)return"object";for(e in(t=(s=a.constructor.toString()).match(/(\w+)\(/))&&(s=t[1].toLowerCase()),o=["boolean","number","string","array"])if(s===o[e]){r=o[e];break}}return r},n=r(a);switch(n){case"function":t="";break;case"boolean":t="b:"+(a?"1":"0");break;case"number":t=(Math.round(a)===a?"i":"d")+":"+a;break;case"string":t="s:"+~-encodeURI(a).split(/%..|./).length+':"'+a+'"';break;case"array":case"object":for(e in t="a",a)if(a.hasOwnProperty(e)){if("function"===r(a[e]))continue;s+=serialize(e.match(/^[0-9]+$/)?parseInt(e,10):e)+serialize(a[e]),o++}t+=":"+o+":{"+s+"}";break;case"undefined":default:t="N"}return"object"!==n&&"array"!==n&&(t+=";"),t}function insertAtCaret(a,t){var e=document.getElementById(a);if(e){var s=e.scrollTop,o=0,r=e.selectionStart||"0"==e.selectionStart?"ff":!!document.selection&&"ie";if("ie"==r){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),o=n.text.length}else"ff"==r&&(o=e.selectionStart);var l=e.value.substring(0,o),i=e.value.substring(o,e.value.length);if(e.value=l+t+i,o+=t.length,"ie"==r){e.focus();var c=document.selection.createRange();c.moveStart("character",-e.value.length),c.moveStart("character",o),c.moveEnd("character",0),c.select()}else"ff"==r&&(e.selectionStart=o,e.selectionEnd=o,e.focus());e.scrollTop=s}}function substr_replace(a,t,e,s){var o=e<0?parseInt(e)+parseInt(a.length):parseInt(e);return s<=0&&(s=1),a.slice(0,o)+t+a.slice(o+parseInt(s))}$(document).on("ready",function(){if("admin_dashboard"==curpage){$(".search_option_selector").on("click",function(){let a=$(this).attr("data-myvalue"),t=$(this).attr("data-inputid"),e=$(this).text();$(`#${t}`).val()!=a&&(e.length>10&&(e=e.replace(/(.{10})..+/,"$1…")),$(`#${t}_dropdown`).find(".search_option_selector").removeClass("chosen"),$(this).addClass("chosen"),$(`#${t}`).val(a),$(`#${t}_selection`).html(`${e} <i class="m-l-sm fas fa-caret-down fa-lg"></i>`),loadDashboardStats({mode:"roc",page:"admin"}))}),$("#topsalesdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"right",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#topsalesdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html(),success:function(a){var t=JSON.parse(a);$("#topsalesctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_sales").removeClass("hidden").attr("data-custom","4,4").html(SCTEXT("Show More")+" ..."):$("#more_sales").addClass("hidden")})})}})}),$("#topsalesdp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$("#roc_dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#roc_dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),loadDashboardStats({mode:"roc",page:"admin"})}),$("#roc_dp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$("#topcldp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"right",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#topcldp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),loadDashboardStats({mode:"topclients",page:"admin"})}),$("#topcldp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$("#toprsdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#toprsdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getTopResellers/"+$("#toprsdp span").html(),success:function(a){var t=JSON.parse(a);$("#toprsctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_toprs").removeClass("hidden").attr("data-custom","4,4").html(SCTEXT("Show More")+" ..."):$("#more_toprs").addClass("hidden")})})}})}),$("#toprsdp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getAdminSalesStats",success:function(a){var t=JSON.parse(a);$sales_this_week=t.sales_this_week||0,$sales_this_month=t.sales_this_month||0,$sales_seven_days=t.sales_seven_days||0,$("#weekly_sales_ctr").html(t.total_weekly_sales),$("#monthly_sales_ctr").html(t.total_monthly_sales);var e=[];for(elem in $sales_this_week)e.push($sales_this_week[elem]);$("#ws_sp_chart").sparkline(e,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2});var s=[];for(elem2 in $sales_this_month)s.push($sales_this_month[elem2]);$("#ms_sp_chart").sparkline(s,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5})}});let a="https://enterprise.loc/"==app_url?"http://localhost:5305/search/ministats":`${app_url.replace(/\/$/,"")}:5305/search/ministats`,t={mode:"top_sms_stats"};$.ajax({url:a,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(t),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(a){$("#weekly_sms_ctr").html(a.statsData.total_last_seven),$("#monthly_sms_ctr").html(a.statsData.total_last_thirty),$("#wm_sp_chart").sparkline(a.statsData.last_seven_sms,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2}),$("#mm_sp_chart").sparkline(a.statsData.last_thirty_sms,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5})},error:function(a){console.log(a)}}),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html(),success:function(a){var t=JSON.parse(a);$("#topsalesctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_sales").removeClass("hidden").attr("data-custom","4,4"):$("#more_sales").addClass("hidden")})})}}),$("#more_sales").on("click",function(){$limit=$(this).attr("data-custom"),"0,4"!=$limit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html()+"/"+$limit,success:function(a){var t=JSON.parse(a);1==t.more?($("#topsalesctr").append(t.str),$("#topsalesctr").animate({scrollTop:$("#topsalesctr").prop("scrollHeight")},500,function(){$("#more_sales").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit})})):$("#more_sales").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),$.ajax({type:"GET",url:app_url+"getTopResellers/"+$("#toprsdp span").html(),success:function(a){var t=JSON.parse(a);$("#toprsctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_toprs").removeClass("hidden").attr("data-custom","4,4"):$("#more_toprs").addClass("hidden")})})}}),$("#more_toprs").on("click",function(){$rslimit=$(this).attr("data-custom"),"0,4"!=$rslimit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getTopResellers/"+$("#toprsdp span").html()+"/"+$rslimit,success:function(a){var t=JSON.parse(a);1==t.more?($("#toprsctr").append(t.str),$("#toprsctr").animate({scrollTop:$("#toprsctr").prop("scrollHeight")},500,function(){$("#more_toprs").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit})})):$("#more_toprs").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),loadDashboardStats({mode:"all",page:"admin"})}if("manage_smpp"==curpage&&($(document).on("click",".remove_smpp",function(){var a=$(this).attr("data-rid");bootbox.confirm({message:SCTEXT("This will remove the SMPP from Kannel. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteSmpp/"+a)}})}),$(document).on("change",".togstatus",function(){let a=$(this).attr("data-rid"),t=1;$(this).is(":checked")&&(t=0),$.ajax({url:app_url+"changeSmppStatus",method:"post",data:{rid:a,status:t},success:function(a){bootbox.alert(a)}})})),"add_smpp"!=curpage&&"edit_smpp"!=curpage||($("#save_changes").click(function(){""!=$("#smpp_title").val()&&""!=$("#provider").val()&&""!=$("#smsc_id").val()&&isPositiveInteger($("#total_sessions").val())&&""!=$("#smpp_host").val()&&""!=$("#smpp_port").val()&&""!=$("#smpp_uid").val()&&""!=$("#smpp_pass").val()?"edit_smpp"==curpage?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving SMPP and restarting SMSC. Less than a minute remaining")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},12e3),setTimeout(function(){$("#edit_smpp_form").attr("action",app_url+"saveSmpp"),$("#edit_smpp_form").submit()},500)}):bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Adding SMPP to Kannel")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},3e3),setTimeout(function(){$("#add_smpp_form").attr("action",app_url+"saveSmpp"),$("#add_smpp_form").submit()},500)}):bootbox.alert(SCTEXT("Some error occurred. Please fill all the fields with appropriate values"))}),$("#bk").click(function(){window.location=app_url+"manageSmpp"}),$("#tx_no,#rx_no,#trx_no").on("click keyup focus blur change",function(){calcTotalSessions()})),"manage_bl_db"==curpage&&$(document).on("click",".remove_bldb",function(){var a=$(this).attr("data-tid");bootbox.confirm({message:SCTEXT("This will delete the table and all the data. This cannot be undone. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteBlacklistDb/"+a)}})}),"add_bl_db"!=curpage&&"edit_bl_db"!=curpage||($("#save_changes").click(function(){""!=$("#tname").val()&&""!=$("#mcol").val()?0!=/^[a-zA-Z0-9-_]*$/.test($("#tname").val())?0!=/^[a-zA-Z0-9-_]*$/.test($("#mcol").val())?"edit_bl_db"==curpage?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes in Database")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},800),setTimeout(function(){$("#edit_bldb_form").attr("action",app_url+"saveBlacklistDb"),$("#edit_bldb_form").submit()},300)}):bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Adding Database")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},800),setTimeout(function(){$("#add_bldb_form").attr("action",app_url+"saveBlacklistDb"),$("#add_bldb_form").submit()},300)}):bootbox.alert(SCTEXT("Mobile Column name contains illegal characters.")):bootbox.alert(SCTEXT("Table name contains illegal characters.")):bootbox.alert(SCTEXT("Table name & mobile column cannot be blank."))}),$("#bk").click(function(){window.location=app_url+"manageBlacklists"})),"upload_bl_db"==curpage&&($("#bk").click(function(){window.location=app_url+"manageBlacklists"}),$("#save_changes").click(function(){0!=$("#seltbl").val()?0!=$(".uploadedFile").length?1!=$("#uprocess").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Adding Upload Task")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#upload_bldb_form").attr("action",app_url+"addUploadTask"),$("#upload_bldb_form").submit()},100)}):bootbox.alert(SCTEXT("File upload is in progress. Kindly wait for upload to finish or Cancel Upload & proceed.")):bootbox.alert(SCTEXT("Please upload at least one file.")):bootbox.alert(SCTEXT("Please select a table to import data."))})),"view_bl_db"==curpage&&($("body").on("click",".closeDS",function(){$(".taskinfo").popover("hide")}),$("body").on("click",".cancel-import",function(){var a=$(this).attr("data-taskid");bootbox.confirm({message:SCTEXT("This will delete the current task and uploaded file. If some of the data is already imported it will not be deleted. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteImportTask/"+a)}})}),$("#lookupbtn").click(function(){var a=$(this);a.attr("disabled","disabled").html(SCTEXT("Searching")+"...").css("cursor","progress");var t=$("#mobile_no").val();if(!isPositiveInteger(t)||t.length<7||t.length>15)return bootbox.alert(SCTEXT("Invalid mobile number format. Enter mobile number with no space and without plus (+) sign.")),void a.attr("disabled",!1).html('<i class="fa fa-search fa-lg"></i>&nbsp; '+SCTEXT("Search")).css("cursor","pointer");$.ajax({url:app_url+"numberLookupBlDb",data:{mobile:t,tinfo:$("#tinfo").val()},success:function(e){var s=JSON.parse(e);if(a.attr("disabled",!1).html('<i class="fa fa-search fa-lg"></i>&nbsp; '+SCTEXT("Search")).css("cursor","pointer"),0==s.result)$("#lookup_result").html('<li class="text-center list-group-item list-group-item-danger">- '+SCTEXT("No Records Found")+" -</li>");else{var o=`<li class="list-group-item list-group-item-info"><div class="input-group"><span class="input-group-addon text-success"><i class="fa fa-lg fa-check-circle"></i>&nbsp;${SCTEXT("Found")}</span><input id="lookup_res_txt" type="text" class="form-control text-center" readonly="readonly" value="${t}" /><span class="input-group-btn"><button id="del_lookup_res" data-mid="${s.id}" class="btn btn-danger" type="button"><i class="fa fa-trash fa-lg"></i></button></span></div></li>`;$("#lookup_result").html(o)}}})}),$(document).on("click","#del_lookup_res",function(){var a=$(this).attr("data-mid"),t=$(this);bootbox.confirm({message:SCTEXT("This will delete the mobile number from database. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(e){e&&(t.attr("disabled","disabled").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>').css("cursor","progress"),$.ajax({url:app_url+"deleteNdncNumber/"+a,data:{tinfo:$("#tinfo").val()},success:function(a){$("#lookup_result").html('<li class="text-center list-group-item list-group-item-success"><i class="fa fa-lg fa-inverse fa-check-circle"></i>&nbsp;'+SCTEXT("Record Deleted")+"</li>").fadeIn(500).delay(2e3).fadeOut(500,function(){$(this).html("").fadeIn(100),$("#mobile_no").val("")})}}))}})}),$("#empty_tbl").click(function(){$(this).attr("data-tid");var a=$(this);a.attr("disabled","disabled").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>&nbsp; '+SCTEXT("Deleting All Data")+"..").css("cursor","progress"),bootbox.confirm({message:SCTEXT("This will delete all the data from the table. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){a.attr("disabled",!1).html(SCTEXT("Empty the Table")+" (TRUNCATE)").css("cursor","pointer"),t&&$.ajax({url:app_url+"bldbActions",method:"post",data:{tinfo:$("#tinfo").val(),mode:"empty"},success:function(a){bootbox.alert('<i class="fa fa-lg text-success fa-check-circle"></i>&nbsp;'+a)}})}})}),$("#opt_tbl").click(function(){$(this).attr("data-tid");var a=$(this);a.attr("disabled","disabled").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>&nbsp; '+SCTEXT("Optimizing Table")+"..").css("cursor","progress"),bootbox.confirm({message:SCTEXT("Optimization process will take a long time for large database. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){a.attr("disabled",!1).html(SCTEXT("Rebuild Index")+" (OPTIMIZE) ").css("cursor","pointer"),t&&$.ajax({url:app_url+"bldbActions",method:"post",data:{tinfo:$("#tinfo").val(),mode:"optimize"},success:function(a){bootbox.alert('<i class="fa fa-lg text-success fa-check-circle"></i>&nbsp;'+a)}})}})})),"manual_add_bldb"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Importing data")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},800),setTimeout(function(){$("#manadd_form").attr("action",app_url+"saveManualInsertBlDb"),$("#manadd_form").submit()},300)})}),$("#bk").click(function(){window.location=app_url+"manageBlacklists"})),"manual_del_bldb"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("This can take longer for large data. Please wait")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},800),setTimeout(function(){$("#mandel_form").attr("action",app_url+"saveManualDelBlDb"),$("#mandel_form").submit()},300)})}),$("#bk").click(function(){window.location=app_url+"manageBlacklists"})),"manage_ccrules"==curpage&&($("body").on("click",".closeDS",function(){$(".ruleinfo").popover("hide")}),$(document).on("click",".remove_ccr",function(){var a=$(this).attr("data-rid");bootbox.confirm({message:SCTEXT("This will delete the credit rule. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"delCountRule/"+a)}})})),"add_ccrule"!=curpage&&"edit_ccrule"!=curpage||($(".rangeto").on("keyup",function(){var a=$(this),t=a.parent().parent().parent().next(),e=a.parent().next().find("span.label");t.find(".bg-white").val(parseInt(""==a.val()||isNaN(a.val())?0:a.val())+1),e.html(parseInt(parseInt(""==a.val()||isNaN(a.val())?0:a.val())/parseInt(a.attr("data-count")))+" chars/sms")}),$(".nextStep").on("click",function(){var a=$(this).attr("data-step");if("1"==a){if(""==$("#ccrname").val())return void bootbox.alert(SCTEXT("Please enter a name for this credit count rule."));var t=0;if($("#step-1-form").find(".rangeto").each(function(){var a=$(this);""==a.val()||isNaN(a.val())?(a.addClass("error-input"),t++):a.removeClass("error-input")}),t>0)return bootbox.alert(SCTEXT("Please enter correct values in all the fields")),void(t=0);$("#step-1-form").hide("slide",{direction:"left"},500,function(){$(".step-1").removeClass("active"),$(".step-2").addClass("active"),$("#step-2-form").removeClass("hidden").show("slide",{direction:"right"},400)})}if("2"==a){var e=0;if($("#step-2-form").find(".rangeto").each(function(){var a=$(this);""==a.val()||isNaN(a.val())?(a.addClass("error-input"),e++):a.removeClass("error-input")}),e>0)return bootbox.alert(SCTEXT("Please enter correct values in all the fields")),void(e=0);$("#step-2-form").hide("slide",{direction:"left"},500,function(){$(".step-2").removeClass("active"),$(".step-3").addClass("active"),$("#step-3-form").removeClass("hidden").show("slide",{direction:"right"},400)})}if("3"==a){var s=0;if($("#step-3-form").find(".input-sm").each(function(){var a=$(this);""==a.val()||isNaN(a.val())?(a.addClass("error-input"),s++):a.removeClass("error-input")}),s>0)return bootbox.alert("Please enter correct values in all the fields"),void(s=0);bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Adding Credit count rule")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_rule_form").attr("action",app_url+"saveCountRule"),$("#add_rule_form").submit()},100)})}}),$(".prevStep").on("click",function(){"2"==$(this).attr("data-step")&&$("#step-2-form").hide("slide",{direction:"right"},400,function(){$(".step-2").removeClass("active"),$(".step-1").addClass("active"),$("#step-1-form").removeClass("hidden").show("slide",{direction:"left"},400)}),"3"==$(this).attr("data-step")&&$("#step-3-form").hide("slide",{direction:"right"},400,function(){$(".step-3").removeClass("active"),$(".step-2").addClass("active"),$("#step-2-form").removeClass("hidden").show("slide",{direction:"left"},400)})}),$("#bk").click(function(){window.location=app_url+"manageCountRules"})),"edit_country"==curpage&&($("#timezone option").each(function(){$(this).val()==$("#curtz").val()&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2"),$("#save_changes").click(function(){""!=$("#ccname").val()?""!=$("#cpre").val()?""!=$("#cvl").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#edit_ctry_form").attr("action",app_url+"saveCountry"),$("#edit_ctry_form").submit()},150)}):bootbox.alert(SCTEXT("Valid mobile number lengths cannot be blank. Enter at least two values:<br>1. Mobile Number length with country prefix<br>2. Mobile Number length without country prefix")):bootbox.alert(SCTEXT("Calling prefix cannot be blank.")):bootbox.alert(SCTEXT("Country name cannot be blank."))}),$("#bk").click(function(){window.location=app_url+"manageCountries"})),"upload_prefix"==curpage&&($("#save_changes").click(function(){"0"!=$("#country").val()?0!=$(".uploadedFile").length?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Importing prefixes & operator data")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#upload_ocpr_form").attr("action",app_url+"importPrefixes"),$("#upload_ocpr_form").submit()},150)}):bootbox.alert(SCTEXT("Please upload a file with prefixes and operator data.")):bootbox.alert(SCTEXT("Please select the country for which the prefixes are being uploaded."))}),$("#bk").click(function(){window.location=app_url+"manageCountries"})),"view_prefix"==curpage&&$(document).on("click",".delprefix",function(){var a=$(this).attr("data-pid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this prefix?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteOP/"+a+"/"+$("#cid").val())}})}),"edit_prefix"==curpage&&($("#msel").on("change",function(){let a=$("#msel option:selected").attr("data-nw"),t=$("#msel option:selected").attr("data-rg");$("#operator").val(a),$("#circle").val(t)}),$("#save_changes").click(function(){""!=$("#prefix").val()?""!=$("#operator").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving prefixes & operator data")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},100),setTimeout(function(){$("#edit_pre_form").attr("action",app_url+"saveOP"),$("#edit_pre_form").submit()},90)}):bootbox.alert(SCTEXT("Operator cannot be blank. Please enter operator associated with the mobile prefix")):bootbox.alert(SCTEXT("Prefix cannot be blank. Please enter mobile prefix"))}),$("#bk").click(function(){window.location=app_url+"viewAllOP/"+$("#cid").val()})),"manage_routes"==curpage&&($(document).on("change",".togstatus",function(){var a=$(this).attr("data-rid"),t=1;$(this).is(":checked")&&(t=0),$.ajax({url:app_url+"changeRouteStatus",method:"post",data:{rid:a,status:t},success:function(a){bootbox.alert(a)}})}),$(document).on("click",".remove_route",function(){var a=$(this).attr("data-rid");bootbox.confirm({message:"<h4><i class='fa fa-lg fa-info-circle text-danger'></i> "+SCTEXT("Caution")+" !! </h4>"+SCTEXT("This route may be assigned to users with SMS balance associated with this route. If you delete this route, they will get refund of the equal amount of SMS left in their accounts. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteRoute/"+a)}})})),"add_route"!=curpage&&"edit_route"!=curpage||($("#prismpp, #bkpsmpp").on("change",function(){let a=$("option:selected",this);"prismpp"==a.parent().attr("id")?$("#pritype").val(a.attr("data-smsc")):$("#bkptype").val(a.attr("data-smsc"))}),$("#ralgo").on("change",function(){let a=$(this).val();$(".ralgoctrs").addClass("hidden"),$(`#ralgo_${a}`).removeClass("hidden")}),$("#add_persmpprow").on("click",function(){let a=`${$("#ralgo_1_tbody").html()} ${atob($("#persmpprow").val())}`;$("#ralgo_1_tbody").html(a)}),$("#add_rrsmpprow").on("click",function(){let a=`${$("#ralgo_2_tbody").html()} ${atob($("#rrsmpprow").val())}`;$("#ralgo_2_tbody").html(a)}),$("#add_lcrsmpprow").on("click",function(){let a=`${$("#ralgo_3_tbody").html()} ${atob($("#lcrsmpprow").val())}`;$("#ralgo_3_tbody").html(a)}),$(document).on("click",".rmrow",function(){$(this).parent().parent().remove()}),$("#cov").change(function(){0==$("#cov option:selected").val()?$("#pfx-toggle").addClass("disabledBox"):$("#pfx-toggle").removeClass("disabledBox");var a=$("#cov option:selected").attr("data-tz");$("#acttz").val(a)}),$(".acttype").click(function(){1==$(this).val()?$("#spectime").fadeIn():$("#spectime").fadeOut()}),$("#save_changes").click(function(){""!=$("#rt_title").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving SMS route in the system")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_route_form").attr("action",app_url+"saveRoute"),$("#add_route_form").submit()},150)}):bootbox.alert(SCTEXT("Please enter a title for this route"))}),$("#bk").click(function(){window.location=app_url+"manageRoutes"})),"smpp_dlrcodes"==curpage&&($("#add_new_code").click(function(){$newrow=$("#newrowstr").val(),$(".empty_table").length>0?$("#codes_ctnr").html($newrow):$("#codes_ctnr").append($newrow)}),$(document).on("change",".dlrcodeaction",function(){let a=$(this).val(),t=$(this).parent().next();"0"==a?t.html('<select name="act_params[]" class="form-control"><option value="0">- Select Action First -</option></select>'):"1"==a?t.html($("#allref_opts").val()):t.html($("#allrt_opts").val())}),$("body").on("click",".rmv",function(){$(this).parent().parent().remove()}),$("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving DLR codes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_dlrcode_form").attr("action",app_url+"saveSmppDlrCodes"),$("#add_dlrcode_form").submit()},150)})}),$("#bk").click(function(){window.location=app_url+"manageSmpp"})),"add_rrule"!=curpage&&"edit_rrule"!=curpage||($("#save_changes").click(function(){""!=$("#rname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Refund Rule")}. . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_rrule_form").attr("action",app_url+"saveRefundRule"),$("#add_rrule_form").submit()},150)}):bootbox.alert(SCTEXT("Rule name cannot be blank"))}),$("#bk").click(function(){window.location=app_url+"refundRules"})),"kannel_mon"==curpage&&(0!=$("html").scrollTop()&&$("html, body").animate({scrollTop:0},"fast"),$(".reloadPg").click(function(){$(this).find(".fa").addClass("fa-spin"),window.location.reload(!1)}),$(".kmon-action").click(function(){var a=$(this).attr("data-act");bootbox.prompt({title:SCTEXT("Please enter Kannel administration password"),inputType:"password",callback:function(t){if(t){var e=bootbox.dialog({message:`<p class="text-center"><i class="fa fa-large fa-spin fa-circle-o-notch"></i>&nbsp;&nbsp;${SCTEXT("Please wait")} . . .</p>`,size:"small",closeButton:!1});$.ajax({url:app_url+"kannelActions",method:"post",data:{action:a,kpass:t},success:function(s){"editConf"==a?"failed"==s?location.reload():($(e).modal("hide"),bootbox.confirm({message:`<div class="bg-dark text-white p-sm m-t-sm"> <h4>Edit Kannel Conf</h4></div> <div class="m-t-md p-xs" style="max-height: 400px; overflow: auto;"><div id="kannel_conf_edtr" spellcheck=false contenteditable="true" style="font-family:monospace;font-size:0.95em;color:darkred;">${s}</div></div>`,buttons:{cancel:{label:SCTEXT("Exit"),className:"btn-default"},confirm:{label:SCTEXT("Save Changes"),className:"btn-info"}},callback:function(a){if(a){let a=$("#kannel_conf_edtr").html();$.ajax({url:app_url+"kannelActions",method:"post",data:{action:"saveConf",kpass:t,confData:a},success:function(a){location.reload()}})}}})):location.reload()}})}}})}),$(".stop-smsc").click(function(){var a=$(this).attr("data-smsc");bootbox.prompt({title:SCTEXT("Please enter Kannel administration password"),inputType:"password",callback:function(t){if(t){bootbox.dialog({message:`<p class="text-center"><i class="fa fa-large fa-spin fa-circle-o-notch"></i>&nbsp;&nbsp;${SCTEXT("Please wait")} . . .</p>`,size:"small",closeButton:!1});$.ajax({url:app_url+"kannelActions",method:"post",data:{action:"stop-smsc",smsc:a,kpass:t},success:function(a){location.reload()}})}}})}),$(".start-smsc").click(function(){var a=$(this).attr("data-smsc");bootbox.prompt({title:SCTEXT("Please enter Kannel administration password"),inputType:"password",callback:function(t){if(t){bootbox.dialog({message:`<p class="text-center"><i class="fa fa-large fa-spin fa-circle-o-notch"></i>&nbsp;&nbsp;${SCTEXT("Please wait")} . . .</p>`,size:"small",closeButton:!1});$.ajax({url:app_url+"kannelActions",method:"post",data:{action:"start-smsc",smsc:a,kpass:t},success:function(a){location.reload()}})}}})})),"manage_annc"==curpage&&$(document).on("change",".togstatus",function(){var a=0;$(this).is(":checked")&&(a="1");var t=$(this).val();$.ajax({method:"post",url:app_url+"setAnnouncementState",data:{value:a,aid:t}})}),"add_annc"!=curpage&&"edit_annc"!=curpage||($("#save_changes").click(function(){""!=$("#dtxt").val?0!=$("#dfor").val?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Announcement")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#annfrm").attr("action",app_url+"saveAnnouncement"),$("#annfrm").submit()},150)}):bootbox.alert(SCTEXT("Please select the users who will see this announcement.")):bootbox.alert(SCTEXT("Please enter the message to broadcast."))}),$("#bk").click(function(){window.location=app_url+"announcements"})),"manage_smsplans"==curpage&&$(document).on("click",".del-plan",function(){var a=$(this).attr("data-pid");$(this).attr("data-ucount");bootbox.confirm({message:SCTEXT("There may be some user accounts associated with this plan. Are you sure you want to delete this plan?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"delSmsPlan/"+a)}})}),"add_smsplan"!=curpage&&"edit_smsplan"!=curpage||($("#pt1, #pt2").click(function(){1==$(this).val()?($("#volbox").addClass("hidden"),$("#volftbox").addClass("hidden"),$("#subbox").removeClass("hidden"),$("#subftbox").removeClass("hidden"),$("#sexp_box").removeClass("hidden")):($("#subbox").addClass("hidden"),$("#subftbox").addClass("hidden"),$("#volbox").removeClass("hidden"),$("#volftbox").removeClass("hidden"),$("#sexp_box").addClass("hidden"))}),$("#proutes").on("select2:select",function(a){var t=a.params.data.id,e=a.params.data.text;$("#splan-vol thead tr").append('<th id="rhcol'+t+'">'+e+"</th>");var s=0;$("#splan-vol tbody tr").each(function(){$(this).append('<td class="tdcol'+t+'" data-colname="'+e+'"><div class="input-group"><span class="input-group-addon"> '+app_currency+' </span><input type="text" class="form-control input-small-sc input-sm" name="price['+s+"]["+t+']" placeholder="e.g. 0.05" value="" /><span class="input-group-addon">/sms</span></div></td>'),s++}),$(".poptrt").each(function(){var a=$(this).parent().parent().parent().attr("id");$(this).append('<div class="rtblock'+t+'"><div class="text-white text-center label-info">'+e+'</div><div class="rtopts"><div class="control-label">'+SCTEXT("SMS Credits")+':</div> <div class="input-group"><input type="text" class="form-control" name="poptcredits['+a+"]["+t+']" placeholder="e.g. 1000"/><span class="input-group-addon"> SMS</span></div><div class="control-label">'+SCTEXT("Additional Purchases")+':</div><div class="input-group"><span class="input-group-addon">'+app_currency+'</span><input type="text" class="form-control" name="poptaddrate['+a+"]["+t+']" placeholder="e.g. 0.05"/><span class="input-group-addon">per sms</span></div></div></div>')})}),$("#proutes").on("select2:unselect",function(a){var t=a.params.data.id;a.params.data.text;$("#splan-vol thead tr").find($("th#rhcol"+t)).remove(),$("#splan-vol tbody tr").each(function(){$(this).find($("td.tdcol"+t)).remove()}),$(".poptrt").each(function(){$(this).find(".rtblock"+t).remove()})}),$("#add_subplan").click(function(){var a=parseInt($(this).attr("data-oid"))+1;if($(this).attr("data-oid",a),$("#plan_id").length>0)var t="P"+$("#plan_id").val()+"-SU-POPT-"+a;else t="SU-POPT-"+a;var e='<div id="'+t+'" class="col-md-3 planopts"><input type="hidden" name="subopts[]" value="'+t+'" /><a href="javascript:void(0);" class="plan-remove" data-oid="'+a+'"><i class="fa fa-3x text-danger fa-minus-circle"></i> </a><div class="panel panel-info"><div class="panel-heading"><input type="text" data-oid="'+a+'" class="poptnametxt form-control" placeholder="'+SCTEXT("enter plan option name e.g. PRO")+'" name="poptname['+t+']" /></div><div class="panel-body"><div class="popt-item"><select class="form-control" data-plugin="select2" data-placeholder="'+SCTEXT("choose payment cycle")+'.." name="poptcycle['+t+']"><option></option><option value="m">'+SCTEXT("Monthly")+'</option><option value="y">'+SCTEXT("Yearly")+'</option></select></div><div class="popt-item"><div class="input-group"><span class="input-group-addon">'+app_currency+'</span><input type="text" class="form-control" name="poptrate['+t+']" placeholder="'+SCTEXT("enter subscription Fee e.g. 150")+'"/></div></div><div class="popt-item poptrt">';$("#proutes :selected").each(function(){var a=$(this).val(),s=$(this).text();e+='<div class="rtblock'+a+'"><div class="text-white text-center label-info">'+s+'</div><div class="rtopts"><div class="control-label">'+SCTEXT("SMS Credits")+':</div> <div class="input-group"><input type="text" class="form-control" name="poptcredits['+t+"]["+a+']" placeholder="e.g. 1000"/><span class="input-group-addon"> SMS</span></div><div class="control-label">'+SCTEXT("Additional Purchases")+':</div><div class="input-group"><span class="input-group-addon">'+app_currency+'</span><input type="text" class="form-control" name="poptaddrate['+t+"]["+a+']" placeholder="e.g. 0.05"/><span class="input-group-addon">per sms</span></div></div></div>'}),e+='</div><div class="popt-item"><textarea name="poptdesc['+t+']" class="form-control" placeholder="'+SCTEXT("enter a small description e.g. list some features etc.")+'"></textarea></div><div class="popt-item"><select class="form-control" data-plugin="select2" data-placeholder="'+SCTEXT("choose opt-in method")+'.." name="poptsel['+t+']"><option></option><option value="0">'+SCTEXT("Payment & Sign Up")+'</option><option value="1">'+SCTEXT("Contact form")+"</option> </select></div></div></div></div>",$("#subbox").append(e),$("#subbox").find("select").each(function(){var a=$(this).attr("data-placeholder");$(this).select2({placeholder:a})}),$("html,body").animate({scrollTop:$("#"+t).offset().top-100},"slow");var s='<div id="FT-SU-POPT-'+a+'" class="panel panel-info"><div class="panel-heading">- PLAN</div><div class="panel-body"><div class="clearfix"><div class="col-md-4 splanft-item"><div class="widget"><header class="widget-header"><h4 class="widget-title">'+SCTEXT("Allowed SMS Types")+'</h4></header><hr class="widget-separator"><div class="widget-body"><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][flash]" type="checkbox" data-switchery data-color="#35b8e0" checked="checked"><label>Flash</label></div><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][wap]" type="checkbox" data-switchery data-color="#35b8e0" checked="checked"> <label>WAP-Push</label></div><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][vcard]" type="checkbox" data-switchery data-color="#35b8e0" checked="checked"><label>VCard</label></div><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][unicode]" type="checkbox" data-switchery data-color="#35b8e0" checked="checked"><label>Unicode</label></div><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][per]" type="checkbox" data-switchery data-color="#35b8e0" checked="checked"><label>Personalised SMS</label></div></div></div></div><div class="col-md-4 splanft-item"><div class="widget"><header class="widget-header"><h4 class="widget-title">'+SCTEXT("Allowed API access")+'</h4></header><hr class="widget-separator"><div class="widget-body"><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][hapi]" type="checkbox" data-switchery data-color="#ff5b5b" checked="checked"><label>HTTP API</label></div><div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+'][xapi]" type="checkbox" data-switchery data-color="#ff5b5b" checked="checked"><label>XML API</label></div></div></div></div><div class="col-md-4 splanft-item"><div class="widget"><header class="widget-header"><h4 class="widget-title">'+SCTEXT("Allowed Refunds")+'</h4></header><hr class="widget-separator"><div class="widget-body">';$("#reftypebox").find("input").each(function(){var a=$(this).attr("data-refid"),e=$(this).attr("data-ref");s+='<div class="m-b-xs m-r-xl"><input data-size="small" name="sftperm['+t+"][ref]["+a+']" type="checkbox" data-switchery data-color="#10c469" checked="checked"><label>'+e+"</label></div>"}),s+="</div></div></div></div></div></div>",$("#subftbox").append(s),$("#FT-SU-POPT-"+a).find("input").each(function(){var a=$(this).attr("data-color"),t=$(this).attr("data-size");new Switchery(this,{color:a,size:t,jackColor:"#ffffff"})})}),$(document).on("click",".plan-remove",function(){var a=$(this);bootbox.confirm({message:SCTEXT("You will lose the data associated with this plan option. Are you sure you want to delete?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){if(t){a.parent().remove();var e=a.attr("data-oid");$("#FT-SU-POPT-"+e).remove()}}})}),$(document).on("keyup",".poptnametxt",function(){var a=$(this).attr("data-oid"),t=$(this).val();$("#FT-SU-POPT-"+a).find(".panel-heading").text(t+" - PLAN")}),$(document).on("keyup",".rangeto",function(){var a=$(this);a.parent().parent().parent().next().find(".bg-white").val(parseInt(""==a.val()||isNaN(a.val())?0:a.val())+1)}),$(".nextStep").on("click",function(){var a=$(this).attr("data-step");if("1"==a){if(""==$("#pname").val())return void bootbox.alert(SCTEXT("Please enter a name for this SMS Plan."));if(null==$("#proutes").val())return void bootbox.alert(SCTEXT("Please choose at least one Route."));$("#step-1-form").hide("slide",{direction:"left"},500,function(){$(".step-1").removeClass("active"),$(".step-2").addClass("active"),$("#step-2-form").removeClass("hidden").show("slide",{direction:"right"},400)})}if("2"==a){var t=0;if($("input[name=ptype]:checked","#add_splan_form").val(),t>0)return bootbox.alert(SCTEXT("Please enter correct values in all the fields")),void(t=0);$("#step-2-form").hide("slide",{direction:"left"},500,function(){$(".step-2").removeClass("active"),$(".step-3").addClass("active"),$("#step-3-form").removeClass("hidden").show("slide",{direction:"right"},400)})}"3"==a&&bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving SMS Plan")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_splan_form").attr("action",app_url+"saveSmsPlan"),$("#add_splan_form").submit()},100)})}),$(".prevStep").on("click",function(){"2"==$(this).attr("data-step")&&$("#step-2-form").hide("slide",{direction:"right"},400,function(){$(".step-2").removeClass("active"),$(".step-1").addClass("active"),$("#step-1-form").removeClass("hidden").show("slide",{direction:"left"},400)}),"3"==$(this).attr("data-step")&&$("#step-3-form").hide("slide",{direction:"right"},400,function(){$(".step-3").removeClass("active"),$(".step-2").addClass("active"),$("#step-2-form").removeClass("hidden").show("slide",{direction:"left"},400)})}),$("#bk").click(function(){window.location=app_url+"manageSmsPlans"})),"manage_teams"==curpage&&$(document).on("click",".del_team",function(){var a=$(this).attr("data-tid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this team?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"delStaffTeam/"+a)}})}),"add_team"!=curpage&&"edit_team"!=curpage||($("input.toggle").change(function(){var a=$(this).attr("data-group")+"_roles",t=$(this).attr("id");0==$("#"+t+":checked").length?$("#"+a).find("input[type=checkbox]").each(function(){$(this).prop("checked",!1)}):$("#"+a).find("input[type=checkbox]").each(function(){$(this).prop("checked",!0)})}),$("#save_changes").click(function(){""!=$("#tname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Staff Team")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#team_form").attr("action",app_url+"saveStaffTeam"),$("#team_form").submit()},200)}):bootbox.alert(SCTEXT("Please enter the team name."))}),$("#bk").click(function(){window.location=app_url+"manageStaffTeams"})),"manage_staff"==curpage&&$(document).on("click",".del_staff",function(){var a=$(this).attr("data-uid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this staff member?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"delStaff/"+a)}})}),"add_staff"==curpage){var erremail=0,errloginid=0,errphone=0,errpass=0,emsg="";$("#save_changes").click(function(){""!=$("#sname").val()?""!=$("#semail").val()&&""!=$("#sphn").val()&&""!=$("#slogin").val()&&""!=$("#spass").val()?1!=erremail&&1!=errloginid&&1!=errphone&&1!=errpass?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Staff Member")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#staff_form").attr("action",app_url+"saveStaff"),$("#staff_form").submit()},200)}):""==emsg?bootbox.alert(SCTEXT("Some errors are found with your entry. Please rectify before submitting the form.")):bootbox.alert(emsg):bootbox.alert(SCTEXT("Please enter values in all the fields.")):bootbox.alert(SCTEXT("Please enter the staff member name."))}),$("#bk").click(function(){window.location=app_url+"manageStaff"}),$("#spass, #spass2").on("keyup blur",function(){var a=$(this).attr("data-strength"),t=$(this).val();"weak"==a&&(t.length<6?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""))),"average"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[a-zA-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text("")):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one alphabet letter."))))),"strong"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[A-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text(""),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one special character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one uppercase letter."))))),0==errpass&&($("#spass").val()!=$("#spass2").val()?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Passwords do not match each other. Please re-type your password"))):(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))))}),$("#slogin").on("keyup blur",function(){var a=$(this).val();$("#v-login").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),a.indexOf(" ")>=0||a.length<5?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),errloginid=1,emsg=SCTEXT("Invalid login ID. Must be at least 5 characters without spaces.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),errloginid=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",async:!1,data:{mode:"login",value:a},success:function(a){"FALSE"==a?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),errloginid=1,emsg=SCTEXT("Login ID already exist. Please enter a different login ID.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),errloginid=0,emsg="")}}))}),$("#semail").on("keyup blur",function(){var a=$(this).val();$("#v-email").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),echeck(a)?($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",async:!1,data:{mode:"email",value:a},success:function(a){"FALSE"==a?($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Email ID already exist. Please enter a different email ID.")):($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="")}})):($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Invalid Email ID"))}),$("#sphn").on("keyup blur",function(){var a=$(this).val();$("#v-phn").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),isValidPhone(a)?($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",async:!1,data:{mode:"mobile",value:a},success:function(a){"FALSE"==a?($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Phone number already exist. Please enter a different phone number.")):($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="")}})):($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Invalid Phone number entered."))})}if("view_staff"==curpage){var errpass=1;$("#changeTeam").click(function(){var a=$(this).attr("data-uid"),t=$("#team").val();$(this).attr("disabled","disabled").css("cursor","progress"),$.ajax({url:app_url+"changeTeam",method:"post",data:{user:a,team:t},success:function(){window.location.reload()}})}),$("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Staff Rights")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#staff_form").attr("action",app_url+"saveStaffRights"),$("#staff_form").submit()},200)})}),$("#bk").click(function(){window.location=app_url+"manageStaff"}),$("#delStaff").click(function(){var a=$(this).attr("data-uid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this staff member?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"delStaff/"+a)}})}),$("#resetPass").click(function(){$("#resetPassBox").modal()}),$(document).on("click","#resetPassSubmit",function(){if(1!=errpass){var a=$("#spass").val(),t=$("#spass2").val(),e=$("#staff_uid").val();$(this).attr("disabled","disabled").css("cursor","progress"),$.ajax({url:app_url+"passwordReset",method:"post",data:{user:e,cat:"staff",pass1:a,pass2:t},success:function(){window.location.reload()}})}}),$(document).on("keyup blur","#spass, #spass2",function(){var a=$(this).attr("data-strength"),t=$(this).val();"weak"==a&&(t.length<6?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""))),"average"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[a-zA-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text("")):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one alphabet letter."))))),"strong"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[A-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text(""),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one special character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one uppercase letter."))))),0==errpass&&($("#spass").val()!=$("#spass2").val()?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Passwords do not match each other. Please re-type your password"))):(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))))}),$("input.toggle").change(function(){var a=$(this).attr("data-group")+"_roles",t=$(this).attr("id");0==$("#"+t+":checked").length?$("#"+a).find("input[type=checkbox]").each(function(){$(this).prop("checked",!1)}):$("#"+a).find("input[type=checkbox]").each(function(){$(this).prop("checked",!0)})})}if("manage_users"==curpage&&$("#usrfilter").length>0&&$("#usrfilter").on("change",function(){var a=$("#usrfilter option:selected").val();$("#t-usrlist").dataTable().api().ajax.url(app_url+"getAllUsers?flag="+a).load()}),"add_user"==curpage){let a=0,t=0;var erremail=0,errloginid=0,errphone=0,errpass=0,emsg="",errcredits=0;$("#acctype").length>0&&($("#acctype").on("change",function(){let e=$(this).val();$("#acctypeinfo").text($("#acctype option:selected").attr("data-info")),"1"==e?($("#ucat").html(`<option value="client">${SCTEXT("Client Account")}</option>`).trigger("change.select2"),$("#creditbox").hide("fade",function(){$("#dynamicbox").hide("fade",function(){$("#currencybox").show()})}),a=1,t=0):"2"==e?($("#ucat").html(`<option value="client">${SCTEXT("Client Account")}</option>`).trigger("change.select2"),$("#currencybox").hide("fade",function(){$("#creditbox").hide("fade",function(){$("#dynamicbox").show()})}),a=0,t=1):($("#ucat").html(`<option value="client">${SCTEXT("Client Account")}</option><option value="reseller">${SCTEXT("Reseller Account")}</option>`).trigger("change.select2"),$("#dynamicbox").hide("fade",function(){$("#currencybox").hide("fade",function(){$("#creditbox").show()})}),a=0,t=0)}),$("#mccmncplansxdswa2").on("change",function(){$("#mplanscredits").trigger("blur")})),$("#currencybox").length>0&&($(document).on("keyup blur input","#mplanscredits",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input");let a=$("#mccmncplans option:selected").attr("data-ptax"),t=$("#mccmncplans option:selected").attr("data-taxtype"),s=parseFloat($("#mplanscredits").val())||0,o=0,r="including all taxes";if(parseFloat(a)>0){o=(s+parseFloat(s*(a/100))).toFixed(2),r=`including ${a}% ${[{tax:"GT",str:"GST"},{tax:"VT",str:"VAT"},{tax:"ST",str:"Service Tax"},{tax:"SC",str:"Service Charges"},{tax:"OT",str:"Other Taxes"}].find(a=>a.tax==t).str}`}else o=s.toFixed(2);$("#total_payable").text(new Number(o).toLocaleString("en-US",{minimumFractionDigits:2})),$("#mcc_taxes").text(`(${r})`)}),$(document).on("keyup blur input","#curcredits",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input");let a=parseFloat($("#utax_cur").val())||0,t=parseFloat($("#curcredits").val())||0,s=0;s=a>0?(t+parseFloat(t*(a/100))).toFixed(2):t.toFixed(2),$("#total_amt_cur").text(new Number(t).toLocaleString("en-US",{minimumFractionDigits:2})),$("#grand_total_amt_cur").text(new Number(s).toLocaleString("en-US",{minimumFractionDigits:2})),$("#cur_taxes").text("(including all taxes)")})),$("#upass, #upass2").on("keyup blur",function(){var a=$(this).attr("data-strength"),t=$(this).val();"weak"==a&&(t.length<6?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""))),"average"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[a-zA-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text("")):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one alphabet letter."))))),"strong"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[A-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text(""),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one special character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one uppercase letter."))))),0==errpass&&($("#upass").val()!=$("#upass2").val()?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Passwords do not match each other. Please re-type your password"))):(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))))}),$("#ulogin").on("keyup blur",function(){var a=$(this).val();$("#v-login").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),a.indexOf(" ")>=0||a.length<5?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),errloginid=1,emsg=SCTEXT("Invalid login ID. Must be at least 5 characters without spaces.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),errloginid=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",data:{mode:"login",value:a},success:function(a){"FALSE"==a?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),errloginid=1,emsg=SCTEXT("Login ID already exist. Please enter a different login ID.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),errloginid=0,emsg="")}}))}),$("#uemail").on("keyup blur",function(){var a=$(this).val();$("#v-email").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),echeck(a)?($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",data:{mode:"email",value:a},success:function(a){"FALSE"==a?($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Email ID already exist. Please enter a different email ID.")):($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="")}})):($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Invalid Email ID"))}),$("#uphn").on("keyup blur",function(){var a=$(this).val();$("#v-phn").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),isValidPhone(a)?($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",data:{mode:"mobile",value:a},success:function(a){"FALSE"==a?($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Phone number already exist. Please enter a different phone number.")):($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="")}})):($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Invalid Phone number entered."))}),$(document).on("change",".route-sel",function(){let a=`#rtcredetail-${$(this).attr("data-rid")}`;$(this).is(":checked")?$(a).collapse("show"):$(a).collapse("hide"),$("input.rtcredits").trigger("blur")}),$(document).on("change",".route-sel-cur",function(){let a=`#rtcurdetail-${$(this).attr("data-rid")}`;$(this).is(":checked")?$(a).collapse("show"):$(a).collapse("hide"),$("input.rtcredits").trigger("blur")}),$("#plan").change(function(){var a=$(this).val(),t=$("#plan option:selected").attr("data-type"),e=$("#plan option:selected").attr("data-rts");$.ajax({url:app_url+"getSelPlanOptions",method:"post",data:{planid:a,ptype:t,routes:e},success:function(e){if($("#total_amt, #grand_total_amt").text("0.00"),$("#udis, #utax").val(""),$("#plan_taxes").text(""),"0"==t){var s;s=JSON.parse(e).opt_data;var o="";let t=0;for(rid in s)o+=0==a?`<div class="po-ctr m-b-sm" data-rid="${rid}"><div><input data-switchery data-color="#10c469" data-size="small" id="rtsel-${rid}" data-rid="${rid}" class="route-sel" name="route[${rid}]" type="checkbox" ${0==t?"checked":""} > <label for="rtsel-${rid}"> ${s[rid].title}</label></div><div id="rtcredetail-${rid}" class="clearfix collapse ${0==t?"in":""}"><table class="wd100 table row-border"><thead><tr><th>${SCTEXT("SMS Credits")}</th><th>${SCTEXT("Per SMS Cost")}</th> </tr> </thead><tbody><tr> <td> <div class="input-group"><input id="rtcre-${rid}" class="rtcredits form-control input-small-sc input-sm" name="credits[${rid}]" placeholder="e.g. 5000" value="" type="text"><span class="input-group-addon">sms</span></div></td><td> <div class="input-group"><span class="input-group-addon"> ${app_currency} </span><input id="rtprc-${rid}" class="rtrates form-control input-small-sc input-sm" name="price[${rid}]" placeholder="e.g. 0.05" value="" type="text"></div></td></tr></tbody></table> </div></div>`:`<div class="po-ctr m-b-sm" data-rid="${rid}"><div><input data-switchery data-color="#10c469" data-size="small" id="rtsel-${rid}" data-rid="${rid}" class="route-sel" name="route[${rid}]" type="checkbox" ${0==t?"checked":""} > <label for="rtsel-${rid}"> ${s[rid].title}</label></div><div id="rtcredetail-${rid}" class="clearfix collapse ${0==t?"in":""}"><table class="wd100 table row-border"><thead><tr><th>${SCTEXT("SMS Credits")}</th><th>${SCTEXT("Per SMS Cost")}</th> </tr> </thead><tbody><tr> <td> <div class="input-group"><input id="rtcre-${rid}" data-pid="${a}" class="rtcredits form-control input-small-sc input-sm" name="credits[${rid}]" placeholder="e.g. 5000" value="" type="text"><span class="input-group-addon">sms</span></div></td><td> <div class="input-group"><span class="input-group-addon"> ${app_currency} </span><input id="rtprc-${rid}" class="rtrates form-control input-small-sc input-sm" name="price[${rid}]" placeholder="e.g. 0.05" readonly value="${s[rid].price}" type="text"></div></td></tr></tbody></table> </div></div>`,t++;$("div.route-assign-ctr").html(o),$("#routes-n-credits").find(".control-label").each(function(){$(this).text(SCTEXT("Routes & Credits")+":")}),$("#ptype").val("0"),createSwitches("route-sel")}else{var r;r=JSON.parse(e).opt_data;o='<select name="plan_option" id="popt-sel" class="form-control" data-plugin="select2"><option></option>';for(idn in r){var n="m"==r[idn].cycle?app_currency+r[idn].fee+" per month":app_currency+r[idn].fee+" per year";o+='<option value="'+idn+'">'+r[idn].name+" Plan ( "+n+" )</option>"}o+="</select>",$("div.route-assign-ctr").html(o),$("div.route-assign-ctr").find("#popt-sel").each(function(){$(this).select2({placeholder:SCTEXT("Choose Plan Option")+" . . ."})}),$("#routes-n-credits").find(".control-label").each(function(){$(this).text(SCTEXT("Plan Options:"))}),$("#ptype").val("1")}}})}),$(document).on("keyup blur input",".rtcredits, .rtrates",function(a){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void a.preventDefault();$(this).removeClass("error-input");var t=[],e=parseInt($("#plan").val());$("#routes-n-credits").find(".po-ctr").each(function(){var a=$(this).attr("data-rid");if($("#rtsel-"+a).is(":checked")){var e={id:a,credits:$("#rtcre-"+a).val(),price:$("#rtprc-"+a).val()};t.push(e)}}),$.ajax({url:app_url+"getPlanSmsPrice",method:"post",data:{plan:e,routesData:JSON.stringify(t),discount:$("#udis").val(),dtype:$("#distype").val(),addTax:$("#utax").val()},success:function(a){var t;if(t=JSON.parse(a),"0"!=e)for(grid in t.price)$("#rtprc-"+grid).val(t.price[grid].price);var s=t.total_plan,o=t.plan_tax,r=t.grand_total;$("#total_amt").text(s),$("#plan_taxes").text(o),$("#grand_total_amt").text(r),errcredits="1"==t.errcredits?1:0}})}),$(document).on("change","#popt-sel",function(){var a=$("#plan").val(),t=$(this).val();$.ajax({url:app_url+"getPlanSmsPrice",method:"post",data:{mode:"sub",plan:a,idn:t,discount:$("#udis").val(),dtype:$("#distype").val(),addTax:$("#utax").val()},success:function(a){var t,e=(t=JSON.parse(a)).total_plan,s=t.plan_tax,o=t.grand_total;$("#total_amt").text(e),$("#plan_taxes").text(s),$("#grand_total_amt").text(o)}})}),$("#utax, #udis").on("keyup blur",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input"),"1"==$("#ptype").val()?$("#popt-sel").trigger("change"):$("input.rtcredits").trigger("blur")}),$("#distype").on("change",function(){"1"==$("#ptype").val()?$("#popt-sel").trigger("change"):$("input.rtcredits").trigger("blur")}),$("#utax_cur, #udis_cur").on("keyup blur",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input"),$("#curcredits").trigger("blur")}),$("#distype_cur").on("change",function(){$("#curcredits").trigger("blur")}),$("#inv-p, #inv-d").click(function(){"1"==$(this).val()?$("#invrmbox").removeClass("hidden"):$("#invrmbox").addClass("hidden")}),$("#acts_dp").length>0&&($("#acts_dp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom"}),$("#acte_dp").datetimepicker({minDate:moment(),showClose:!0,useCurrent:!1,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom"}),$("#acte_dp, #acts_dp").on("dp.show",function(a){$(".dpclose").html("<i class='fa fa-lg fa-check'></i>&nbsp;&nbsp;Done")})),$("#save_changes").click(function(){if(""!=$("#uname").val())if(""!=$("#uemail").val()&&""!=$("#uphn").val()&&""!=$("#ulogin").val()&&""!=$("#upass").val())if(1!=erremail&&1!=errloginid&&1!=errphone&&1!=errpass)if(1!=errcredits)if("1"!=$("#ptype").val()||"reseller"!=$("#ucat").val()){if(0==a){if("0"==$("#ptype").val()){var e=0;if(0==t?$("#routes-n-credits").find(".po-ctr").each(function(){var a=$(this).attr("data-rid");if($("#rtsel-"+a).is(":checked")){if(""==$("#rtcre-"+a).val())return $("#rtcre-"+a).addClass("error-input"),e=1,$cemsg=SCTEXT("Please enter the credits to be assigned. If you do not wish to assign this route, uncheck the Route name."),!1;if($("#rtcre-"+a).removeClass("error-input"),e=0,""==$("#rtprc-"+a).val()||0==$("#rtprc-"+a).val())return $("#rtprc-"+a).addClass("error-input"),e=1,$cemsg="Please enter the sms rate. This cannot be blank or zero",!1;$("#rtprc-"+a).removeClass("error-input"),e=0}}):$("#routes-n-credits-cur").find(".po-ctr").each(function(){var a=$(this).attr("data-rid");if($("#rtcursel-"+a).is(":checked")){if(""==$("#rtcurprc-"+a).val()||0==$("#rtcurprc-"+a).val())return $("#rtcurprc-"+a).addClass("error-input"),e=1,$cemsg="Please enter the sms rate. This cannot be blank or zero",!1;$("#rtcurprc-"+a).removeClass("error-input"),e=0}}),1==e)return void bootbox.alert($cemsg)}else if(0==$("#popt-sel").val()||null==$("#popt-sel").val())return void bootbox.alert("Please select one subscription plan option for this user")}else if(""==$("#mplanscredits").val()||parseFloat($("#mplanscredits").val())<=0)return void bootbox.alert(SCTEXT("Please enter valid credits. This cannot be blank or zero"));bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Creating Account")}. . . ${SCTEXT("This might take a few seconds.")}</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#user_form").attr("action",app_url+"createUserAccount"),$("#user_form").submit()},200)})}else bootbox.alert(SCTEXT("Subscription based plans cannot be assigned to reseller accounts. Please choose a different plan or assign custom SMS rates."));else bootbox.alert(SCTEXT("You cannot assign more credits than available in your account."));else""==emsg?bootbox.alert(SCTEXT("Some errors are found with your entry. Please rectify before submitting the form.")):bootbox.alert(emsg);else bootbox.alert(SCTEXT("Please enter values in all the fields."));else bootbox.alert(SCTEXT("Please enter name of the user."))}),$("#bk").click(function(){window.location=app_url+"manageUsers"})}if("gen_web_set"==curpage&&($("#save_changes").click(function(){""!=$("#comname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Website Settings")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebSettings"),$("#set_form").submit()},200)}):bootbox.alert(SCTEXT("Please enter name of the company."))}),$("#bk").click(function(){window.location=app_url+"genWebSettings"})),"sig_web_set"==curpage&&($("#save_changes").click(function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($("#smsrate").val())&&""!=$("#smsrate").val())return $("#smsrate").addClass("error-input"),void bootbox.alert(SCTEXT("Please enter valid SMS rate"));($("#smsrate").removeClass("error-input"),isPositiveInteger($("#frecre").val()))?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Sign up Settings")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#sig_form").attr("action",app_url+"saveSignupSettings"),$("#sig_form").submit()},200)}):bootbox.alert(SCTEXT("Please enter valid SMS credits"))}),$("#bk").click(function(){window.location=app_url+"signupWebSettings"})),"thm_web_set"==curpage&&($("a.color").each(function(){var a=$(this);a.css("background-color",a.attr("data-color")),$("#ccode").val()==a.attr("data-color")&&a.addClass("activeColor")}),$(document).on("click","a.color",function(){var a=$(this);a.parent().parent().find("a.color").each(function(){$(this).removeClass("activeColor").html("")}),a.addClass("activeColor").html('<i class="fa fa-lg fa-check fa-inverse"></i>')}),$(document).on("click",".btn-primary",function(){var a=$(this),t=a.prev().prev().find("a.activeColor");$("#cname").val(t.attr("data-code")),$("#ccode").val(t.attr("data-color")),$("#tname").val(a.attr("data-theme")),bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Applying selected theme")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#thm_form").attr("action",app_url+"updateThemeSettings"),$("#thm_form").submit()},200)})})),"home_web_set"==curpage&&($(document).on("change",".sld-file",function(){var a=$(this);a.next().next().html(a.val())}),$("#twg-y, #twg-n").click(function(){"1"==$(this).val()?$("#twg-opts").removeClass("disabledBox"):$("#twg-opts").addClass("disabledBox")}),$("#sld-y, #sld-n").click(function(){"1"==$(this).val()?$("#sld-opts").removeClass("disabledBox"):$("#sld-opts").addClass("disabledBox")}),$("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Please wait. Saving Home page Settings")} . . This may take a while</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},1500),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebPageSettings"),$("#set_form").submit()},200)})}),$("#bk").click(function(){window.location=app_url+"homeWebSettings"})),"about_web_set"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving About page Settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebPageSettings"),$("#set_form").submit()},200)})}),$("#bk").click(function(){window.location=app_url+"aboutWebSettings"})),"pricing_web_set"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Pricing page Settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebPageSettings"),$("#set_form").submit()},200)})}),$("#bk").click(function(){window.location=app_url+"pricingWebSettings"})),"contact_web_set"==curpage&&($("#save_changes").click(function(){""!=$("#qmail").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Contact page Settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebPageSettings"),$("#set_form").submit()},200)}):bootbox.alert(SCTEXT("Email cannot be empty."))}),$("#bk").click(function(){window.location=app_url+"contactWebSettings"})),"login_web_set"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Login page Settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#set_form").attr("action",app_url+"saveWebPageSettings"),$("#set_form").submit()},200)})}),$("#bk").click(function(){window.location=app_url+"loginWebSettings"})),"client_dashboard"==curpage){loadAppAlerts();let a="https://enterprise.loc/"==app_url?"http://localhost:5305/search/ministats":`${app_url.replace(/\/$/,"")}:5305/search/ministats`,t={mode:"top_sms_stats",page:"client"};$.ajax({url:a,method:"POST",dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+JSON.parse(authToken).token)},data:JSON.stringify(t),crossDomain:!0,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},success:function(a){$("#weekly_sms_ctr").html(a.statsData.total_last_seven),$("#monthly_sms_ctr").html(a.statsData.total_last_thirty),"0"==$("#account_type").val()?($("#weekly_cre_ctr").html(a.statsData.last_seven_credits),$("#monthly_cre_ctr").html(a.statsData.last_thirty_credits),$("#wk_cre_chart").sparkline(a.statsData.last_seven_credits_daily,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2}),$("#mn_cre_chart").sparkline(a.statsData.last_thirty_credits_daily,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5})):($("#weekly_cre_ctr").html(`${app_currency}${a.statsData.last_seven_cost}`),$("#monthly_cre_ctr").html(`${app_currency}${a.statsData.last_thirty_cost}`),$("#wk_cre_chart").sparkline(a.statsData.last_seven_cost_daily,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2}),$("#mn_cre_chart").sparkline(a.statsData.last_thirty_cost_daily,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5})),$("#wk_sm_chart").sparkline(a.statsData.last_seven_sms,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2}),$("#mn_sm_chart").sparkline(a.statsData.last_thirty_sms,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5})},error:function(a){console.log(a)}}),"1"!=$("#account_type").val()&&($("#clientrtdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#clientrtdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),loadDashboardStats({mode:"clientroutessms",page:"client"})}),$("#clientrtdp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),loadDashboardStats({mode:"clientroutessms",page:"client"})),$.ajax({type:"GET",url:app_url+"getRecentTransactions",success:function(a){var t=JSON.parse(a);$("#rectransbox").fadeOut(function(){$(this).html(t.str).fadeIn()})}}),$.ajax({type:"GET",url:app_url+"getRecentCampaigns",success:function(a){var t=JSON.parse(a);$("#recsmsbox").fadeOut(function(){$(this).html(t.str).fadeIn()})}})}if("manage_sender"==curpage&&$(document).on("click",".del-sid",function(){var a=$(this).attr("data-sid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this Sender ID?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteSender/"+a)}})}),"add_sender"!=curpage&&"edit_sender"!=curpage||($("#country").length>0&&$("#country").on("change",function(){let a=$("#country option:selected").val();$.ajax({type:"post",url:app_url+"getCoverageRegulations",data:{id:a},success:function(a){$("#covregbox").html(a)}})}),$("#save_changes").click(function(){""!=$("#sid").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Sender ID")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#sid_form").attr("action",app_url+"saveSender"),$("#sid_form").submit()},100)}):bootbox.alert(SCTEXT("Sender ID cannot be blank."))}),$("#bk").click(function(){window.location=app_url+"manageSenderId"})),"manage_templates"==curpage&&$(document).on("click",".del-tmp",function(){var a=$(this).attr("data-tmp");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this SMS Template?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteTemplate/"+a)}})}),"add_template"!=curpage&&"edit_template"!=curpage||($("#toggle-rt").change(function(){$("#rtbox").toggleClass("hidden")}),$("#save_changes").click(function(){""!=$("#tname").val()?""!=$("#tcont").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving SMS Template")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#tmp_form").attr("action",app_url+"saveTemplate"),$("#tmp_form").submit()},100)}):bootbox.alert(SCTEXT("Template content cannot be blank.")):bootbox.alert(SCTEXT("Template name cannot be blank."))}),$("#bk").click(function(){window.location=app_url+"manageTemplates"})),"manage_groups"==curpage&&$(document).on("click",".del-gid",function(){var a=$(this).attr("data-gid");bootbox.confirm({message:SCTEXT("All contacts from this group will be deleted. Are you sure you want to delete this contact group?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteGroup/"+a)}})}),"add_group"!=curpage&&"edit_group"!=curpage||($("#save_changes").click(function(){""!=$("#gname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving contact group")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#grp_form").attr("action",app_url+"saveGroup"),$("#grp_form").submit()},100)}):bootbox.alert(SCTEXT("Group name cannot be blank."))}),$("#bk").click(function(){window.location=app_url+"manageGroups"})),"move_contacts"==curpage&&($("#save_changes").click(function(){0!=$("#grp").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Moving contacts to selected group")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#grp_form").attr("action",app_url+"saveMoveContacts"),$("#grp_form").submit()},100)}):bootbox.alert(SCTEXT("Please select a group."))}),$("#bk").click(function(){window.location=app_url+"manageGroups"})),"manage_contacts"==curpage&&$(document).on("click",".del-cid",function(){var a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this contact?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteContact/"+a)}})}),"add_contact"!=curpage&&"edit_contact"!=curpage||($("#save_changes").click(function(){0!=$("#contactno").val()&&isValidPhone($("#contactno").val())?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Contact")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#ct_form").attr("action",app_url+"saveContacts"),$("#ct_form").submit()},100)}):bootbox.alert(SCTEXT("Invalid contact number entered. Please enter a proper mobile number."))}),$("#bk").click(function(){window.location=app_url+"viewContacts/"+$("#groupid").val()})),"import_contact"==curpage&&($("#group").on("change",function(){""!=$(this).val()?($("#colbox").html(atob($("#group option:selected").attr("data-colstr"))),$("body").tooltip({selector:'[data-toggle="tooltip"]'})):$("#colbox").html("- "+SCTEXT("Select a group to display column suggestions")+" -")}),$("#save_changes").click(function(){""!=$("#group").val()&&0!=$("#group").val()?1!=$("#uprocess").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Importing Contacts. This may take a while. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#ct_form").attr("action",app_url+"saveContacts"),$("#ct_form").submit()},50)}):bootbox.alert(SCTEXT("File upload is in progress. Kindly wait for upload to finish or Cancel Upload & proceed.")):bootbox.alert(SCTEXT("Choosing a group name is required. Add a new group if you do not have any yet."))}),$("#bk").click(function(){window.location=app_url+"manageGroups"})),"composeSMS"==curpage||"resend_campaign"==curpage||"edit_sch_campaign"==curpage){var rangeErr=0;let a={};if($(document).on("click","#toggle-vsms",function(){$(this).is(":checked")?$("#vsms_agent_sel_box").show("fade"):$("#vsms_agent_sel_box").hide("fade")}),$("#stopmsg").on("click",function(){let a=$("#routesel option:selected").attr("data-stop");""!=a?(insertAtCaret("text_sms_content",a),$("#text_sms_content").trigger("keyup")):bootbox.alert("Please manually enter the optout message.")}),$("#sbsize").on("blur keyup",function(){let a=$("#sbsize").val(),t=$("#sbduration option:selected").text(),e=$("#sbdays option:selected").attr("data-desc");$("#sbexp").text(`Send ${parseInt(a)||0} SMS every ${t} ${e} starting`)}),$("#sbduration").on("change",function(){$("#sbsize").trigger("blur")}),$("#sbdays").on("change",function(){$("#sbsize").trigger("blur")}),$("#syspb").length>0&&($("input[name='contact-type']").click(function(){"my"==$(this).val()?$("#phonebookbox").hide("fade",function(){$("#mycontactbox").show("fade")}):$("#mycontactbox").hide("fade",function(){$("#phonebookbox").show("fade")}),calcContacts()}),$(document).on("click",".pbdbsel",function(){var a=$(this).attr("data-count");"0"==a&&(a=1),$("#pbfrom").val("1"),$("#pbto").val(a),calcContacts()}),$("#pbfrom, #pbto").on("keyup blur",function(a){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),rangeErr=1,void a.preventDefault();if($(this).removeClass("error-input"),rangeErr=0,parseInt($(this).val())<1)return $(this).addClass("error-input"),rangeErr=1,void a.preventDefault();var t=parseInt($(".pbdbsel:checked").attr("data-count"));if(parseInt($(this).val())>t)return $(this).addClass("error-input"),rangeErr=1,void a.preventDefault();calcContacts()})),$("#dynsms").on("change",function(){$(this).is(":checked")?($("#xlcolbox").removeClass("hidden"),$("#dyncountnotice").removeClass("hidden"),$("#grpsel").prepend('<option id="placeholder4cgsel"></option>'),$("#grpsel").attr("multiple",!1),$("#grpsel").select2("destroy").select2({placeholder:SCTEXT("Select Group")+". . . ."}),$("#contactinput").attr("disabled","disabled")):($("#xlcolbox").addClass("hidden"),$("#dyncountnotice").addClass("hidden"),$("#placeholder4cgsel").remove(),$("#grpsel").attr("multiple",!0),$("#grpsel").select2("destroy").select2({placeholder:SCTEXT("Select Groups")+". . . ."}),$("#grpsel").select2("val"," "),$("#contactinput").removeAttr("disabled"))}),$(document).on("click",".colsbtn",function(){insertAtCaret("text_sms_content","#"+$(this).attr("data-colval")+"#"),$("#text_sms_content").trigger("keyup")}),$("input[type=radio][name=unicodetype]").change(function(){"uauto"==this.value&&$("#text_sms_content").attr("dir","ltr")}),$("#pageResp").length>0&&$("#pageResp").modal({show:!0}),$("#submitsms").click(function(){if($("#syspb").length>0&&$("#syspb").is(":checked")){var a=parseInt($("#pbfrom").val()),t=parseInt($("#pbto").val());if(a>t)return void bootbox.alert(SCTEXT('Incorrect range selected for Phonebook option. "FROM" should be a lesser value than "TO" field. Your selected range was:')+" from-"+a+" : to-"+t)}if(1!=$("#uprocess").val())if("2"!=$("#routesel option:selected").attr("data-stype")||""!=$("#senderopn").val())if("0"!=$("#routesel option:selected").attr("data-stype")||$("#sendersel").val())if("edit_sch_campaign"==curpage){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes to the campaign")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},2e3),setTimeout(function(){$("#sendsms_form").attr("action",app_url+"saveEditScheduledCampaign"),$("#sendsms_form").submit()},100)})}else{if($("#syspb").length>0&&"pb"==$("input[name='contact-type']:checked").val()){if(""==$("#pbfrom").val()||""==$("#pbto").val())return void bootbox.alert(SCTEXT("Please select a phonebook category for SMS recipient."))}else if(""==$("#contactinput").val()&&!$("#grpsel").val()&&"0"==$("#ufilecno").val())return void bootbox.alert(SCTEXT("Please enter at least one field for SMS recipient."));if(1==rangeErr)return void bootbox.alert(SCTEXT("Please enter contact range from Phonebook."));$type=$("input[name='smstype']:checked").val();let a="SMS",t=1==$("#account_type").val()?"#mccdefroute":"#routesel option:selected";"2"==$(t).attr("data-stype")&&(a=$("#senderopn").val()),"0"==$(t).attr("data-stype")&&(a=$("#sendersel option:selected").text());let e="";"text"==$type?(e='<span class="label label-primary">Text</span>',$("#unicodesms").is(":checked")&&(e='<span class="label label-primary">Unicode</span>'),$("#flashsms").is(":checked")&&(e+='<span class="m-l-xs label label-info">Flash</span>'),$("#dynsms").is(":checked")?(e+='<span class="m-l-xs label label-inverse">Personalize</span>',$.ajax({type:"post",url:app_url+"genDynamicPreview",data:{sms:$("#text_sms_content").val(),filename:$('[name="uploadedFiles[]"]').attr("id"),xlsheet:$("#xlsheet option:selected").val(),xlcol:$("#xlcol option:selected").val(),selgrp:$("#grpsel option:selected").val()},success:function(t){$("#conf_preview_open_sender").html(a),$("#conf_preview_open_msg_text").html(nl2br(t))}})):($("#conf_preview_open_sender").html(a),$("#conf_preview_open_msg_text").html(nl2br($("#text_sms_content").val())))):"wap"==$type?(e='<span class="label label-primary">WAP</span>',$("#conf_preview_open_sender").html(a),$("#conf_preview_open_msg_text").html(`[${SCTEXT("No Preview Available")}]`)):"vcard"==$type&&(e='<span class="label label-primary">vCard</span>',$("#conf_preview_open_sender").html(a),$("#conf_preview_open_msg_text").html(`[${SCTEXT("No Preview Available")}]`));let s=1==$("#account_type").val()?"Smart Routing":$(t).text(),o=$("#conf_total_contacts").text(),r=$("#conf_total_cost").text()+(0==$("#account_type").val()?" credits":""),n="1";0==$("#account_type").val()&&(n=$("#txtcount").val()+" credits"),1==$("#account_type").val()&&(n=app_currency+parseFloat(parseFloat($("#conf_total_cost").text().replace(app_currency,"").trim().split(",").join(""))/parseInt($("#conf_total_cost").text().split(",").join("")))),2==$("#account_type").val()&&(n=app_currency+parseFloat($("#routesel option:selected").attr("data-rate"))*parseInt($("#txtcount").val()));let l="Sending Now";$("#slater").is(":checked")&&(l='Send on: <span class="code"> '+$("#schdp").val()+"</span>"),$("#sbatch").is(":checked")&&(l=$("#lcnow").is(":checked")?$("#sbexp").text()+" now.":$("#sbexp").text()+' on <span class="code"> '+$("#lcdp").val()+"</span>"),$("#conf_total_contacts_modal").html(o),$("#conf_per_sms_price").html(n),$("#conf_total_cost_modal").html(r),$("#conf_sel_route").html(s),$("#conf_sel_sid").html(a),$("#conf_sms_type").html(e),$("#conf_sch_info").html(l),$("#conf_modal").modal({show:!0})}else bootbox.alert(SCTEXT("Please select an approved sender ID."));else bootbox.alert(SCTEXT("Sender ID cannot be blank."));else bootbox.alert(SCTEXT("File upload is in progress. Kindly wait for upload to finish or Cancel Upload & proceed."))}),$("body").on("click","#conf_proceed",function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Processing SMS . . .<br>This may take few minutes for personalized SMS or large campaign.")}</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},2e3),setTimeout(function(){$("#sendsms_form").attr("action",app_url+"processCampaign"),$("#sendsms_form").submit()},100)})}),$("body").on("change","#xlcol",function(){$sheet=$("#xlsheet option:selected").val();var a=$("input.uploadedFile").val(),t=$(this).val();$.ajax({type:"post",dataType:"json",url:app_url+"getSheetnColumns",data:{file:a,mode:"colcount",sheet:$sheet,col:t},success:function(a){var t=a;$("#ufilecno").val(parseInt(t.totalrows)),calcContacts()}})}),$("body").on("change","#xlsheet",function(){$sheet=$(this).val();var a=$("input.uploadedFile").val();$("#xlcol").attr("disabled","disabled"),$.ajax({type:"post",dataType:"json",url:app_url+"getSheetnColumns",data:{file:a,mode:"columns",sheet:$sheet},success:function(a){var t=a;for(var e in $cols=t.cols,$cols_str="",$cols_btns="",$cols)null!=$cols[e]&&""!=$cols[e]&&($cols_str+='<option value="'+e+'">'+$cols[e]+"</option>",$cols_btns+='<button data-colval="'+e+'" type="button" class="colsbtn btn btn-sm btn-default">'+$cols[e]+"</button>");$("#xlcol").html($cols_str).attr("disabled",!1),$("#ufilecno").val(parseInt(t.totalrows)),$("#xlcolbtns").html($cols_btns),calcContacts()}})}),$("#smsprev").click(function(){let a=1==$("#account_type").val()?"#mccdefroute":"#routesel option:selected";$type=$("input[name='smstype']:checked").val();let t="SMS";"2"==$(a).attr("data-stype")&&(t=$("#senderopn").val()),"0"==$(a).attr("data-stype")&&(t=$("#sendersel option:selected").text()),"text"==$type?$("#dynsms").is(":checked")?$.ajax({type:"post",url:app_url+"genDynamicPreview",data:{sms:$("#text_sms_content").val(),filename:$('[name="uploadedFiles[]"]').attr("id"),xlsheet:$("#xlsheet option:selected").val(),xlcol:$("#xlcol option:selected").val(),selgrp:$("#grpsel option:selected").val()},success:function(a){$("#preview_locked_notif_sender").html(t),$("#preview_open_sender").html(t),$("#preview_locked_notif_text").html(nl2br(a)),$("#preview_open_msg_text").html(nl2br(a))}}):($("#preview_locked_notif_sender").html(t),$("#preview_open_sender").html(t),$("#preview_locked_notif_text").html(nl2br($("#text_sms_content").val())),$("#preview_open_msg_text").html(nl2br($("#text_sms_content").val()))):"wap"==$type?($("#preview_locked_notif_sender").html(t),$("#preview_open_sender").html(t),$("#preview_locked_notif_text").html(`[${SCTEXT("No Preview Available")}]`),$("#preview_open_msg_text").html(`[${SCTEXT("No Preview Available")}]`)):"vcard"==$type&&($("#preview_locked_notif_sender").html(t),$("#preview_open_sender").html(t),$("#preview_locked_notif_text").html(`[${SCTEXT("No Preview Available")}]`),$("#preview_open_msg_text").html(`[${SCTEXT("No Preview Available")}]`)),$("#smspreview").modal({show:!0})}),$(document).on("click",".useTempBtn",function(){var a=$(this).attr("data-template");$("#text_sms_content").val(a).trigger("keyup")}),$(document).on("click",".useTurlBtn",function(){insertAtCaret("text_sms_content","http://"+$(this).attr("data-turl")),$("#text_sms_content").trigger("keyup"),"1"==$(this).attr("data-track")&&bootbox.alert(SCTEXT("Please make sure <b>Personalized</b> box is checked. Click Tracking is available only for Personalized SMS."))}),$(document).on("click",".useMediaBtn",function(){insertAtCaret("text_sms_content","http://"+$(this).attr("data-turl")),$("#text_sms_content").trigger("keyup"),bootbox.alert(SCTEXT("To enable CLICK tracking Please make sure <b>Personalized</b> box is checked. Click Tracking is available only for Personalized SMS."))}),$(document).on("keyup blur","#text_sms_content",function(){var t=$(this).val(),e=t.length,s=Object.keys(a.special),o=0,r=0;for(let e=1;e<=s.length;e++)if(parseInt(s[e])>1)for(let n of a.special[s[e]]){"clb"==n&&(n="]"),"ln"==n&&(n="\n");let a=t.split(n).length-1;o+=a,r+=a*parseInt(s[e])}var n=e-o+r,l=1;if(containsUnicode(t)){$("#unicodeFlag").val("1");for(var i=1;i<=5;i++)if(n>=a.unicode[i].from&&n<=a.unicode[i].to){l=i;break}if(n>a.unicode[5].to){var c=Math.ceil(a.unicode[5].to/5);l=Math.ceil(n/c)}}else{$("#unicodeFlag").val("0");for(i=1;i<=5;i++)if(n>=a.normal[i].from&&n<=a.normal[i].to){l=i;break}if(n>a.normal[5].to){c=Math.ceil(a.normal[5].to/5);l=Math.ceil(n/c)}}$("#txtleft").val(n),$("#txtcount").val(l),calcContacts()}),google.setOnLoadCallback(onLoad),$("input[name='smstype']").click(function(){var a=$(this);"text"==a.val()?$("#stype-subopts").show("slide",{direction:"left"},400,function(){$("#sms_content_box").removeClass("hidden"),$("#wap_content_box").addClass("hidden"),$("#vcard_content_box").addClass("hidden")}):$("#stype-subopts").hide("slide",{direction:"left"},400,function(){"wap"==a.val()?($("#sms_content_box").addClass("hidden"),$("#wap_content_box").removeClass("hidden"),$("#vcard_content_box").addClass("hidden")):"vcard"==a.val()&&($("#sms_content_box").addClass("hidden"),$("#wap_content_box").addClass("hidden"),$("#vcard_content_box").removeClass("hidden"))}),calcContacts()}),$("#contactinput").on("blur",function(){calcContacts()}),$("#grpsel").on("change",function(){if($("#dynsms").is(":checked")){var a=$("#grpsel option:selected").attr("data-colstr");$("#xlcolbtns").html(atob(a))}$("#contact_label").val($("#grpsel option:selected").attr("data-name")),calcContacts()}),$("#routesel").on("change",function(){var t=$("#routesel option:selected");if("0"==$("#account_type").val())$("#rtavcr").html(formatInt(parseInt(t.attr("data-acr"))));else{let a=parseFloat(t.attr("data-rate")),e=$("#user_wbal").val()/a;$("#activerate").val(a),$("#rtavcr").html(`${formatInt(parseInt(e))} <small class="text-danger">(${app_currency}${a}/sms)<small>`),calcContacts()}var e=JSON.parse(t.attr("data-actspan"));if("0"==e.type){var s=`<span class="label label-success"><i class="fa fa-lg fa-check-circle"></i> &nbsp; ${SCTEXT("active")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS 24x7. SMS submission is allowed.")}</span>"></i>`;$("#rtstatus").html(s),$("#rtstatusexp").popover({html:!0,placement:"top"}),$("#schdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",format:"YYYY-MM-DD HH:mm"}),$("#lcdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom"}),$("#timezone option").each(function(){$(this).val()==e.timezone&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2")}else{var o=moment().tz(e.timezone),r=moment(e.from,"H:mm").tz(e.timezone),n=moment(e.to,"H:mm").tz(e.timezone);if(o.isBetween(r,n))s=`<span class="label label-success"><i class="fa fa-lg fa-check-circle"></i> &nbsp; ${SCTEXT("active")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS between")} ${e.from} & ${e.to} Hrs (${e.timezone} time). ${SCTEXT("SMS submission is allowed.")}</span>"></i>`;else s=`<span class="label label-danger"><i class="fa fa-lg fa-times-circle"></i> &nbsp; ${SCTEXT("inactive")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS between")} ${e.from} & ${e.to} Hrs (${e.timezone} time). ${SCTEXT("SMS submission is currently not allowed.")}</span>"></i>`;$("#rtstatus").html(s),$("#rtstatusexp").popover({html:!0,placement:"top"});for(var l=[],i=parseInt(e.from);i<parseInt(e.to);i++)l.push(i);$("#schdp").data("DateTimePicker")&&$("#schdp").data("DateTimePicker").destroy(),$("#schdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",enabledHours:l,format:"YYYY-MM-DD HH:mm"}),$("#lcdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",enabledHours:l}),$("#timezone option").each(function(){$(this).val()==e.timezone&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2")}var c=parseInt(t.attr("data-stype"));0==c&&($("#sidselbox").removeClass("hidden"),$("#sidopnbox").addClass("hidden")),1==c&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").addClass("hidden")),2==c&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").removeClass("hidden")),$.ajax({url:`${app_url}getCreditCountRuleDetails/${t.attr("data-crule")}`,success:function(t){var e=JSON.parse(t);a={normal:e.text,unicode:e.unicode,special:e.special},$("#ccruledata").attr("data-content",e.html).popover({animation:!1,placement:"left",html:!0,trigger:"hover"})}}),""!==t.attr("data-tlvs")?$.ajax({url:`${app_url}getUserTlvList/${t.val()}`,success:function(a){let t=JSON.parse(a),e=Object.keys(t);if(e.length>0){let a="";for(const s of e){let e=t[s];a+=`<div class="form-group tlv_boxes"> <label class="control-label col-md-3">${s}:</label><div class="col-md-8"><select class="tlv_controls form-control" data-plugin="select2" name="tlv[]">`;for(const t of e)a+=`<option value="${s}||${t.value}">${t.title}</option>`;a+="</select> </div></div>"}$(".tlv_boxes").remove(),$("#contactMainContainer").before(a),$(".tlv_controls").select2()}}}):$(".tlv_boxes").remove()}),"0"==$("#account_type").val()||"2"==$("#account_type").val())$("#campsel").on("change",function(){var a=$("#campsel option:selected");$("#campaignid").val(a.val());var t=a.attr("data-defroute");0!=t&&""!=t?$("#routesel").val(t).change():$("#routesel").trigger("change")}),$("#campsel").trigger("change");else{$("#campsel").on("change",function(){var a=$("#campsel option:selected");$("#campaignid").val(a.val())}),$("#campsel").trigger("change");var rtele=$("#mccdefroute"),actdata=JSON.parse(rtele.attr("data-actspan"));if("0"==actdata.type){var statushtml=`<span class="label label-success"><i class="fa fa-lg fa-check-circle"></i> &nbsp; ${SCTEXT("active")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS 24x7. SMS submission is allowed.")}</span>"></i>`;$("#rtstatus").html(statushtml),$("#rtstatusexp").popover({html:!0,placement:"top"}),$("#schdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",format:"YYYY-MM-DD HH:mm"}),$("#lcdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom"}),$("#timezone option").each(function(){$(this).val()==actdata.timezone&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2")}else{var nowhr=moment().tz(actdata.timezone),actfhr=moment(actdata.from,"H:mm").tz(actdata.timezone),actthr=moment(actdata.to,"H:mm").tz(actdata.timezone);if(nowhr.isBetween(actfhr,actthr))var statushtml=`<span class="label label-success"><i class="fa fa-lg fa-check-circle"></i> &nbsp; ${SCTEXT("active")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS between")} ${actdata.from} & ${actdata.to} Hrs (${actdata.timezone} time). ${SCTEXT("SMS submission is allowed.")}</span>"></i>`;else var statushtml=`<span class="label label-danger"><i class="fa fa-lg fa-times-circle"></i> &nbsp; ${SCTEXT("inactive")}</span><i id="rtstatusexp" class="m-l-xs fa fa-lg fa-info-circle" data-trigger="hover" data-content="<span class='text-dark'>${SCTEXT("This Route accepts SMS between")} ${actdata.from} & ${actdata.to} Hrs (${actdata.timezone} time). ${SCTEXT("SMS submission is currently not allowed.")}</span>"></i>`;$("#rtstatus").html(statushtml),$("#rtstatusexp").popover({html:!0,placement:"top"});for(var list=[],i=parseInt(actdata.from);i<parseInt(actdata.to);i++)list.push(i);$("#schdp").data("DateTimePicker")&&$("#schdp").data("DateTimePicker").destroy(),$("#schdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",enabledHours:list,format:"YYYY-MM-DD HH:mm"}),$("#lcdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"dpclose m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",enabledHours:list}),$("#timezone option").each(function(){$(this).val()==actdata.timezone&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2")}var stype=parseInt(rtele.attr("data-stype"));0==stype&&($("#sidselbox").removeClass("hidden"),$("#sidopnbox").addClass("hidden")),1==stype&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").addClass("hidden")),2==stype&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").removeClass("hidden")),$.ajax({url:app_url+"getCreditCountRuleDetails/"+rtele.attr("data-crule"),success:function(t){var e=JSON.parse(t);a={normal:e.text,unicode:e.unicode,special:e.special},$("#ccruledata").attr("data-content",e.html).popover({animation:!1,placement:"left",html:!0,trigger:"hover"})}})}if($("#schdp").on("dp.show",function(a){$(".dpclose").html("<i class='fa fa-lg fa-check'></i>&nbsp;&nbsp;Done")}),$("#lcdp").on("dp.show",function(a){$(".dpclose").html("<i class='fa fa-lg fa-check'></i>&nbsp;&nbsp;Done")}),$("#slater, #snow, #sbatch").on("click",function(){"1"==$(this).val()&&$("#sbbox").hide("slide",{direction:"left"},600,()=>{$("#schbox").show("slide",{direction:"left"},600)}),"2"==$(this).val()&&$("#schbox").hide("slide",{direction:"left"},600,()=>{$("#sbbox").show("slide",{direction:"left"},600)}),"0"==$(this).val()&&$("#schbox").hide("slide",{direction:"left"},600,()=>{$("#sbbox").hide("slide",{direction:"left"},600)})}),"resend_campaign"==curpage){var ele=$("input[name='smstype']:checked");"text"==ele.val()?$("#stype-subopts").show("slide",{direction:"left"},400,function(){$("#sms_content_box").removeClass("hidden"),$("#wap_content_box").addClass("hidden"),$("#vcard_content_box").addClass("hidden")}):$("#stype-subopts").hide("slide",{direction:"left"},400,function(){"wap"==ele.val()?($("#sms_content_box").addClass("hidden"),$("#wap_content_box").removeClass("hidden"),$("#vcard_content_box").addClass("hidden")):"vcard"==ele.val()&&($("#sms_content_box").addClass("hidden"),$("#wap_content_box").addClass("hidden"),$("#vcard_content_box").removeClass("hidden"))}),$(document).ajaxStop(function(){$("#text_sms_content").trigger("keyup")})}"edit_sch_campaign"==curpage&&$(document).ajaxStop(function(){$("#text_sms_content").trigger("keyup"),$("#schdp").val($("#orgschdate").val()),$("#timezone option").each(function(){$(this).val()==$("#orgschtz").val()&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2")})}if("transactions"!=curpage&&"va_tran_history"!=curpage||($("#transdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#transdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#dt_utrans").dataTable().api().ajax.url(app_url+"getMyTransactions/"+$("#transdp span").html()+"/"+$("#userid").val()).load()}),$("#transdp span").html("Select Date")),"dlr"!=curpage&&"va_sentsms"!=curpage||($("#campsel").on("change",function(){$("#t-dlrsum").dataTable().api().ajax.url(app_url+"getMySmsCampaigns/"+$("#campsel").val()+"/"+$("#dlrdp span").html()+"/"+$("#userid").val()+"/"+$("#sorttype").val()).load()}),$("#sorttype").on("change",function(){$("#t-dlrsum").dataTable().api().ajax.url(app_url+"getMySmsCampaigns/"+$("#campsel").val()+"/"+$("#dlrdp span").html()+"/"+$("#userid").val()+"/"+$("#sorttype").val()).load()}),$("#dlrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#dlrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy"));var e=$("#campsel").val()||0;$("#t-dlrsum").dataTable().api().ajax.url(app_url+"getMySmsCampaigns/"+e+"/"+$("#dlrdp span").html()+"/"+$("#userid").val()+"/"+$("#sorttype").val()).load()}),$("#dlrdp span").html("Select Date"),$("body").on("click",".dlrsumldr",function(){var a=$(this),t=a.next().find(".popover-content"),e=a.next().find(".arrow");$.ajax({url:app_url+"getDlrSummary/"+$("#userid").val(),data:{shootid:a.attr("data-shootid"),routeid:a.attr("data-routeid"),mode:"popover"},success:function(a){e.css("top","20px"),t.html(a)}})}),$("body").on("click",".closePO",function(){$(".dlrsumldr").popover("hide")})),"dlr_details"!=curpage&&"va_dlrdetails"!=curpage||($("#adminsummary").length>0&&$("#adminsummary").on("click",function(){$("#adminsumctr").html(`<i class="fa-circle-o-notch fa fa-lg m-r-xs fa-spin"></i> <b>${SCTEXT("Loading")}...</b>`),$.ajax({url:app_url+"getAdminSmsSummary/"+$("#shootid").val(),success:function(a){$("#adminsumctr").html(a)}})}),$.ajax({url:app_url+"getDlrSummary/"+$("#userid").val(),data:{shootid:$("#shootid").val(),routeid:$("#routeid").val()},success:function(a){$("#dlrsumctr").html(a)}})),"docs"==curpage&&($("#app-main").on("click",".deleteDoc",function(){var a=$(this);bootbox.confirm({message:SCTEXT("Are you sure you want to delete this file? All comments/remarks will be deleted and no user will be able to access this file. Proceed anyway?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"deleteDocument/"+a.attr("data-docid"),success:function(a){window.location=app_url+"manageDocs"}})}})}),$("#docmgrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#docmgrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getUserDocs/1/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#inv-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docinv").removeClass("hidden").attr("data-custom","10,10").html(SCTEXT("Show More")+" ..."):$("#more_docinv").addClass("hidden"),$("#inv-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})})}}),$.ajax({type:"GET",url:app_url+"getUserDocs/2/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#apl-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docapl").removeClass("hidden").attr("data-custom","10,10").html(SCTEXT("Show More")+" ..."):$("#more_docapl").addClass("hidden")}),$("#apl-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})}}),$.ajax({type:"GET",url:app_url+"getUserDocs/3/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#oth-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docoth").removeClass("hidden").attr("data-custom","10,10").html(SCTEXT("Show More ")+"..."):$("#more_docoth").addClass("hidden")}),$("#oth-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})}})}),$("#docmgrdp span").html("Select Date"),$.ajax({type:"GET",url:app_url+"getUserDocs/1/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#inv-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docinv").removeClass("hidden").attr("data-custom","10,10"):$("#more_docinv").addClass("hidden")}),$("#inv-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})}}),$("#more_docinv").on("click",function(){$limit=$(this).attr("data-custom"),"0,10"!=$limit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getUserDocs/1/"+$("#docmgrdp span").html()+"/"+$limit,success:function(a){var t=JSON.parse(a);1==t.more?($("#inv-file-ctr").append(t.str),$("html, body").animate({scrollTop:$("#inv-file-ctr").height()},500,function(){$("#more_docinv").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit}),$("#inv-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})):$("#more_docinv").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),$.ajax({type:"GET",url:app_url+"getUserDocs/2/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#apl-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docapl").removeClass("hidden").attr("data-custom","10,10"):$("#more_docapl").addClass("hidden")}),$("#apl-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})}}),$("#more_docapl").on("click",function(){$limit=$(this).attr("data-custom"),"0,10"!=$limit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getUserDocs/2/"+$("#docmgrdp span").html()+"/"+$limit,success:function(a){var t=JSON.parse(a);1==t.more?($("#apl-file-ctr").append(t.str),$("html, body").animate({scrollTop:$("#apl-file-ctr").height()},500,function(){$("#more_docapl").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit}),$("#apl-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})):$("#more_docapl").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),$.ajax({type:"GET",url:app_url+"getUserDocs/3/"+$("#docmgrdp span").html(),success:function(a){var t=JSON.parse(a);$("#oth-file-ctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&10==t.rows?$("#more_docoth").removeClass("hidden").attr("data-custom","10,10"):$("#more_docoth").addClass("hidden")}),$("#oth-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})}}),$("#more_docoth").on("click",function(){$limit=$(this).attr("data-custom"),"0,10"!=$limit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getUserDocs/3/"+$("#docmgrdp span").html()+"/"+$limit,success:function(a){var t=JSON.parse(a);1==t.more?($("#oth-file-ctr").append(t.str),$("html, body").animate({scrollTop:$("#oth-file-ctr").height()},500,function(){$("#more_docoth").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit}),$("#oth-file-ctr").find(".pop-over").each(function(){$(this).popover({html:!0})})})):$("#more_docoth").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),$(".docnav").on("click",function(){var a=$(this);""==$(this).parent().attr("class")&&($(".docnav").each(function(){$(this).find("i").attr("class","fa fa-lg fa-folder m-r-xs")}),a.find("i").attr("class","fa fa-lg fa-folder-open m-r-xs"))})),"add_doc"==curpage&&($("#save_changes").click(function(){""!=$("#docname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Uploading Document")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},200),setTimeout(function(){$("#udoc_form").attr("action",app_url+"saveDocument"),$("#udoc_form").submit()},100)}):bootbox.alert(SCTEXT("Please enter a title for the document"))}),$("#bk").click(function(){window.location=app_url+"manageDocs"})),"view_doc"==curpage&&($(".agraction").on("click",function(){var a=$(this),t="1"==a.attr("data-action")?SCTEXT("Are you sure you want to approve this agreement?"):SCTEXT("Are you sure you want to decline this agreement?");bootbox.confirm({message:t,buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({type:"post",url:app_url+"markAgreementStatus",data:{action:a.attr("data-action"),docid:a.attr("data-docid")},success:function(a){window.location.reload(!1)}})}})}),$(".invaction").on("click",function(){var a=$(this),t="1"==a.attr("data-action")?SCTEXT("Please make sure you have received the payment and enter transaction details as a comment below. Are you sure you want to mark this invoice as PAID?"):SCTEXT("Are you sure you want to cancel this invoice?");bootbox.confirm({message:t,buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({type:"post",url:app_url+"markInvoiceStatus",data:{action:a.attr("data-action"),docid:a.attr("data-docid")},success:function(a){window.location.reload(!1)}})}})}),$("#docinvprint").on("click",function(){$("#invoiceBox").printThis()}),$("#docremk").animate({scrollTop:$("#docremk").prop("scrollHeight")},500),$("#submitCmt").click(function(){""!=$("#doc_comment").val()?($(this).attr("disabled","disabled").html(SCTEXT("Submitting")+" ..."),$("#cmt_form").attr("action",app_url+"postFileComment"),$("#cmt_form").submit()):bootbox.alert(SCTEXT("Your comment cannot be blank"))}),$("#sharedoc").length>0&&($("#sharedoc").on("click",function(){$("#shareusrbox").modal({show:!0})}),$("#submitShare").on("click",function(){""!=$("#sharedusr").val()?($(this).attr("disabled","disabled").html(SCTEXT("Submitting")+" ..."),$("#shareform").attr("action",app_url+"postSharedUsers"),$("#shareform").submit()):bootbox.alert(SCTEXT("Please select at least one user"))})),$(".remshare").on("click",function(){var a=$(this);bootbox.confirm({message:SCTEXT("Are you sure you want to remove this user from shared list?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"rmvSharedUsr",method:"post",data:{uid:a.attr("data-uid"),docid:a.attr("data-docid")},success:function(t){window.location=app_url+"viewDocument/"+a.attr("data-docid")}})}})}),$("#docreupload").on("click",function(){$("#reupbox").modal({show:!0})}),$("#submitReup").on("click",function(){0!=$(".uploadedFile").length?($(this).attr("disabled","disabled").html(SCTEXT("Submitting")+" ..."),$("#reuploadform").attr("action",app_url+"documentReupload"),$("#reuploadform").submit()):bootbox.alert(SCTEXT("Please upload a file."))}),$(".deleteDoc").on("click",function(){var a=$(this);bootbox.confirm({message:SCTEXT("Are you sure you want to delete this file? All comments/remarks will be deleted and no user will be able to access this file. Proceed anyway?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"deleteDocument/"+a.attr("data-docid"),success:function(a){window.location=app_url+"manageDocs"}})}})}),$("#docinvpay").length>0&&$("#docinvpay").on("click",function(){var a=$(this).attr("data-docid");bootbox.dialog({message:$("#paymentopts").html(),buttons:{cancel:{label:SCTEXT("Pay Later")},ok:{label:SCTEXT("Confirm Order"),className:"btn-primary",callback:function(){var t=1==$(".modal-body").find("#wbalflag").is(":checked")?1:0;$.ajax({url:app_url+"encryptData",data:{mode:"payment",invoiceid:a,walletflag:t,returntoinvoice:1},success:function(a){window.location=app_url+"confirmPurchaseOrder/"+a}})}}}}).modal("show")}),$(document).on("change","#wbalflag",function(){var a=$(this).is(":checked")?1:0;$(this).applyWbal(a)}),$.fn.applyWbal=function(a){var t=$("#gtotal").val(),e=0;if(1==a){var s=t<=parseFloat($("#walbal").val())?0:t-parseFloat($("#walbal").val());$(".modal-body").find("#total_amt_payable").html(s.toLocaleString()),e=t>=parseFloat($("#walbal").val())?0:($("#walbal").val()-t).toLocaleString(),$(".modal-body").find("#remwal").text(app_currency+e)}else{s=t;$(".modal-body").find("#total_amt_payable").html(s.toLocaleString()),e=$("#walbal").val().toLocaleString(),$(".modal-body").find("#remwal").text(app_currency+e)}}),"support_tickets"==curpage&&($("#tktdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#tktdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#dt_e").dataTable().api().ajax.url(app_url+"getMyTickets/"+$("#tktdp span").html()).load()}),$("#tktdp span").html("Select Date")),"add_ticket"==curpage&&($("#save_changes").click(function(){""!=$("#tkttitle").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Submitting ticket to Support team")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#st_form").attr("action",app_url+"saveSupportTicket"),$("#st_form").submit()},100)}):bootbox.alert(SCTEXT("Please enter the subject/title for the ticket."))}),$("#bk").click(function(){window.location=app_url+"supportTickets"})),"view_ticket"==curpage&&($("#docremk").animate({scrollTop:$("#docremk").prop("scrollHeight")},500),$("#submitCmt").click(function(){""!=$("#t_comment").val()?($(this).attr("disabled","disabled").html(SCTEXT("Submitting")+" ..."),$("#cmt_form").attr("action",app_url+"postTicketComment"),$("#cmt_form").submit()):bootbox.alert(SCTEXT("Your comment cannot be blank"))})),"refund_log"==curpage&&($("#rldp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#rldp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-reflog").dataTable().api().ajax.url(app_url+"getRefundLog/"+$("#rldp span").html()).load()}),$("#rldp span").html("Select Date")),"credit_log"!=curpage&&"va_crelog"!=curpage||($("#cldp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#cldp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-crelog").dataTable().api().ajax.url(app_url+"getCreditLog/"+$("#cldp span").html()+"/"+$("#userid").val()).load()}),$("#cldp span").html("Select Date")),"usms_log"==curpage){let a=moment().subtract(29,"days"),t=moment();$("#datetime").daterangepicker({timePicker:!0,timePicker24Hour:!1,timePickerSeconds:!0,autoUpdateInput:!1,startDate:moment().startOf("hour"),endDate:moment().startOf("hour").add(32,"hour"),locale:{cancelLabel:"Clear"}}),$("#datetime").on("apply.daterangepicker",function(a,t){$(this).val(t.startDate.format("YYYY-MM-DD HH:mm:ss")+" - "+t.endDate.format("YYYY-MM-DD HH:mm:ss"))}),$(".search_option_selector").on("click",function(){let a=$(this).attr("data-myvalue"),t=$(this).attr("data-inputid"),e=$(this).text();$(`#${t}`).val()!=a&&(e.length>10&&(e=e.replace(/(.{10})..+/,"$1…")),$(`#${t}_dropdown`).find(".search_option_selector").removeClass("chosen"),$(this).addClass("chosen"),$(`#${t}`).val(a),$(`#${t}_selection`).html(`${e} <i class="m-l-sm fas fa-caret-down fa-lg"></i>`))}),$(".search_option_input").on("click",function(){let a=$(this).attr("data-inputid"),t=$(`#${a}`).val();""==t?t="Any":(t.length>10&&(t=t.replace(/(.{10})..+/,"$1…")),$(`#${a}_dropdown`).find(".search_option_selector").removeClass("chosen")),$(`#${a}_selection`).html(`${t} <i class="m-l-sm fas fa-caret-down fa-lg"></i>`)}),getSearchResult(),$("#filter_search").on("click",function(){getSearchResult()}),$("#export_search").on("click",function(){getSearchDownload()})}if("hapi"!=curpage&&"xapi"!=curpage||$("body").on("click",".btn",function(){bootbox.confirm({message:SCTEXT("Are you sure you want to regenerate API Key? Old implementations of the API would not work unless you update newly generated API Key in those. Shall we proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&(window.location=app_url+"regAPIKey")}})}),"stats"==curpage){let a=1283e3;$("#datetime").daterangepicker({timePicker:!0,timePicker24Hour:!1,timePickerSeconds:!0,autoUpdateInput:!1,startDate:moment().startOf("hour"),endDate:moment().startOf("hour").add(32,"hour"),locale:{cancelLabel:"Clear"},ranges:{Today:[moment().startOf("day"),moment().endOf("day")],Yesterday:[moment().subtract(1,"days").startOf("day"),moment().subtract(1,"days").endOf("day")],"Last 7 Days":[moment().subtract(6,"days").startOf("day"),moment().endOf("day")],"Last 30 Days":[moment().subtract(29,"days").startOf("day"),moment().endOf("day")],"This Month":[moment().startOf("month").startOf("day"),moment().endOf("month").endOf("day")],"Last Month":[moment().subtract(1,"month").startOf("month").startOf("day"),moment().subtract(1,"month").endOf("month").endOf("day")]},opens:"left",showCustomRangeLabel:!0}),$("#datetime").on("apply.daterangepicker",function(a,t){$(this).val(t.startDate.format("YYYY-MM-DD HH:mm:ss")+" - "+t.endDate.format("YYYY-MM-DD HH:mm:ss"))}),$("#datetime").on("cancel.daterangepicker",function(a,t){$("#datetime").val("")}),showSmsStats(),$("#apply_filter").on("click",function(){showSmsStats()})}if("smsarchive"==curpage&&($("#sldp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"right",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#sldp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#chosenDate").val($("#sldp span").html())}),$("#sldp span").html("Select Date"),$("body").on("click","#submit_archdt",function(){"Select Date"==$("#chosenDate").val()&&(bootbox.alert(SCTEXT("Please select a valid date to proceed.")),exit),bootbox.confirm({message:SCTEXT("System will now fetch records from selected date range. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&($("#ftadd_frm").attr("action",app_url+"saveArchiveFetchTask"),$("#ftadd_frm").submit())}})})),"scheduled"==curpage&&($("body").on("click",".delsch",function(){var a=$(this).attr("data-shootid");bootbox.confirm({message:SCTEXT("This action will cancel your campaign. The credits deducted will be refunded back to your account. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"cancelSchedule/"+a)}})}),$("#dlrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#dlrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-schtbl").dataTable().api().ajax.url(app_url+"getMyScheduledCampaigns/"+$("#dlrdp span").html()).load()}),$("#dlrdp span").html("Select Date")),"reseller_dashboard"==curpage&&($.ajax({url:app_url+"getResellerStats",success:function(a){var t=JSON.parse(a);$("#weekly_sales_ctr").html(formatInt(t.s_total_week)),$("#monthly_sales_ctr").html(formatInt(t.s_total_month)),$("#weekly_usr_ctr").html(t.u_total_week),$("#monthly_usr_ctr").html(t.u_total_month);var e=[];for(elem in t.s_this_week)e.push(t.s_this_week[elem]);var s=[];for(u_elem in t.u_this_week)s.push(t.u_this_week[u_elem]);$("#wk_sales_chart").sparkline(e,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2}),$("#wk_usr_chart").sparkline(s,{type:"bar",barColor:"#ffffff",barWidth:3,barSpacing:2});var o=[];for(elem2 in t.s_this_month)o.push(t.s_this_month[elem2]);var r=[];for(u_elem2 in t.u_this_month)r.push(t.u_this_month[u_elem2]);$("#mn_sales_chart").sparkline(o,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5}),$("#mn_usr_chart").sparkline(r,{type:"bar",barColor:"#ffffff",barWidth:2,barSpacing:1.5});var n=echarts.init(document.getElementById("salesgr")),l={tooltip:{trigger:"axis"},color:["#35b8e0","#f9c851"],legend:{data:["Sales","New Users"]},calculable:!0,xAxis:[{type:"category",data:t.line_r.dates}],yAxis:[{type:"value"}],series:[{name:"Sales",type:"line",data:t.line_r.sales,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Average"}]}},{name:"New Users",type:"line",data:t.line_r.signups,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Average"}]}}]};n.setOption(l)}}),$("#salesgrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#salesgrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$.ajax({url:app_url+"getResellerSales/"+$("#salesgrdp span").html(),success:function(a){var t=JSON.parse(a),e=echarts.init(document.getElementById("salesgr")),s={tooltip:{trigger:"axis"},color:["#35b8e0","#f9c851"],legend:{data:["Sales","New Users"]},calculable:!0,xAxis:[{type:"category",data:t.line_r.dates}],yAxis:[{type:"value"}],series:[{name:"Sales",type:"line",data:t.line_r.sales,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Average"}]}},{name:"New Users",type:"line",data:t.line_r.signups,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Average"}]}}]};e.setOption(s)}})}),$("#topcldp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"right",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#topcldp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),loadDashboardStats({mode:"topclients",page:"reseller"})}),$("#topcldp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),loadDashboardStats({mode:"topclients",page:"reseller"}),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html(),success:function(a){var t=JSON.parse(a);$("#topsalesctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_sales").removeClass("hidden").attr("data-custom","4,4"):$("#more_sales").addClass("hidden")})})}}),$("#more_sales").on("click",function(){$limit=$(this).attr("data-custom"),"0,4"!=$limit&&($(this).attr("disabled","disabled").html(SCTEXT("loading")+"...."),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html()+"/"+$limit,success:function(a){var t=JSON.parse(a);1==t.more?($("#topsalesctr").append(t.str),$("#topsalesctr").animate({scrollTop:$("#topsalesctr").prop("scrollHeight")},500,function(){$("#more_sales").html(SCTEXT("Show More")+" ...").attr({disabled:!1,"data-custom":t.limit})})):$("#more_sales").html(SCTEXT("All loaded")).attr({disabled:!1,"data-custom":t.limit})}}))}),$("#topsalesdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"right",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#topsalesdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getLatestOrders/"+$("#topsalesdp span").html(),success:function(a){var t=JSON.parse(a);$("#topsalesctr").fadeOut(function(){$(this).html(t.str).fadeIn(function(){1==t.more&&4==t.rows?$("#more_sales").removeClass("hidden").attr("data-custom","4,4").html(SCTEXT("Show More")+" ..."):$("#more_sales").addClass("hidden")})})}})}),$("#topsalesdp span").html(Date.today().add({days:-6}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$.ajax({type:"GET",url:app_url+"getRecentTransactions",success:function(a){var t=JSON.parse(a);$("#rectransbox").fadeOut(function(){$(this).html(t.str).fadeIn()})}}),$.ajax({type:"GET",url:app_url+"getRecentCampaigns",success:function(a){var t=JSON.parse(a);$("#recsmsbox").fadeOut(function(){$(this).html(t.str).fadeIn()})}})),"view_account"==curpage&&($("#u_acc_mgr").length>0&&$("#u_acc_mgr").on("change",function(){var a=$("#u_acc_mgr option:selected").val();bootbox.confirm({message:SCTEXT("Are you sure you want to change the account manager for this user?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:"Yes, Proceed",className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"switchStaff",type:"post",data:{user:$("#userid").val(),staff:a},success:function(a){window.location.reload()}})}})}),$("#uactl-dp").length>0&&$("#uactl-dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#uactl-dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-uactlog").dataTable().api().ajax.url(app_url+"getUserActivity/"+$("#uactl-dp span").html()+"/"+$("#userid").val()).load()}),$("#stdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#stdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),loadViewAcountSmsSummary()}),$("#stdp span").html(Date.today().add({days:-9}).toString("MMM d, yyyy")+" - "+Date.today().toString("MMM d, yyyy")),$("#ws_toggle").length>0&&$("#ws_toggle").on("change",function(){var a=$(this).is(":checked")?1:0,t=$("#userid").val();$.ajax({url:app_url+"websiteToggle",method:"post",data:{uid:t,status:a},success:function(a){window.location.reload()}})}),loadViewAcountSmsSummary()),"va_utrans"==curpage){var errcredits=0,numerr=0,d_errcredits=0,d_numerr=0;$(document).on("keyup blur input",".cur_inputs",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input");let a=$("#w_planid").attr("data-ptax"),t=$("#w_planid").attr("data-taxtype"),s=parseFloat($("#mplanscredits").val())||0,o=parseFloat($("#add_tax").val())||0,r=0,n="including all taxes";if(parseFloat(a)>0){r=(s+parseFloat(s*(a/100))).toFixed(2),n=`including ${a}% ${[{tax:"GT",str:"GST"},{tax:"VT",str:"VAT"},{tax:"ST",str:"Service Tax"},{tax:"SC",str:"Service Charges"},{tax:"OT",str:"Other Taxes"}].find(a=>a.tax==t).str}`}else r=s.toFixed(2);parseFloat(o)>0&&(r=(parseFloat(r)+parseFloat(r*(o/100))).toFixed(2)),$("#w_grand_total_amt").text(new Number(r).toLocaleString("en-US",{minimumFractionDigits:2})),$("#w_all_taxes").text(`(${n})`)}),$("#subcurfrm").on("click",function(){""==$("#mplanscredits").val()||$("#mplanscredits").val()<=0?bootbox.alert(SCTEXT("Please enter a valid credit amount for this transaction.")):bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Processing Transaction")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#w_form").attr("action",app_url+"processAccountTransaction"),$("#w_form").submit()},200)})}),$("#sub_cform").on("click",function(){""!=$("#c_route option:selected").val()?""!=$("#add_cre").val()?1!=numerr?1!=errcredits?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Processing Transaction")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#c_form").attr("action",app_url+"processAccountTransaction"),$("#c_form").submit()},200)}):bootbox.alert(SCTEXT("Please do not assign more credits than your account balance.")):bootbox.alert(SCTEXT("Please enter only Numeric values in highlighted fields.")):bootbox.alert(SCTEXT("Please enter SMS credits to assign.")):bootbox.alert(SCTEXT("Please select a route to assign credits."))}),$("#c_route").on("change",function(){var a=$("#c_route option:selected").attr("data-price");$("#c_price").val(a),""!=$("#add_cre").val()&&$("#add_cre").trigger("keyup")}),$(".numtxt").on("blur keyup",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),numerr=1,void e.preventDefault();$(this).removeClass("error-input"),numerr=0;var a=[],t={id:$("#c_route option:selected").val(),credits:$("#add_cre").val(),price:$("#c_price").val()};a.push(t),$.ajax({url:app_url+"getPlanSmsPrice",method:"post",data:{mode:"utrans",plan:$("#planid").val(),routesData:JSON.stringify(a),discount:0,dtype:"",addTax:$("#c_utax").val()},success:function(a){var t;t=JSON.parse(a),"0"!=$("#planid").val()&&$("#c_price").val(t.price[$("#c_route option:selected").val()].price);var e=t.total_plan,s=t.plan_tax,o=t.grand_total;$("#total_c_amt").text(e),$("#c_plan_taxes").text(s),$("#c_grand_total_amt").text(o),"1"==t.errcredits?(errcredits=1,bootbox.alert(SCTEXT("Please do not assign more credits than your account balance."))):errcredits=0}})}),$("#d_route").on("change",function(){var a=$("#d_route option:selected").attr("data-price");$("#d_rtprc").text(a),$("#rtavcr").text($("#d_route option:selected").attr("data-credits")),$("#deduct_cre").val(""),$("#d_total_amt, #d_grand_total_amt").text("0.00"),$("#dutax").val("")}),$(".drtcredits").on("blur keyup",function(){if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test($(this).val())&&""!=$(this).val())return $(this).addClass("error-input"),d_numerr=1,void e.preventDefault();$(this).removeClass("error-input"),d_numerr=0;var a=[],t={id:$("#d_route option:selected").val(),credits:$("#deduct_cre").val(),price:$("#d_rtprc").text()};a.push(t),$.ajax({url:app_url+"getPlanSmsPrice",method:"post",data:{mode:"utrans_d",plan:$("#planid").val(),routesData:JSON.stringify(a),discount:0,dtype:"",addTax:$("#dutax").val(),avcre:$("#rtavcr").text()},success:function(a){var t;t=JSON.parse(a),"0"!=$("#planid").val()&&$("#d_rtprc").text(t.price[$("#d_route option:selected").val()].price);var e=t.total_plan,s=t.plan_tax,o=t.grand_total;$("#d_total_amt").text(e),$("#d_plan_taxes").text(s),$("#d_grand_total_amt").text(o),"1"==t.errcredits?(d_errcredits=1,bootbox.alert(SCTEXT("Please do not deduct more credits than available in customer account."))):d_errcredits=0}})}),$("#subfrm").on("click",function(){""!=$("#d_route option:selected").val()?""!=$("#deduct_cre").val()?1!=d_numerr?1!=d_errcredits?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Processing Transaction")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#d_form").attr("action",app_url+"processAccountTransaction"),$("#d_form").submit()},200)}):bootbox.alert(SCTEXT("Please do not deduct more credits than customer account balance.")):bootbox.alert(SCTEXT("Please enter only Numeric values in highlighted fields.")):bootbox.alert(SCTEXT("Please enter SMS credits to deduct.")):bootbox.alert(SCTEXT("Please select a route to deduct credits from."))})}if("va_uset"==curpage){$("#cus_tlv_flag").on("change",function(){$(this).is(":checked")?$("#cus_tlv_ctr").show():$("#cus_tlv_ctr").hide()}),$("#save_hlrset").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#hlrsetform").attr("action",app_url+"saveUserHlrSettings"),$("#hlrsetform").submit()},200)})}),$("#vmnsetsubmit").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#usrvmnsetform").attr("action",app_url+"saveUserVmnSettings"),$("#usrvmnsetform").submit()},200)})}),$("#pldbsetsubmit").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Phonebook permissions")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#pbdbsetform").attr("action",app_url+"saveUserPhonebookPermissions"),$("#pbdbsetform").submit()},200)})});var defnum="971500301012";$("#maskstart,#masklen").on("change",function(){var a=$("#maskstart").val(),t=$("#masklen").val(),e="x".repeat(t),s=substr_replace(defnum,e,a,t);$("#egmask").html(s),$("#maskstart").attr("max",12-parseInt(t))}),$("#upermsubmit").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving user permissions")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#upermform").attr("action",app_url+"saveUserPermissions"),$("#upermform").submit()},200)})}),$("#uflagbtn").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving user permissions")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#uflagform").attr("action",app_url+"saveUserSpecialFlags"),$("#uflagform").submit()},200)})}),$("#uwconbtn").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving whitelist contacts")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#uwconform").attr("action",app_url+"saveUserWhitelist"),$("#uwconform").submit()},200)})}),$(document).on("change",".togstatus",function(){let a=$(this).attr("data-sid"),t=0;$(this).is(":checked")&&(t=1),$.ajax({url:app_url+"toggleSmppClientStatus",method:"post",data:{id:a,status:t},success:function(a){bootbox.alert(a)}})}),$(document).on("click",".delsmppclient",function(){let a=$(this).attr("data-aid");bootbox.confirm({message:SCTEXT("Please make sure this account does not have SMS data associated with it. If you need to temporarily disable it, please change the status of this account by the green switch. Are you sure you want to permanently delete this SMPP client account?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteSmppClient/"+$("#userid").val()+"/"+a)}})})}if("edit_profile"==curpage){$("#userpg").on("change",function(){let a=$("#userpg option:selected"),t=a.attr("data-link");""!=a.val()?($("#pgdesc").html(`Make sure you have a merchant account with ${a.text()}. Please <a href="${t}" target="_blank">click here</a> to sign-up.`),$(".pgboxes").hide(function(){$(`#${a.val()}-tab`).fadeIn()})):($("#pgdesc").html(""),$(".pgboxes").hide())}),$("#userpg").trigger("change"),$("#savecifrm").click(function(){""!=$("#cname").val()?""!=$("#cphn").val()?""!=$("#cmail").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving company information")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#cifrm").attr("action",app_url+"saveCompanyInfo"),$("#cifrm").submit()},200)}):bootbox.alert(SCTEXT("Company email ID cannot be blank.")):bootbox.alert(SCTEXT("Company phone number cannot be blank.")):bootbox.alert(SCTEXT("Company name cannot be blank."))});var errpass=0;$("#newpass1, #newpass2").on("keyup blur",function(){var a=$(this).attr("data-strength"),t=$(this).val();"weak"==a&&(t.length<6?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""))),"average"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[a-zA-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text("")):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one alphabet letter."))))),"strong"==a&&(t.length<8?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(errpass=0,$("#pass-err").text(""),/[A-Z]/.test(t)?(errpass=0,$("#pass-err").text(""),/[0-9]/.test(t)?(errpass=0,$("#pass-err").text(""),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one special character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one uppercase letter."))))),0==errpass&&($("#newpass1").val()!=$("#newpass2").val()?(errpass=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Passwords do not match each other. Please re-type your password"))):(errpass=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))))}),$("#savecpfrm").click(function(){""!=$("#oldpass").val()?""!=$("#newpass1").val()&&""!=$("#newpass1").val()?1!=errpass?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Changing account password")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#cpfrm").attr("action",app_url+"saveUserPassword"),$("#cpfrm").submit()},200)}):bootbox.alert(SCTEXT("Some errors are found with your entry. Please rectify before submitting the form.")):bootbox.alert(SCTEXT("Please enter values in all the fields.")):bootbox.alert(SCTEXT("Please enter old password."))}),$("#vphn").click(function(){bootbox.confirm({message:SCTEXT("We will send you a 6-digit one-time password (OTP) to your mobile number. Make sure you have saved your correct mobile number."),buttons:{cancel:{label:SCTEXT("Cancel"),className:"btn-default"},confirm:{label:SCTEXT("Send OTP"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"verifyViaOTP/mobile",success:function(a){bootbox.prompt(SCTEXT("Enter the 6-digit OTP sent to your mobile number"),function(a){var t=$(this);return a?($.ajax({url:app_url+"confirmOTP/mobile",method:"post",data:{otp:a},async:!1,success:function(a){"no"==JSON.parse(a).match_result?$("#otperr").length>0?($("#otperr").html(SCTEXT("The OTP entered did not match.")),t.effect("shake")):($("<span id='otperr' class='help-block text-danger'>"+SCTEXT("The OTP entered did not match.")+"</span>").insertAfter("input.bootbox-input-text"),t.effect("shake")):window.location.reload()}}),!1):($("#otperr").length>0?($("#otperr").html(SCTEXT("OTP cannot be blank.")),t.effect("shake")):($("<span id='otperr' class='help-block text-danger'>"+SCTEXT("OTP cannot be blank.")+"</span>").insertAfter("input.bootbox-input-text"),t.effect("shake")),!1)})}})}})}),$("#vmail").click(function(){bootbox.confirm({message:"We will send you a 6-digit one-time password (OTP) to your email. Make sure you have saved your correct email address and check your SPAM/JUNK box if not received within a minute.",buttons:{cancel:{label:SCTEXT("Cancel"),className:"btn-default"},confirm:{label:SCTEXT("Send OTP"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"verifyViaOTP/email",success:function(a){bootbox.prompt(SCTEXT("Enter the 6-digit OTP sent to your email address"),function(a){var t=$(this);return a?($.ajax({url:app_url+"confirmOTP/email",method:"post",data:{otp:a},async:!1,success:function(a){var e=JSON.parse(a);console.log(e.match_result),"no"==e.match_result?$("#otperr").length>0?($("#otperr").html(SCTEXT("The OTP entered did not match.")),t.effect("shake")):($("<span id='otperr' class='help-block text-danger'>"+SCTEXT("The OTP entered did not match.")+"</span>").insertAfter("input.bootbox-input-text"),t.effect("shake")):window.location.reload()}}),!1):($("#otperr").length>0?($("#otperr").html(SCTEXT("OTP cannot be blank.")),t.effect("shake")):($("<span id='otperr' class='help-block text-danger'>"+SCTEXT("OTP cannot be blank.")+"</span>").insertAfter("input.bootbox-input-text"),t.effect("shake")),!1)})}})}})});var erremail=0,errphone=0;$(document).on("change","#u-img",function(){var a=$(this);a.next().next().html(a.val())}),$("#uemail").on("keyup blur",function(){var a=$(this).val();$("#v-email").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),echeck(a)?($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",async:!1,data:{mode:"email",value:a,page:"editprofile"},success:function(a){"FALSE"==a?($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Email ID already exist. Please enter a different email ID.")):($("#v-email").html('<i class="fa fa-lg fa-check text-success"></i>'),erremail=0,emsg="")}})):($("#v-email").html('<i class="fa fa-lg fa-times text-danger"></i>'),erremail=1,emsg=SCTEXT("Invalid Email ID"))}),$("#uphn").on("keyup blur",function(){var a=$(this).val();$("#v-phn").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),isValidPhone(a)?($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="",$.ajax({url:app_url+"checkAvailability",method:"post",async:!1,data:{mode:"mobile",value:a,page:"editprofile"},success:function(a){"FALSE"==a?($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Phone number already exist. Please enter a different phone number.")):($("#v-phn").html('<i class="fa fa-lg fa-check text-success"></i>'),errphone=0,emsg="")}})):($("#v-phn").html('<i class="fa fa-lg fa-times text-danger"></i>'),errphone=1,emsg=SCTEXT("Invalid Phone number entered."))}),$("#saveupfrm").click(function(){""!=$("#uname").val()?""!=$("#uemail").val()&&""!=$("#uphn").val()?1!=erremail&&1!=errphone?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Profile Information")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#upfrm").attr("action",app_url+"saveUserProfile"),$("#upfrm").submit()},200)}):""==emsg?bootbox.alert(SCTEXT("Some errors are found with your entry. Please rectify before submitting the form.")):bootbox.alert(emsg):bootbox.alert(SCTEXT("Please enter values in all the fields.")):bootbox.alert(SCTEXT("Please enter name of the user."))})}if("user_settings"==curpage&&$("#saveuset").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving account settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#usfrm").attr("action",app_url+"saveUserSettings"),$("#usfrm").submit()},200)})}),"notifs"==curpage&&($("#altdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#altdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-alerts").dataTable().api().ajax.url(app_url+"getAllMyAlerts/"+$("#altdp span").html()).load()}),$("#altdp span").html("Select Date")),"support_tickets_mgmt"==curpage&&($("#tktmgrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#tktmgrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#dt_suptkt_mgr").dataTable().api().ajax.url(app_url+"getAssignedTickets/"+$("#tktmgrdp span").html()).load()}),$("#tktmgrdp span").html("Select Date")),"view_ticket_mgr"==curpage&&($("#docremk").animate({scrollTop:$("#docremk").prop("scrollHeight")},500),$("#submitCmt").click(function(){""!=$("#t_comment").val()?($(this).attr("disabled","disabled").html(SCTEXT("Submitting")+" ..."),$("#cmt_form").attr("action",app_url+"postTicketComment"),$("#cmt_form").submit()):bootbox.alert(SCTEXT("Your comment cannot be blank"))})),"add_spam_kw"==curpage&&($("#save_changes").click(function(){""!=$("#kw").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving new SPAM keyword")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_spmkw_form").attr("action",app_url+"saveSpamKeyword"),$("#add_spmkw_form").submit()},100)}):bootbox.alert(SCTEXT("Spam keyword cannot be empty. Please enter a keyword."))}),$("#bk").click(function(){window.location=app_url+"manageSpamKeywords"})),"system_mon"==curpage&&($.ajax({url:app_url+"getAllUserStatus",success:function(a){var t;t=JSON.parse(a),$("#tab-online").html(t.online),$("#tab-all").html(t.all)}}),$(document).on("change",".togtcstatus",function(){var a=$(this).attr("data-cid"),t=0;$(this).is(":checked")&&(t=1),$.ajax({url:app_url+"changeCampaignStatus",method:"post",data:{cid:a,status:t,mode:"tc"},success:function(a){bootbox.alert(a)}})}),$(document).on("change",".togqcstatus",function(){var a=$(this).attr("data-cid"),t=0;$(this).is(":checked")&&(t=1),$.ajax({url:app_url+"changeCampaignStatus",method:"post",data:{cid:a,status:t,mode:"qc"},success:function(a){bootbox.alert(a)}})}),$(document).on("change",".togscstatus",function(){var a=$(this).attr("data-cid"),t=0;$(this).is(":checked")&&(t=1),$.ajax({url:app_url+"changeCampaignStatus",method:"post",data:{cid:a,status:t,mode:"sch"},success:function(a){bootbox.alert(a)}})}),$(document).on("click",".mansc",function(){var a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("Are you sure you want to send this campaign right now?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"sendScheduleManually",method:"post",data:{cid:a},success:function(a){bootbox.alert(a),$("#dt_sc").dataTable().api().ajax.url(app_url+"getAllScheduledCampaigns").load(function(a){$(document).find(".sswitch").each(function(){var a=$(this).attr("data-color");new Switchery(this,{color:a,size:"small",jackColor:"#ffffff"})})})}})}})}),$(document).on("click",".cantc",function(){var a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("Are you sure you want to cancel this campaign right now and refund credits?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"cancelTempCampaign",method:"post",data:{cid:a},success:function(a){bootbox.alert(a),$("#dt_tc").dataTable().api().ajax.url(app_url+"getAllTempCampaigns").load(function(a){$(document).find(".tswitch").each(function(){var a=$(this).attr("data-color");new Switchery(this,{color:a,size:"small",jackColor:"#ffffff"})})})}})}})}),$(document).on("change",".togstatus",function(){var a=$(this).attr("data-rid"),t=1;$(this).is(":checked")&&(t=0),$.ajax({url:app_url+"changeRouteStatus",method:"post",data:{rid:a,status:t},success:function(a){bootbox.alert(a)}})}),$(document).on("click",".submit_drop",function(){$frm_id=$(this).attr("data-form-id"),curele=$(this),bootbox.confirm(SCTEXT("Are you sure you want to DROP sms from Queue?"),function(a){a&&(curele.html('<i class="fa fa-spinner fa-spin"></i>&nbsp;'+SCTEXT("Processing")),$("#"+$frm_id).attr("action",app_url+"dropQueuedBatches"),$("#"+$frm_id).submit())})}),$(document).on("click",".submit_shift",function(){$frm_id=$(this).attr("data-form-id"),curele=$(this),bootbox.confirm(SCTEXT("Are you sure you want to SHIFT sms from Queue?"),function(a){a&&(curele.html('<i class="fa fa-spinner fa-spin"></i>&nbsp;'+SCTEXT("Processing")),$("#"+$frm_id).attr("action",app_url+"shiftQueuedBatches"),$("#"+$frm_id).submit())})}),setInterval(function(){$("#qc_ref").is(":checked")&&$("#dt_qc").dataTable().api().ajax.url(app_url+"getAllQueuedCampaigns").load(function(a){$(document).find(".qswitch").each(function(){var a=$(this).attr("data-color");new Switchery(this,{color:a,size:"small",jackColor:"#ffffff"})})}),$("#sc_ref").is(":checked")&&$("#dt_sc").dataTable().api().ajax.url(app_url+"getAllScheduledCampaigns").load(function(a){$(document).find(".sswitch").each(function(){var a=$(this).attr("data-color");new Switchery(this,{color:a,size:"small",jackColor:"#ffffff"})})}),$("#tc_ref").is(":checked")&&$("#dt_tc").dataTable().api().ajax.url(app_url+"getAllTempCampaigns").load(function(a){$(document).find(".tswitch").each(function(){var a=$(this).attr("data-color");new Switchery(this,{color:a,size:"small",jackColor:"#ffffff"})})}),$("#ou_ref").is(":checked")&&$.ajax({url:app_url+"getAllUserStatus",success:function(a){var t;t=JSON.parse(a),$("#tab-online").html(t.online),$("#tab-all").html(t.all)}})},1e4)),"va_rset"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving SMS Plan Assignment")}. . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#rsetform").attr("action",app_url+"saveUserPlanAssignment"),$("#rsetform").submit()},200)})}),$(".rtsel").on("change",function(){var a="#rtdetail-"+$(this).attr("data-rid");$(this).is(":checked")?$(a).collapse("show"):$(a).collapse("hide")}),$("#savefrm").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving route assignments")}. . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#rsetform").attr("action",app_url+"saveRouteAssignments"),$("#rsetform").submit()},200)})})),$("#page_family").length>0&&$(document).on("click","a.useraction",function(){var a=$(this).attr("data-act"),t=$("#userid").val();if("upgradeacc"==a&&bootbox.confirm({message:SCTEXT("Are you sure you want to upgrade this account to Reseller? This action cannot be reversed."),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes, Proceed"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"accountActions/upgrade/"+t,method:"get",success:function(a){window.location.reload()}})}}),"changepsw"==a){var e=1;$("#resetPassBox").modal(),$(document).on("click","#resetPassSubmit",function(){if(1!=e){var a=$("#upass").val(),t=$("#upass2").val(),s=$("#userid").val();$(this).attr("disabled","disabled").css("cursor","progress"),$.ajax({url:app_url+"passwordReset",method:"post",data:{user:s,cat:"user",pass1:a,pass2:t},success:function(){window.location.reload()}})}}),$(document).on("keyup blur","#upass, #upass2",function(){var a=$(this).attr("data-strength"),t=$(this).val();"weak"==a&&(t.length<6?(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(e=0,$("#pass-err").text(""))),"average"==a&&(t.length<8?(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(e=0,$("#pass-err").text(""),/[a-zA-Z]/.test(t)?(e=0,$("#pass-err").text(""),/[0-9]/.test(t)?(e=0,$("#pass-err").text("")):(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one alphabet letter."))))),"strong"==a&&(t.length<8?(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password too short"))):(e=0,$("#pass-err").text(""),/[A-Z]/.test(t)?(e=0,$("#pass-err").text(""),/[0-9]/.test(t)?(e=0,$("#pass-err").text(""),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(e=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))):(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one special character.")))):(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one numeric character.")))):(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Password must have at least one uppercase letter."))))),0==e&&($("#upass").val()!=$("#upass2").val()?(e=1,$("#pass-err").removeClass("text-success").addClass("text-danger").text(SCTEXT("Passwords do not match each other. Please re-type your password"))):(e=0,$("#pass-err").removeClass("text-danger").addClass("text-success").text(SCTEXT("Password is acceptable"))))})}"usersus"==a&&bootbox.confirm({message:SCTEXT("Suspending this account will also suspend any accounts added under this user. Complete user tree for this account will be disabled. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes, Proceed"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"accountActions/suspend/"+t,method:"get",success:function(a){window.location=app_url+"manageUsers"}})}}),"userdel"==a&&bootbox.confirm({message:SCTEXT("Are you sure you want to delete this user account? This action cannot be undone. The available credits in this account will be added to your account or the corresponding reseller account. Shall we proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes, Proceed"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"accountActions/delete/"+t,method:"get",success:function(a){window.location=app_url+"manageUsers"}})}})}),"manage_iusers"==curpage&&$(document).on("click",".del-user",function(){var a=$(this).attr("data-uid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this user account? This action cannot be undone. The available credits in this account will be added to your account or the corresponding reseller account. Shall we proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes, Proceed"),className:"btn-info"}},callback:function(t){t&&$.ajax({url:app_url+"accountActions/delete/"+a,method:"get",success:function(a){window.location=app_url+"manageInactiveUsers"}})}})}),"buy_sms"==curpage&&($("#routesel").on("change",function(){var a=$("#routesel option:selected");$("#rtavcr").html(formatInt(parseInt(a.attr("data-acr")))),$("#smsrate").html(app_currency+" "+a.attr("data-crt")+" per SMS"),$("#smscredits").trigger("keyup")}),$("#walletcredits").on("keyup blur",function(){var a=$(this).val(),t=SCTEXT("including all taxes");switch($("#taxtype").val()){case"VT":t="including "+$("#tax").val()+"% VAT";break;case"ST":t="including "+$("#tax").val()+"% Service Tax";break;case"SC":t="including "+$("#tax").val()+"% Service Charge";break;case"OT":t="including "+$("#tax").val()+"% Tax";break;case"GT":t="including "+$("#tax").val()+"% GST";break;default:t=SCTEXT("including all taxes")}var e=""!=$("#tax").val()?parseFloat($("#tax").val())/100*a:0,s=parseFloat(a)+parseFloat(e);$("#total_amt_payable").html(s.toLocaleString()),$("#all_taxes").html("("+t+")")}),$("#smscredits").on("keyup blur",function(){var a=$(this).val().replace(/\s+/g,"");if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test(a)&&""!=a)return $(this).addClass("error-input"),void e.preventDefault();$(this).removeClass("error-input");var t=a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");if($(this).val(t),$("#ptype").length>0&&"0"==$("#ptype").val()){var s=[],o=$("#planid").val(),r="",n=0,l=0,i={id:$("#routesel option:selected").val(),credits:a};s.push(i),$.ajax({url:app_url+"getPlanSmsPriceOuter",method:"post",data:{plan:o,routesData:JSON.stringify(s)},success:function(a){var t;if(t=JSON.parse(a),console.log(t),"0"!=o)for(grid in t.price){$("#smsrate").html(app_currency+" "+t.price[grid].price+" per SMS");break}if(r=t.plan_tax,n=t.grand_total,$("#walbal").val()>0)if($("#cb-1").is(":checked")){var e=n<=parseFloat($("#walbal").val())?0:n-parseFloat($("#walbal").val());$("#total_amt_payable").html(e.toLocaleString()),$("#all_taxes_payable").html(r),l=n>=parseFloat($("#walbal").val())?0:($("#walbal").val()-n).toLocaleString(),$("#remwal").text(app_currency+l)}else{e=n;$("#total_amt_payable").html(e.toLocaleString()),$("#all_taxes_payable").html(r),l=$("#walbal").val().toLocaleString(),$("#remwal").text(app_currency+l)}$("#grand_total_amt").html(n.toLocaleString()),$("#all_taxes").html(r)}})}else{n=a*$("#routesel option:selected").attr("data-crt"),r=SCTEXT("including all taxes");switch($("#taxtype").val()){case"VT":r="including "+$("#tax").val()+"% VAT";break;case"ST":r="including "+$("#tax").val()+"% Service Tax";break;case"SC":r="including "+$("#tax").val()+"% Service Charge";break;case"OT":r="including "+$("#tax").val()+"% Tax";break;case"GT":r="including "+$("#tax").val()+"% GST";break;default:r=SCTEXT("including all taxes")}if(n+=""!=$("#tax").val()?parseFloat($("#tax").val())/100*n:0,$("#walbal").val()>0)if($("#cb-1").is(":checked")){var c=n<=parseFloat($("#walbal").val())?0:n-parseFloat($("#walbal").val());$("#total_amt_payable").html(c.toLocaleString()),$("#all_taxes_payable").html(r),l=n>=parseFloat($("#walbal").val())?0:($("#walbal").val()-n).toLocaleString(),$("#remwal").text(app_currency+l)}else{c=n;$("#total_amt_payable").html(c.toLocaleString()),$("#all_taxes_payable").html(r),l=$("#walbal").val().toLocaleString(),$("#remwal").text(app_currency+l)}else{c=n;$("#total_amt_payable").html(c.toLocaleString())}$("#grand_total_amt").html(n.toLocaleString()),$("#all_taxes").html("("+r+")")}}),$("#cb-1").length>0&&$("#cb-1").on("change",function(){$("#smscredits").trigger("keyup")}),$("#routesel").change(),$("#proceedtopay").click(function(){$("#smscredits").length>0&&(""==$("#smscredits").val()||$("#smscredits").val()<=0)?bootbox.alert(SCTEXT("Please enter valid SMS credits to purchase.")):bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Confirming your order")} ...</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},5e3),setTimeout(function(){$("#bs_form").attr("action",app_url+"buyOrderCheckout"),$("#bs_form").submit()},2e3)})})),curpage,"app_settings"==curpage&&($('.nav-tabs a[href="#'+$("#activeTabId").val()+'"]').tab("show"),$(".fakedlr").each(function(){$(this).on("change blur keyup",function(){var a=$(this);if(!/^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test(a.val())&&""!=a.val())return a.val(0),void e.preventDefault();var t=a.val(),s=a.attr("id");if(parseInt(t)>=100)a.val(100),$("#dlrcut_del").val(0),"dlrcut_undel"==s?$("#dlrcut_exp").val(0):$("#dlrcut_undel").val(0);else{var o=(parseInt($("#dlrcut_undel").val())||0)+(parseInt($("#dlrcut_exp").val())||0);o>100?(bootbox.alert(SCTEXT("Total must not exceed 100%.")),a.val(0)):$("#dlrcut_del").val(100-o)}})}),$(".save_settings").each(function(){$(this).on("click",function(){var a=$(this);bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving App Settings")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#"+a.attr("data-form")).attr("action",app_url+"saveAppSettings"),$("#"+a.attr("data-form")).submit()},100)})})}),$("#timezone option").each(function(){$(this).val()==$("#deftz").val()&&$(this).attr("selected","selected")}),$("#timezone").trigger("change.select2"),$(".datefrmt").each(function(){var a=$(this);a.on("change keyup focus blur",function(){$.ajax({url:app_url+"generateDateExample",type:"post",data:{dtype:a.val()},success:function(t){a.next().html(t)}})})})),"power_grid"==curpage&&($("#pauseallprocs").click(function(){bootbox.confirm({message:SCTEXT("This is a very critical decision. All the background processes will be PAUSED. You will need to manually start each process again for proper functioning of the app. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(a){a&&$.ajax({url:app_url+"setProcessStatus",method:"post",data:{mode:"ALL"},success:function(a){window.location.reload(!0)}})}})}),$(".procSwitch").on("change",function(){var a=$(this).attr("data-proc"),t=$(this).is(":checked")?1:0;$.ajax({url:app_url+"setProcessStatus",method:"post",data:{pid:a,status:t},success:function(a){bootbox.alert(a)}})}),$("#mm-y, #mm-n").click(function(){"1"==$(this).val()?$("#mm-opts").removeClass("disabledBox"):$("#mm-opts").addClass("disabledBox")}),$("#mmdp").datetimepicker({minDate:moment(),showClose:!0,icons:{close:"fa-times-circle m-t-xs m-b-xs label-info label label-flat label-md"},sideBySide:!0,toolbarPlacement:"bottom",format:"ddd, Do MMM YYYY HH:mm"}),""!=$("#deftime").val()&&$("#mmdp").val($("#deftime").val()),$("#submit_mm").on("click",function(){$(this);bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#mm_form").attr("action",app_url+"saveMiscVars"),$("#mm_form").submit()},100)})}),$("#save_archts").on("click",function(){if(isNaN($("#arch_ts").val())||""==$("#arch_ts").val())return bootbox.alert("Enter a valid numeric value for days."),!1;bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Updating auto-archive setting")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#arch_form").attr("action",app_url+"updateAutoArchiver"),$("#arch_form").submit()},100)})})),"watchman_log"==curpage&&($("#wml-dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#wml-dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-wmlog").dataTable().api().ajax.url(app_url+"getWatchmanLog/"+$("#wml-dp span").html()).load()}),$("#wml-dp span").html("Select Date")),"dbarchive_log"==curpage&&($("#dal-dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#dal-dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-dalog").dataTable().api().ajax.url(app_url+"getDbArchiveLog/"+$("#dal-dp span").html()).load()}),$("#dal-dp span").html("Select Date")),"webleads"==curpage&&$("#dt_leadfilter").click(function(){$("#dt_web_leads").dataTable().api().ajax.url(app_url+"getWebsiteLeads/"+$("#leadfilter option:selected").val()).load()}),"security_log"==curpage&&$("#secl-dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#secl-dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-seclog").dataTable().api().ajax.url(app_url+"getSusActivityLog/"+$("#secl-dp span").html()).load()}),"blocked_ip_list"==curpage&&$("#blip-dp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#blip-dp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy")),$("#t-blip").dataTable().api().ajax.url(app_url+"getBlockedIpList/"+$("#blip-dp span").html()).load()}),"manage_pbdb"==curpage&&($(document).on("change",".pbdbstatus",function(){var a=0;$(this).is(":checked")&&(a="1");var t=$(this).val();$.ajax({method:"post",url:app_url+"setPhonebookStatus",data:{value:a,gid:t}})}),$(document).on("click",".delpbdb",function(){var a=$(this).attr("data-gid");$(this).attr("data-gcount");bootbox.confirm({message:SCTEXT("Deleting this group will remove this from Phonebook list for all clients and will delete all the contacts present in this group. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deletePhonebookDb/"+a)}})})),"add_pbdb"!=curpage&&"edit_pbdb"!=curpage||($("#save_changes").on("click",function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Phonebook Name")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},300),setTimeout(function(){$("#add_pbdb_form").attr("action",app_url+"savePhonebookDb"),$("#add_pbdb_form").submit()},100)})}),$("#bk").click(function(){window.location=app_url+"phonebook"})),"add_pbcontacts"==curpage&&($("#save_changes").click(function(){1!=$("#uprocess").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Importing Contacts. This may take a while. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#pbct_form").attr("action",app_url+"savePhonebookContacts"),$("#pbct_form").submit()},50)}):bootbox.alert(SCTEXT("File upload is in progress. Kindly wait for upload to finish or Cancel Upload & proceed."))}),$("#bk").click(function(){window.location=app_url+"viewPhonebookContacts/"+$("#pbdbid").val()})),"edit_pbcontact"==curpage&&($("#save_changes").click(function(){""!=$("#pbcontact").val()&&isValidPhone($("#pbcontact").val())?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Contact")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#edit_pbct_form").attr("action",app_url+"savePhonebookContacts"),$("#edit_pbct_form").submit()},50)}):bootbox.alert(SCTEXT("Invalid mobile number provided. Please try again."))}),$("#bk").click(function(){window.location=app_url+"viewPhonebookContacts/"+$("#gid").val()})),"manage_tinyurl"==curpage&&$(document).on("click",".del-surl",function(){var a=$(this).attr("data-urlid");bootbox.confirm({message:SCTEXT("This action will stop redirecting this short URL. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteShortUrl/"+a)}})}),"add_tinyurl"==curpage&&($("#urltype").on("change",function(){var a=$("#urltype option:selected").attr("data-subtext");$("#urltype_desc").text(a)}),$("#save_changes").click(function(){""!=$("#redurl").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Generating Short URL")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#turl_form").attr("action",app_url+"generateShortUrl"),$("#turl_form").submit()},50)}):bootbox.alert(SCTEXT("Destination URL cannot be empty."))}),$("#bk").click(function(){window.location=app_url+"manageShortUrls"})),"manage_ssl"==curpage&&$(document).on("click",".removeSSL",function(){var a=$(this).attr("data-dom");bootbox.confirm({message:SCTEXT("You are removing SSL for this user. All domains associated with this SSL will no longer have secure access. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&bootbox.prompt({title:SCTEXT("Please enter server root SSH password"),inputType:"password",callback:function(t){if(t){bootbox.dialog({message:`<p class="text-center"><i class="fa fa-large fa-spin fa-circle-o-notch"></i>&nbsp;&nbsp;${SCTEXT("Connecting to server. Please wait")} . . .</p>`,size:"small",closeButton:!1});$.ajax({url:app_url+"sshTestConnection",method:"post",data:{rpass:t},success:function(t){"OK"==t?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Removing SSL. This may take a few minutes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},2e4),setTimeout(function(){window.location=app_url+"removeSSL/"+a},50)}):location.reload()}})}}})}})}),"add_ssl"==curpage&&($("#domresfil").on("change",function(){for(var a=(t=$("#domresfil option:selected").attr("data-doms")).split(","),t="",e=0;e<a.length;e++)t+='<div class="checkbox checkbox-success"><input name="seldoms[]" value="'+a[e]+'" type="checkbox" id="cb-'+e+'" checked="checked"><label for="cb-'+e+'">'+a[e]+"</label></div>";$("#domainctr").html(t)}),$("#save_changes").click(function(){bootbox.prompt({title:SCTEXT("Please enter server root SSH password"),inputType:"password",callback:function(a){if(a){bootbox.dialog({message:`<p class="text-center"><i class="fa fa-large fa-spin fa-circle-o-notch"></i>&nbsp;&nbsp;${SCTEXT("Connecting to server. Please wait")} . . .</p>`,size:"small",closeButton:!1});$.ajax({url:app_url+"sshTestConnection",method:"post",data:{rpass:a},success:function(a){"OK"==a?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Installing SSL. This may take a few minutes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},2e4),setTimeout(function(){$("#add_ssl_form").attr("action",app_url+"installNewSSL"),$("#add_ssl_form").submit()},50)}):location.reload()}})}}})}),$("#bk").click(function(){window.location=app_url+"manageSSL"})),"inbox"==curpage&&($("#vmnsel").on("change",function(){$("#dt_mosms").dataTable().api().ajax.url(app_url+"getAllIncomingSms/"+$("#vmnsel").val()+"/"+$("#inboxdp span").html()).load()}),$("#inboxdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#inboxdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy"));$("#campsel").val();$("#dt_mosms").dataTable().api().ajax.url(app_url+"getAllIncomingSms/"+$("#vmnsel").val()+"/"+$("#inboxdp span").html()).load()}),$("#inboxdp span").html("Select Date"),$(document).on("click",".del-mo",function(){var a=$(this).attr("data-moid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this SMS?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteIncomingSms/"+a)}})})),"view_mo"==curpage&&$(document).on("click",".del-mo",function(){var a=$(this).attr("data-moid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this SMS?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteIncomingSms/"+a)}})}),"manage_vmn"==curpage&&$(document).on("click",".del-vmn",function(){var a=$(this).attr("data-vmnid");bootbox.confirm({message:SCTEXT("Please make sure this VMN is not assigned to any user and no Keywords in the system are associated with this number. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteVmn/"+a)}})}),"add_vmn"!=curpage&&"edit_vmn"!=curpage||($("#vmntype").on("change",function(){$("#vtypestr").text($("#vmntype option:selected").attr("data-title"))}),$("#rsmpp").on("change",function(){var a=$("#rsmpp option:selected"),t=parseInt(a.attr("data-stype"));0==t&&($("#sidselbox").removeClass("hidden"),$("#sidopnbox").addClass("hidden")),1==t&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").addClass("hidden")),2==t&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").removeClass("hidden"))}),$("#rsmpp").trigger("change"),$("#vmntype").trigger("change"),$("#save_changes").click(function(){""!=$("#vmn").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#vmnfrm").attr("action",app_url+"saveVmn"),$("#vmnfrm").submit()},50)}):bootbox.alert(SCTEXT("Virtual mobile number cannot be empty."))}),$("#bk").click(function(){window.location=app_url+"manageVmn"})),"manage_kw"==curpage&&$(document).on("click",".del-kw",function(){var a=$(this).attr("data-kid");bootbox.confirm({message:SCTEXT("Incoming SMS with this keyword will not be matched. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteKeyword/"+a)}})}),"add_kw"!=curpage&&"edit_kw"!=curpage||($("#save_changes").click(function(){""!=$("#keyword").val()?""==$("#fwdmob").val()||0!=isValidPhone($("#fwdmob").val())?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#kwfrm").attr("action",app_url+"saveKeyword"),$("#kwfrm").submit()},50)}):bootbox.alert(SCTEXT("Please enter a valid mobile number with country prefix.")):bootbox.alert(SCTEXT("Primary keyword cannot be empty."))}),$("#bk").click(function(){window.location=app_url+"manageKeywords"})),"manage_cmpns"==curpage&&$(document).on("click",".del-cmpn",function(){var a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("Please save all the opt-in and opt-out data from this campaign as they will also be deleted permanently with this campaign. Are you sure you want to delete this campaign?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteCampaign/"+a)}})}),"add_cmpn"!=curpage&&"edit_cmpn"!=curpage||($("#pkeyword").on("change",function(){$("#pkeyword option:selected").val()}),$("#rsmpp").on("change",function(){var a=$("#rsmpp option:selected"),t=parseInt(a.attr("data-stype"));0==t&&($("#sidselbox").removeClass("hidden"),$("#sidopnbox").addClass("hidden")),1==t&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").addClass("hidden")),2==t&&($("#sidselbox").addClass("hidden"),$("#sidopnbox").removeClass("hidden"))}),$("#rsmpp").trigger("change"),$("#pkeyword").trigger("change"),$("#save_changes").click(function(){""!=$("#cname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#cmpn_form").attr("action",app_url+"saveCampaign"),$("#cmpn_form").submit()},50)}):bootbox.alert(SCTEXT("Campaign name cannot be empty."))}),$("#bk").click(function(){window.location=app_url+"campaigns"})),"cmpn_optin"==curpage&&$(document).on("click",".del-num",function(){var a=$(this).attr("data-nid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this optin number?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteOptinNumber/"+a)}})}),"cmpn_optout"==curpage&&$(document).on("click",".del-num",function(){var a=$(this).attr("data-nid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this optout number?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteOptoutNumber/"+a)}})}),"add_smppclient"==curpage||"edit_smppclient"==curpage){let a=0,t="";$("#smpp_sysid").on("keyup blur",function(){let e=$(this).val();$("#v-login").html('<i class="fa fa-lg fa-circle-o-notch fa-spin"></i>'),e.indexOf(" ")>=0||e.length<5?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),a=1,t=SCTEXT("Invalid System ID. Must be at least 5 characters without spaces.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),a=0,t="",$.ajax({url:app_url+"checkAvailability",method:"post",data:{mode:"systemid",value:e},success:function(e){"FALSE"==e?($("#v-login").html('<i class="fa fa-lg fa-times text-danger"></i>'),a=1,t=SCTEXT("System ID already exists. Please enter a different System ID.")):($("#v-login").html('<i class="fa fa-lg fa-check text-success"></i>'),a=0,t="")}}))}),$("#save_changes").click(function(){1!=a?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#smppclient_frm").attr("action",app_url+"saveSmppClient"),$("#smppclient_frm").submit()},50)}):bootbox.alert(t)}),$("#bk").click(function(){window.location=`${app_url}viewUserAccountSettings/${$("#userid").val()}`})}"smppsms"==curpage&&($(document).on("click",".vsubmit_sm",function(){let a=$(this).attr("data-submitsm");""==a?bootbox.alert("No PDU Formed"):bootbox.alert(`<pre>${JSON.stringify(JSON.parse(atob(a)).pdu,null,"\t")}</pre>`)}),$(document).on("click",".vdel_pdu",function(){let a=$(this).attr("data-delsm"),t=$(this).attr("data-delsmres"),e=$(this).attr("data-smtime"),s=$(this).attr("data-smrestime");if(""==a)bootbox.alert("No Deliver_sm PDU Sent yet");else{let o=`<span class="label label-primary">DELIVER_SM sent on ${e}</span><br>`;o+=`<pre>${JSON.stringify(JSON.parse(atob(a)),null,"\t")}`,""!=t?(o+=`</pre><br><span class="label label-primary">DELIVER_SM_RESP received on ${s}</span><br>`,o+=`<pre>${JSON.stringify(JSON.parse(atob(t)),null,"\t")}</pre>`):o+='</pre><br><span class="label label-danger">No Acknowledgement (DELIVER_SM_RESP) Received</span>',bootbox.alert(o)}}),$("#smppdl").on("click",()=>{let a={clientid:$("#smppdl").attr("data-sid"),daterange:$("#smsdp span").html()};window.open(`${app_url}globalFileDownload/smppsms/${btoa(JSON.stringify(a))}`,"_blank")}),$("#smsdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#smsdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy"));let e=$("#systemid").val();$("#t-smppsms").dataTable().api().ajax.url(`${app_url}getSmppSmsList/${e}/${$("#smsdp span").html()}`).load()}),$("#smsdp span").html("Select Date")),"gw_costprice"==curpage&&($("#cvsel").on("change",function(){$("#dt-routes-def-price").dataTable().api().ajax.url(app_url+"getGatewayCostPrice/"+$("#smppid").val()+"/"+$("#cvsel").val()).load()}),$(document).on("click",".savepricing",function(){let a=$(this),t=a.attr("data-smppid"),e=a.attr("data-mccmnc"),s=parseFloat($(`#cp_${e}`).val())||0;if(a.addClass("disabledBox").html('<i class="fas fa-lg fa-spin fa-circle-notch"></i>'),0==s)return bootbox.alert("Please enter a valid price."),void a.removeClass("disabledBox").html('<i class="fa fa-large fa-check"></i>');$.ajax({url:app_url+"saveGatewayCostPrice",method:"post",data:{smppid:t,mccmnc:e,price:s},success:function(t){bootbox.alert("Pricing Saved Successfully"),a.removeClass("disabledBox").html('<i class="fa fa-large fa-check"></i>')}})}),$(document).on("click",".delpricing",function(){let a=$(this),t=a.attr("data-smppid"),e=a.attr("data-mccmnc");a.addClass("disabledBox").html('<i class="fas fa-lg fa-spin fa-circle-notch"></i>'),$.ajax({url:app_url+"removeGatewayCostPrice",method:"post",data:{smppid:t,mccmnc:e},success:function(t){bootbox.alert("Pricing Removed Successfully"),$(`#cp_${e}`).val(""),a.removeClass("disabledBox").html('<i class="fa fa-large fa-trash"></i>')}})})),"import_cost_price"==curpage&&($("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Importing Data")} This may take few minutes. . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},2e3),setTimeout(function(){$("#upload_rprc_form").attr("action",app_url+"importGatewayCostPrice"),$("#upload_rprc_form").submit()},5)})}),$("#bk").click(function(){window.location=`${app_url}gatewayCostPrice/${$("#smppid").val()}`})),"add_mplan"!=curpage&&"edit_mplan"!=curpage||($("#proutes").on("change",function(){let a=`${$(this).val()}`.split(",")||[],t="",e=[];a.forEach(a=>{let s=$(`#routesel_${a}`).attr("data-iso"),o=$(`#routesel_${a}`).attr("data-country");null!=o&&null==e[s]&&(t+="GLOBAL"==s?'<span class="label label-primary m-r-xs label-lg fz-sm"> <i class="fa fa-lg fa-globe"></i> All Countries </span>':`<span class="label label-primary m-r-xs label-lg fz-sm"> <img style="height:15px;" src="${app_url}global/img/flags/${s}.png"> ${o} </span>`,e[s]=1)}),""!=t?$("#country_list").html(t):$("#country_list").html("- No Route Selected -")}),$("#proutes").trigger("change"),$("#save_changes").click(function(){bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#mplanfrm").attr("action",app_url+"saveMccmncPlan"),$("#mplanfrm").submit()},50)})}),$("#bk").click(function(){window.location=`${app_url}mccmncRatePlans`})),"mccmnc_plans"==curpage&&$(document).on("click",".delmplan",function(){let a=$(this).attr("data-pid");"0"==$(this).attr("data-ucount")?bootbox.confirm({message:SCTEXT("All the pricing information will also be deleted. Are you sure you want to delete this SMS Plan?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteMccmncSmsPlan/"+a)}}):bootbox.alert("There are user accounts associated with this plan. Please assign them different MCC/MNC based SMS Plan before removing this plan.")}),"mplan_route_prices"==curpage&&($("#save_defprice").on("click",function(){if(""==$("#default_route_plan_price").val())return void bootbox.alert("Default price cannot be empty");let a=parseFloat($("#default_route_plan_price").val())||0;if(0==a)return void bootbox.alert("Please enter a valid SMS price for this route");let t=$(this);t.addClass("disabledBox").html('<i class="fas fa-lg fa-spin fa-circle-notch"></i>');let e=$("#planid").val(),s=$("#routeid").val();$.ajax({url:app_url+"saveDefaultPlanPrice",method:"post",data:{planid:e,routeid:s,price:a},success:function(a){bootbox.alert("Default price Saved Successfully"),t.removeClass("disabledBox").html("Save")}})}),$("#rsel").on("change",function(){let a=$(this).val(),t=$("#planid").val();window.location=`${app_url}setMccmncPricing/${t}/${a}`}),$(".savepricing").on("click",function(){let a=$(this);a.addClass("disabledBox").html('<i class="fas fa-lg fa-spin fa-circle-notch"></i>');let t=a.attr("data-planid"),e=a.attr("data-mccmnc"),s=a.attr("data-routeid"),o=parseFloat($(`#${`${e}-planprice`}`).val())||0;$.ajax({url:app_url+"saveMccMncPlanPrice",method:"post",data:{planid:t,mccmnc:e,routeid:s,price:o},success:function(t){bootbox.alert("Pricing Saved Successfully"),a.removeClass("disabledBox").html('<i class="fa fa-large fa-check"></i>')}})}),$(".delpricing").on("click",function(){let a=$(this);a.addClass("disabledBox").html('<i class="fas fa-lg fa-spin fa-circle-notch"></i>');let t=a.attr("data-planid"),e=a.attr("data-mccmnc"),s=a.attr("data-routeid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete pricing for this MCC/MNC?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(o){o?$.ajax({url:app_url+"removeMccMncPlanPrice",method:"post",data:{planid:t,mccmnc:e,routeid:s},success:function(t){bootbox.alert("Pricing Removed Successfully"),a.removeClass("disabledBox").html('<i class="fa fa-large fa-trash"></i>'),$(`#${`${e}-planprice`}`).val("")}}):a.removeClass("disabledBox").html('<i class="fa fa-large fa-trash"></i>')}})})),"hlrset"==curpage&&$(document).on("click",".delhlrchn",function(){let a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this HLR API channel?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=`${app_url}deleteHlrApi/${a}`)}})}),"add_hlr"!=curpage&&"edit_hlr"!=curpage||($("#prsel").on("change",function(){let a=$("#prsel option:selected"),t=a.attr("data-method");if(""==a.val())$("#hlrdesc").html("Select a provider for more information");else{let e=`This HLR lookup API is provided by <span class="label label-success text-white">${a.attr("data-website")}</span>. Make sure you have an account with them and provide the authentication details below.`;"async"==a.attr("data-async")&&(e+=` This API uses asynchronous callback to update HLR lookup. Hence reports are updated by a callback URL to our servers. Please configure following callback URL in SETTINGS section of your HLR provider's panel.<br><kbd>${app_url}hlrApiCallback/${a.val()}/index</kbd>`),"httpauth"==t?($("#apiparam_httpauth").removeClass("hidden"),$("#apiparam_getpost").addClass("hidden")):($("#apiparam_httpauth").addClass("hidden"),$("#apiparam_getpost").removeClass("hidden")),$("#hlrdesc").html(e)}}),$("#prsel").trigger("change"),$("#save_changes").click(function(){null!=$("#prsel").val()&&""!=$("#prsel").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving changes")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#hlrcfrm").attr("action",app_url+"saveHlrApi"),$("#hlrcfrm").submit()},50)}):bootbox.alert("Please select a provider for HLR lookup channel.")}),$("#bk").click(function(){window.location=`${app_url}manageHlr`})),"newhlrlookup"==curpage&&($("#save_changes").click(function(){""!=$("#contactinput").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Submitting Lookup Request")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#hlr_form").attr("action",app_url+"submitHlrLookup"),$("#hlr_form").submit()},50)}):bootbox.alert("Please enter mobile numbers to perform HLR lookup.")}),$("#bk").click(function(){window.location=`${app_url}viewHlrReports`})),"hlrreports"==curpage&&($(document).on("click",".showHlrData",function(){let a=$(this).attr("data-rinfo");bootbox.alert(`<pre>${JSON.stringify(JSON.parse(atob(a)),null,"\t")}</pre>`)}),$("#hlrdp").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]},opens:"left",format:"MM/dd/yyyy",separator:" to ",startDate:Date.today().add({days:-29}),endDate:Date.today(),minDate:"01/01/2012",maxDate:"12/31/2030",locale:{applyLabel:"Apply",clearLabel:"Cancel",customRangeLabel:"Custom Range",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"]},function(a,t){$("#hlrdp span").html(a.toString("MMM d, yyyy")+" - "+t.toString("MMM d, yyyy"));$("#campsel").val();$("#t-hlrreports").dataTable().api().ajax.url(app_url+"getHlrReports/"+$("#hlrdp span").html()).load()}),$("#hlrdp span").html("Select Date")),"manage_orules"==curpage&&$(document).on("click",".delovrl",function(){let a=$(this).attr("data-rid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this Override Rule?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=`${app_url}deleteOverrideRule/${a}`)}})}),"add_orule"!=curpage&&"edit_orule"!=curpage||($("#addtmp").click(function(){$("#templatebox").append('<div class="p-sm panel m-b-lg bg-info text-white" style="position: relative;">\n        <a href="javascript:void(0);" class="plan-remove rmv_temp"><i class="fa fa-3x text-danger fa-minus-circle"></i> </a>\n        <table class="table">\n            <thead>\n                <tr>\n                    <th>Match</th>\n                    <th>Action</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">Sender ID</span>\n                            <span class="input-group-addon">\n                                <select name="sendermatch[]" class="form-control input-sm">\n                                    <option value="0">Any</option>\n                                    <option value="equal">Equals to</option>\n                                    <option value="start">Starts With</option>\n                                    <option value="end">Ends With</option>\n                                    <option value="has">Contains</option>\n                                    <option value="nothave">Does not contain</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="senderinput[]" type="text" class="form-control input-sm" placeholder="e.g. WEBSMS">\n                            </span>\n                        </div>\n                    </td>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">\n                                <select name="senderreplace[]" class="form-control input-sm">\n                                    <option value="0">No Action</option>\n                                    <option value="replace">Replace With</option>\n                                    <option value="prepend">Add Prefix</option>\n                                    <option value="append">Append Suffix</option>\n                                    <option value="remove">Remove Prefix</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="senderreplaceinput[]" type="text" class="form-control input-sm" placeholder="e.g. AUTOWEB">\n                            </span>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">Mobile No.</span>\n                            <span class="input-group-addon">\n                                <select name="mobilematch[]" class="form-control input-sm">\n                                    <option value="0">Any</option>\n                                    <option value="equal">Equals to</option>\n                                    <option value="start">Starts With</option>\n                                    <option value="end">Ends With</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="mobileinput[]" type="text" class="form-control input-sm" placeholder="e.g. 243812556677">\n                            </span>\n                        </div>\n                    </td>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">\n                                <select name="mobilereplace[]" class="form-control input-sm">\n                                    <option value="0">No Action</option>\n                                    <option value="reject">Reject Number</option>\n                                    <option value="prepend">Append Prefix</option>\n                                    <option value="append">Append Suffix</option>\n                                    <option value="remove">Remove Prefix</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="mobilereplaceinput[]" type="text" class="form-control input-sm" placeholder="e.g. 243">\n                            </span>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">SMS Text</span>\n                            <span class="input-group-addon">\n                                <select name="textmatch[]" class="form-control input-sm">\n                                    <option value="0">Any</option>\n                                    <option value="equal">Equals to</option>\n                                    <option value="start">Starts With</option>\n                                    <option value="end">Ends With</option>\n                                    <option value="has">Contains</option>\n                                    <option value="nothave">Does not contain</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="textinput[]" type="text" class="form-control input-sm" placeholder="e.g. karl">\n                            </span>\n                        </div>\n                    </td>\n                    <td>\n                        <div class="input-group">\n                            <span class="input-group-addon">\n                                <select name="textreplace[]" class="form-control input-sm">\n                                    <option value="0">No Action</option>\n                                    <option value="replace">Replace With</option>\n                                    <option value="prepend">Add Prefix</option>\n                                    <option value="append">Append Suffix</option>\n                                    <option value="remove">Remove Prefix</option>\n                                </select>\n                            </span>\n                            <span class="input-group-addon">\n                                <input name="textreplaceinput[]" type="text" class="form-control input-sm" placeholder="e.g. k@rl">\n                            </span>\n                        </div>\n                    </td>\n                </tr>\n\n            </tbody>\n        </table>\n    </div>')}),$(document).on("click",".rmv_temp",function(){$(this).parent().remove()}),$("#save_changes").click(function(){""!=$("#orname").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Processing request")} . . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#add_orule_frm").attr("action",app_url+"saveOverrideRule"),$("#add_orule_frm").submit()},50)}):bootbox.alert("Please enter name for the override rule.")}),$("#bk").click(function(){window.location=`${app_url}overrideRules`})),"manage_media"==curpage&&$(document).on("click",".del-med",function(){var a=$(this).attr("data-mid");bootbox.confirm({message:SCTEXT("Deleting this will also disable tracking for this file. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteCampaignMedia/"+a)}})}),"add_media"==curpage&&($("#save_changes").click(function(){""!=$("#mtitle").val()?1!=$("#uprocess").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Uploading Media. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#cmed_form").attr("action",app_url+"saveCampaignMedia"),$("#cmed_form").submit()},50)}):bootbox.alert(SCTEXT("File upload is in progress. Kindly wait for upload to finish or Cancel Upload & proceed.")):bootbox.alert(SCTEXT("Please enter a title for this file."))}),$("#bk").click(function(){window.location=app_url+"manageCampaignMedia"})),"manage_tlv"==curpage&&($.ajax({url:`${app_url}listAllTlvParams`,success:function(a){$("#tlv_container").html(a)}}),$(document).on("mouseenter",".tlvboxes",function(){$(this).addClass("opacity-3").next().show()}).on("mouseleave",".tlvboxes",function(){$(this).removeClass("opacity-3").next().hide()}).on("click",".deltlv",function(){let a=$(this).attr("data-tlvid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this SMPP TLV tag?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=`${app_url}deleteSmppTlv/${a}`)}})})),"add_tlv"!=curpage&&"edit_tlv"!=curpage||($("#save_changes").click(function(){""!=$("#tlv_title").val()&&""!=$("#tlv_name").val()&&""!=$("#tlv_tag").val()&&""!=$("#tlv_length").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving TLV. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#tlvfrm").attr("action",app_url+"saveSmppTlv"),$("#tlvfrm").submit()},50)}):bootbox.alert(SCTEXT("All fields are mandatory. Please fill all values."))}),$("#bk").click(function(){window.location=app_url+"manageSmppTlv"})),"manage_client_tlv"==curpage&&$(document).on("click",".delutlv",function(){let a=$(this).attr("data-tlvid");bootbox.confirm({message:SCTEXT("Are you sure you want to delete this Parameter?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=`${app_url}deleteClientTlv/${a}`)}})}),"add_client_tlv"==curpage&&($("#routesel").on("change",function(){let a=$("#routesel option:selected"),t=a.attr("data-tlvs");if(""!==t){$("#tlv_box").removeClass("disabledBox");let a=JSON.parse(t);if(a.length>0){let t="";for(const e of a)t+=`<option value="${e}">${e}</option>`;$("#tlv_type").html(t),$("#tlv_type").select2()}}else if($("#tlv_box").addClass("disabledBox"),"0"!=a.val())return bootbox.alert("This Route does not allow TLV. Please select another route"),!1}),$("#save_changes").click(function(){""!=$("#tlv_value").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Parameter. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#ctlv_form").attr("action",app_url+"saveClientTlv"),$("#ctlv_form").submit()},50)}):bootbox.alert(SCTEXT("Parameter value cannot be empty."))}),$("#bk").click(function(){window.location=`${app_url}manageClientTlv`})),"manage_otp_channels"==curpage&&$(document).on("click",".del-otpch",function(){var a=$(this).attr("data-cid");bootbox.confirm({message:SCTEXT("OTP APIs using this channel will not work. Are you sure you want to delete this channel?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteOtpChannel/"+a)}})}),"add_otp_channel"!=curpage&&"edit_otp_channel"!=curpage||($("#otproute").on("change",function(){let a=$("#otproute option:selected"),t=$("#otptlvs").length>0?$("#otptlvs").val():"null";""!==a.attr("data-tlvs")?$.ajax({url:`${app_url}getUserTlvList/${a.val()}`,success:function(a){let e=JSON.parse(a),s=Object.keys(e);if(s.length>0){let a="",o="null"==t?[]:JSON.parse(t);for(const t of s){let s=e[t];a+=`<div class="form-group tlv_boxes"> <label class="control-label col-md-3">${t}:</label><div class="col-md-8"><select class="tlv_controls form-control" data-plugin="select2" name="tlv[]">`;for(const e of s)a+="<option",o.includes(`${t}||${e.value}`)&&(a+=' selected="selected" '),a+=` value="${t}||${e.value}">${e.title}</option>`;a+="</select> </div></div>"}$(".tlv_boxes").remove(),$("#sid_box").before(a),$(".tlv_controls").select2()}}}):$(".tlv_boxes").remove()}),$("#otproute").trigger("change"),$("#save_changes").click(function(){""!=$("#otph_title").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving OTP Channel. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#otpch_form").attr("action",app_url+"saveOtpChannel"),$("#otpch_form").submit()},50)}):bootbox.alert(SCTEXT("Please enter a title for this channel."))}),$("#bk").click(function(){window.location=app_url+"manageOtpChannels"})),"manage_vsms_agents"==curpage&&($(document).on("click",".view-vsmsagent",function(){let vaid=$(this).attr("data-aid");$("#vadetails-name").text($(`#vaname-${vaid}`).text()),$("#vadetails-desc").text($(`#vadesc-${vaid}`).text()),$("#vadetails-logo").attr("src",$(`#valogo-${vaid}`).attr("src"));let sids=""==$(`#vasids-${vaid}`).val()?[]:eval("("+$(`#vasids-${vaid}`).val()+")"),sidstr="";sids.forEach(a=>{sidstr+=`<button class="btn btn-xs btn-primary m-b-xs">${a}</button><br>`}),$("#vadetails-senders").html(sidstr),$("#vadetailsbox").modal()}),$(document).on("click",".del-vsmsagent",function(){var a=$(this).attr("data-aid");bootbox.confirm({message:SCTEXT("This Agent will be removed. Are you sure you want to proceed?"),buttons:{cancel:{label:SCTEXT("No"),className:"btn-default"},confirm:{label:SCTEXT("Yes"),className:"btn-info"}},callback:function(t){t&&(window.location=app_url+"deleteVsmsAgent/"+a)}})})),"add_vsms_agent"!=curpage&&"edit_vsms_agent"!=curpage||($("#cov").trigger("change.select2"),$("#save_changes").click(function(){""!=$("#vsms_aname").val()?""!=$("#vsms_adesc").val()?""!=$("#vsmssids").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving Verified-SMS Agent. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#vsmsa_form").attr("action",app_url+"saveVsmsAgent"),$("#vsmsa_form").submit()},500)}):bootbox.alert(SCTEXT("Please select at least one approved sender ID.")):bootbox.alert(SCTEXT("Agent description cannot be empty.")):bootbox.alert(SCTEXT("Agent name cannot be empty."))}),$("#bk").click(function(){window.location=`${app_url}manageVsmsAgents`})),"add_apivendor"!=curpage&&"edit_apivendor"!=curpage||($("#save_changes").click(function(){""!=$("#vapi_title").val()?""!=$("#smsc_id").val()?bootbox.dialog({closeButton:!1,message:`<p class="text-center" style="color: hsl(0, 0%, 0%);margin-top: 2%;word-spacing: 2px;"> ${SCTEXT("Saving API Vendor. Please wait")} . . .</p><div class="progress progress-xs"><div id="stbar" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>`}).init(function(){$("#stbar").animate({width:"100%"},500),setTimeout(function(){$("#add_vapi_form").attr("action",app_url+"saveApiVendor"),$("#add_vapi_form").submit()},500)}):bootbox.alert(SCTEXT("SMSC ID cannot be empty.")):bootbox.alert(SCTEXT("Vendor API title cannot be empty."))}),$("#bk").click(function(){window.location=`${app_url}manageApiVendors`})),setInterval(function(){loadAppAlerts()},3e4),$(document).on("click",".albox",function(){var a=$(this).attr("data-nid"),t=$(this).attr("data-redirect");window.location=app_url+"alertRedirect/"+a+"/"+t}),$("#rlcrehdr").on("click",function(a){a.stopPropagation(),$("#rlcrehdr i").addClass("fa-spin disabledBox"),$.ajax({url:app_url+"reloadCreditData",success:function(a){window.location.reload(!1)}})}),$(".pop-over").popover({html:!0}),$(".dashboard-link").click(function(){window.location=app_url+"Dashboard"}),"usms_log"!=curpage&&"stats"!=curpage&&$("[title]").each(function(){if(0==$(this).hasClass("pop-over")&&"OPTION"!=$(this).prop("tagName")){let a=$(this).attr("title");$(this).tooltip({title:a})}})}),google.load("elements","1",{packages:"transliteration"});var isoCountries={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};function getCountryName(a){return isoCountries.hasOwnProperty(a)?isoCountries[a]:a}function tsToDate(a){return`${a.getFullYear().toString().padStart(4,"0")}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`}var unicode_regex=/[^\u0000-\u00ff]/;function containsUnicode(a){return!!a.length&&(a.charCodeAt(0)>255||unicode_regex.test(a))}
